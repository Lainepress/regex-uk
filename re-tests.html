<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>regex â€“ examples/re-tests.lhs</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lib/lhs-styles.css" />
  <link rel="stylesheet" href="lib/bs.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"/>
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/>
  <link rel="manifest" href="/manifest.json"/>
  <link rel="mask-icon" href="/safari-pinned-tab.svg"/>
  <meta name="theme-color" content="#ffffff"/>
</head>
<body>
<div class='bcdiv'>
  <ol class='breadcrumb'>
    <li><a href="." style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;" id="branding">[<span style='color:red;'>re</span>|${<span style='color:red;'>gex</span>}(.*)|<span></span>]</a></li>
    <li><a title='source file' href='https://github.com/iconnect/regex/blob/master/examples/re-tests.lhs'>examples/re-tests.lhs</a></li>
</ol>
</div>
<div class='litcontent'>
<header>
<h1 class="title">examples/re-tests.lhs</h1>
</header>
<h1 id="regex-test-suite">Regex Test Suite</h1>
<p>All of the regex exampes are self-testing and together make up the regex test suite run during development and over each release of the test suite. But here we have the unit an small-check tests used to systematically probe the library for weak points and guard against regressions.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="ot">{-# LANGUAGE NoImplicitPrelude          #-}</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="ot">{-# LANGUAGE RecordWildCards            #-}</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="ot">{-# LANGUAGE OverloadedStrings          #-}</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="ot">{-# LANGUAGE QuasiQuotes                #-}</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="ot">{-# LANGUAGE MultiParamTypeClasses      #-}</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="ot">{-# LANGUAGE FlexibleInstances          #-}</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="ot">{-# LANGUAGE TemplateHaskell            #-}</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="ot">{-# LANGUAGE FlexibleContexts           #-}</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="ot">{-# LANGUAGE DeriveFunctor              #-}</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="ot">{-# LANGUAGE StandaloneDeriving         #-}</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="ot">{-# OPTIONS_GHC -fno-warn-orphans       #-}</span></a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">module</span> <span class="dt">Main</span> (main) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-14" title="14"></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">import</span>           <span class="dt">Control.Exception</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="kw">import</span>           <span class="dt">Control.Monad</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="kw">import</span>           <span class="dt">Data.Array</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.Char8</span>          <span class="kw">as</span> <span class="dt">B</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.Lazy.Char8</span>     <span class="kw">as</span> <span class="dt">LBS</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.Lazy.UTF8</span>      <span class="kw">as</span> <span class="dt">LBS</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.UTF8</span>           <span class="kw">as</span> <span class="dt">B</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="kw">import</span>           <span class="dt">Data.Char</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Foldable</span>                  <span class="kw">as</span> <span class="dt">F</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.HashMap.Strict</span>            <span class="kw">as</span> <span class="dt">HM</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="kw">import</span>           <span class="dt">Data.Maybe</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Monoid</span>                    <span class="kw">as</span> <span class="dt">M</span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Sequence</span>                  <span class="kw">as</span> <span class="dt">S</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="kw">import</span>           <span class="dt">Data.String</span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Text</span>                      <span class="kw">as</span> <span class="dt">T</span></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Text.Lazy</span>                 <span class="kw">as</span> <span class="dt">LT</span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="kw">import</span>           <span class="dt">Data.Typeable</span></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="kw">import</span>           <span class="dt">Language.Haskell.TH.Quote</span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="kw">import</span>           <span class="dt">Prelude.Compat</span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="kw">import</span>           <span class="dt">System.Directory</span></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="kw">import</span>           <span class="dt">System.FilePath</span></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">System.Info</span>                    <span class="kw">as</span> <span class="dt">SI</span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="kw">import</span>           <span class="dt">Test.SmallCheck.Series</span></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="kw">import</span>           <span class="dt">Test.Tasty</span></a>
<a class="sourceLine" id="cb1-39" title="39"><span class="kw">import</span>           <span class="dt">Test.Tasty.HUnit</span></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="kw">import</span>           <span class="dt">Test.Tasty.SmallCheck</span>          <span class="kw">as</span> <span class="dt">SC</span></a>
<a class="sourceLine" id="cb1-41" title="41"><span class="kw">import</span>           <span class="dt">TestKit</span></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="kw">import</span>           <span class="dt">Text.Heredoc</span></a>
<a class="sourceLine" id="cb1-43" title="43"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE</span>                   <span class="kw">as</span> <span class="dt">PCRE</span></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.ByteString</span>        <span class="kw">as</span> <span class="dt">P_BS</span></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.ByteString.Lazy</span>   <span class="kw">as</span> <span class="dt">PLBS</span></a>
<a class="sourceLine" id="cb1-46" title="46"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.Sequence</span>          <span class="kw">as</span> <span class="dt">P_SQ</span></a>
<a class="sourceLine" id="cb1-47" title="47"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.String</span>            <span class="kw">as</span> <span class="dt">P_ST</span></a>
<a class="sourceLine" id="cb1-48" title="48"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.Text</span>              <span class="kw">as</span> <span class="dt">P_TX</span></a>
<a class="sourceLine" id="cb1-49" title="49"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.Text.Lazy</span>         <span class="kw">as</span> <span class="dt">PLTX</span></a>
<a class="sourceLine" id="cb1-50" title="50"><span class="kw">import</span>           <span class="dt">Text.RE.REOptions</span></a>
<a class="sourceLine" id="cb1-51" title="51"><span class="kw">import</span>           <span class="dt">Text.RE.Replace</span></a>
<a class="sourceLine" id="cb1-52" title="52"><span class="kw">import</span>           <span class="dt">Text.RE.TDFA</span>                   <span class="kw">as</span> <span class="dt">TDFA</span></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.ByteString</span>        <span class="kw">as</span> <span class="dt">T_BS</span></a>
<a class="sourceLine" id="cb1-54" title="54"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.ByteString.Lazy</span>   <span class="kw">as</span> <span class="dt">TLBS</span></a>
<a class="sourceLine" id="cb1-55" title="55"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.Sequence</span>          <span class="kw">as</span> <span class="dt">T_SQ</span></a>
<a class="sourceLine" id="cb1-56" title="56"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.String</span>            <span class="kw">as</span> <span class="dt">T_ST</span></a>
<a class="sourceLine" id="cb1-57" title="57"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.Text</span>              <span class="kw">as</span> <span class="dt">T_TX</span></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.Text.Lazy</span>         <span class="kw">as</span> <span class="dt">TLTX</span></a>
<a class="sourceLine" id="cb1-59" title="59"><span class="kw">import</span>           <span class="dt">Text.RE.TestBench</span></a>
<a class="sourceLine" id="cb1-60" title="60"><span class="kw">import</span>           <span class="dt">Text.RE.Tools.Find</span></a>
<a class="sourceLine" id="cb1-61" title="61"><span class="kw">import</span>           <span class="dt">Text.RE.Tools.Sed</span></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="kw">import</span>           <span class="dt">Text.RE.ZeInternals</span></a>
<a class="sourceLine" id="cb1-63" title="63"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.Regex.PCRE</span>                <span class="kw">as</span> <span class="dt">PCRE_</span></a>
<a class="sourceLine" id="cb1-64" title="64"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.Regex.TDFA</span>                <span class="kw">as</span> <span class="dt">TDFA_</span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" title="1"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb2-2" title="2">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="fu">print</span> SI.os</a>
<a class="sourceLine" id="cb2-4" title="4">  defaultMain <span class="fu">$</span></a>
<a class="sourceLine" id="cb2-5" title="5">    testGroup <span class="st">&quot;Tests&quot;</span></a>
<a class="sourceLine" id="cb2-6" title="6">      [ prelude_tests</a>
<a class="sourceLine" id="cb2-7" title="7">      , compiling_tests</a>
<a class="sourceLine" id="cb2-8" title="8">      , core_tests</a>
<a class="sourceLine" id="cb2-9" title="9">      , replace_methods_tests</a>
<a class="sourceLine" id="cb2-10" title="10">      , search_replace_tests</a>
<a class="sourceLine" id="cb2-11" title="11">      , options_tests</a>
<a class="sourceLine" id="cb2-12" title="12">      , named_capture_tests</a>
<a class="sourceLine" id="cb2-13" title="13">      , many_tests</a>
<a class="sourceLine" id="cb2-14" title="14">      , escape_tests</a>
<a class="sourceLine" id="cb2-15" title="15">      , add_capture_names_tests</a>
<a class="sourceLine" id="cb2-16" title="16">      , find_tests</a>
<a class="sourceLine" id="cb2-17" title="17">      , backslash_tests</a>
<a class="sourceLine" id="cb2-18" title="18">      , misc_tests</a>
<a class="sourceLine" id="cb2-19" title="19">      ]</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" title="1"><span class="co">-- | check that our self-testing macro environments are good</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="ot">prelude_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb3-3" title="3">prelude_tests <span class="fu">=</span> testGroup <span class="st">&quot;Prelude&quot;</span></a>
<a class="sourceLine" id="cb3-4" title="4">  [ tc TDFA.regexType TDFA.preludeEnv</a>
<a class="sourceLine" id="cb3-5" title="5">  , tc PCRE.regexType PCRE.preludeEnv</a>
<a class="sourceLine" id="cb3-6" title="6">  ]</a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-8" title="8">    tc rty m_env <span class="fu">=</span></a>
<a class="sourceLine" id="cb3-9" title="9">      testCase (<span class="fu">show</span> rty) <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb3-10" title="10">        is_docs <span class="ot">&lt;-</span> doesDirectoryExist <span class="st">&quot;docs&quot;</span></a>
<a class="sourceLine" id="cb3-11" title="11">        when is_docs <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-12" title="12">          dumpMacroTable (fp <span class="st">&quot;docs&quot;</span> <span class="st">&quot;.txt&quot;</span>) (fp <span class="st">&quot;docs&quot;</span> <span class="st">&quot;-src.txt&quot;</span>) rty m_env</a>
<a class="sourceLine" id="cb3-13" title="13">        dumpMacroTable   (fp <span class="st">&quot;data&quot;</span> <span class="st">&quot;.txt&quot;</span>) (fp <span class="st">&quot;data&quot;</span> <span class="st">&quot;-src.txt&quot;</span>) rty m_env</a>
<a class="sourceLine" id="cb3-14" title="14">        assertBool <span class="st">&quot;testMacroEnv&quot;</span> <span class="fu">=&lt;&lt;</span> testMacroEnv <span class="st">&quot;prelude&quot;</span> rty m_env</a>
<a class="sourceLine" id="cb3-15" title="15">      <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-16" title="16">        fp dir sfx <span class="fu">=</span> dir <span class="fu">&lt;/&gt;</span> (rty_s <span class="fu">++</span> <span class="st">&quot;-macros&quot;</span> <span class="fu">++</span> sfx)</a>
<a class="sourceLine" id="cb3-17" title="17"></a>
<a class="sourceLine" id="cb3-18" title="18">        rty_s      <span class="fu">=</span> <span class="fu">map</span> <span class="fu">toLower</span> <span class="fu">$</span> presentRegexType rty</a></code></pre></div>
<h2 id="core-matchreplace-tests">Core Match/Replace Tests</h2>
<h3>
test vectors
</h3>
<p>The core tests rely on these simple test vectors.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" title="1"><span class="co">-- | our standard test strings</span></a>
<a class="sourceLine" id="cb4-2" title="2">str_,<span class="ot"> str&#39; ::</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb4-3" title="3">str_      <span class="fu">=</span> <span class="st">&quot;a bbbb aa b&quot;</span></a>
<a class="sourceLine" id="cb4-4" title="4">str&#39;      <span class="fu">=</span> <span class="st">&quot;foo&quot;</span></a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">-- | standard test REs</span></a>
<a class="sourceLine" id="cb4-7" title="7">regex_,<span class="ot"> regex_alt ::</span> <span class="dt">RE</span></a>
<a class="sourceLine" id="cb4-8" title="8">regex_    <span class="fu">=</span> [re|(a+) (b+)|]</a>
<a class="sourceLine" id="cb4-9" title="9">regex_alt <span class="fu">=</span> [re|(a+)|(b+)|]</a>
<a class="sourceLine" id="cb4-10" title="10"></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">-- | golden matches result 1</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="ot">regex_str_matches ::</span> <span class="dt">Matches</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb4-13" title="13">regex_str_matches <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-14" title="14">  <span class="dt">Matches</span></a>
<a class="sourceLine" id="cb4-15" title="15">    { matchesSource <span class="fu">=</span> str_</a>
<a class="sourceLine" id="cb4-16" title="16">    , allMatches <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-17" title="17">        [ regex_str_match</a>
<a class="sourceLine" id="cb4-18" title="18">        , regex_str_match_2</a>
<a class="sourceLine" id="cb4-19" title="19">        ]</a>
<a class="sourceLine" id="cb4-20" title="20">    }</a>
<a class="sourceLine" id="cb4-21" title="21"></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">-- | golden match result 1</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="ot">regex_str_match ::</span> <span class="dt">Match</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb4-24" title="24">regex_str_match <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-25" title="25">  <span class="dt">Match</span></a>
<a class="sourceLine" id="cb4-26" title="26">    { matchSource   <span class="fu">=</span> str_</a>
<a class="sourceLine" id="cb4-27" title="27">    , captureNames  <span class="fu">=</span> noCaptureNames</a>
<a class="sourceLine" id="cb4-28" title="28">    , matchArray    <span class="fu">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-29" title="29">        [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;a bbbb&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">0</span>, captureLength <span class="fu">=</span> <span class="dv">6</span>})</a>
<a class="sourceLine" id="cb4-30" title="30">        , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;a&quot;</span>     , captureOffset <span class="fu">=</span> <span class="dv">0</span>, captureLength <span class="fu">=</span> <span class="dv">1</span>})</a>
<a class="sourceLine" id="cb4-31" title="31">        , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;bbbb&quot;</span>  , captureOffset <span class="fu">=</span> <span class="dv">2</span>, captureLength <span class="fu">=</span> <span class="dv">4</span>})</a>
<a class="sourceLine" id="cb4-32" title="32">        ]</a>
<a class="sourceLine" id="cb4-33" title="33">    }</a>
<a class="sourceLine" id="cb4-34" title="34"></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">-- | golden match result 2</span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="ot">regex_str_match_2 ::</span> <span class="dt">Match</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb4-37" title="37">regex_str_match_2 <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-38" title="38">  <span class="dt">Match</span></a>
<a class="sourceLine" id="cb4-39" title="39">    { matchSource   <span class="fu">=</span> str_</a>
<a class="sourceLine" id="cb4-40" title="40">    , captureNames  <span class="fu">=</span> noCaptureNames</a>
<a class="sourceLine" id="cb4-41" title="41">    , matchArray    <span class="fu">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-42" title="42">        [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;aa b&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">7</span> , captureLength <span class="fu">=</span> <span class="dv">4</span>})</a>
<a class="sourceLine" id="cb4-43" title="43">        , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;aa&quot;</span>  , captureOffset <span class="fu">=</span> <span class="dv">7</span> , captureLength <span class="fu">=</span> <span class="dv">2</span>})</a>
<a class="sourceLine" id="cb4-44" title="44">        , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;b&quot;</span>   , captureOffset <span class="fu">=</span> <span class="dv">10</span>, captureLength <span class="fu">=</span> <span class="dv">1</span>})</a>
<a class="sourceLine" id="cb4-45" title="45">        ]</a>
<a class="sourceLine" id="cb4-46" title="46">    }</a>
<a class="sourceLine" id="cb4-47" title="47"></a>
<a class="sourceLine" id="cb4-48" title="48"><span class="co">-- | golden match result 2</span></a>
<a class="sourceLine" id="cb4-49" title="49"><span class="ot">regex_alt_str_matches ::</span> <span class="dt">Matches</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb4-50" title="50">regex_alt_str_matches <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-51" title="51">  <span class="dt">Matches</span></a>
<a class="sourceLine" id="cb4-52" title="52">    { matchesSource <span class="fu">=</span> str_</a>
<a class="sourceLine" id="cb4-53" title="53">    , allMatches    <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-54" title="54">        [ <span class="dt">Match</span></a>
<a class="sourceLine" id="cb4-55" title="55">            { matchSource   <span class="fu">=</span> str_</a>
<a class="sourceLine" id="cb4-56" title="56">            , captureNames  <span class="fu">=</span> noCaptureNames</a>
<a class="sourceLine" id="cb4-57" title="57">            , matchArray    <span class="fu">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-58" title="58">                [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;a&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">0</span>, captureLength <span class="fu">=</span> <span class="dv">1</span>})</a>
<a class="sourceLine" id="cb4-59" title="59">                , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;a&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">0</span>, captureLength <span class="fu">=</span> <span class="dv">1</span>})</a>
<a class="sourceLine" id="cb4-60" title="60">                , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;&quot;</span>, captureOffset <span class="fu">=</span> <span class="fu">-</span><span class="dv">1</span>, captureLength <span class="fu">=</span> <span class="dv">0</span>})</a>
<a class="sourceLine" id="cb4-61" title="61">                ]</a>
<a class="sourceLine" id="cb4-62" title="62">            }</a>
<a class="sourceLine" id="cb4-63" title="63">        , <span class="dt">Match</span></a>
<a class="sourceLine" id="cb4-64" title="64">            { matchSource   <span class="fu">=</span> str_</a>
<a class="sourceLine" id="cb4-65" title="65">            , captureNames  <span class="fu">=</span> noCaptureNames</a>
<a class="sourceLine" id="cb4-66" title="66">            , matchArray    <span class="fu">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-67" title="67">                [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;bbbb&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">2</span> , captureLength <span class="fu">=</span> <span class="dv">4</span>})</a>
<a class="sourceLine" id="cb4-68" title="68">                , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;&quot;</span>    , captureOffset <span class="fu">=</span> <span class="fu">-</span><span class="dv">1</span>, captureLength <span class="fu">=</span> <span class="dv">0</span>})</a>
<a class="sourceLine" id="cb4-69" title="69">                , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;bbbb&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">2</span> , captureLength <span class="fu">=</span> <span class="dv">4</span>})</a>
<a class="sourceLine" id="cb4-70" title="70">                ]</a>
<a class="sourceLine" id="cb4-71" title="71">            }</a>
<a class="sourceLine" id="cb4-72" title="72">        , <span class="dt">Match</span></a>
<a class="sourceLine" id="cb4-73" title="73">            { matchSource   <span class="fu">=</span> str_</a>
<a class="sourceLine" id="cb4-74" title="74">            , captureNames  <span class="fu">=</span> noCaptureNames</a>
<a class="sourceLine" id="cb4-75" title="75">            , matchArray    <span class="fu">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-76" title="76">                [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;aa&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">7</span> , captureLength <span class="fu">=</span> <span class="dv">2</span>})</a>
<a class="sourceLine" id="cb4-77" title="77">                , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;aa&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">7</span> , captureLength <span class="fu">=</span> <span class="dv">2</span>})</a>
<a class="sourceLine" id="cb4-78" title="78">                , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;&quot;</span>  , captureOffset <span class="fu">=</span> <span class="fu">-</span><span class="dv">1</span>, captureLength <span class="fu">=</span> <span class="dv">0</span>})</a>
<a class="sourceLine" id="cb4-79" title="79">                ]</a>
<a class="sourceLine" id="cb4-80" title="80">            }</a>
<a class="sourceLine" id="cb4-81" title="81">        , <span class="dt">Match</span></a>
<a class="sourceLine" id="cb4-82" title="82">            { matchSource   <span class="fu">=</span> str_</a>
<a class="sourceLine" id="cb4-83" title="83">            , captureNames  <span class="fu">=</span> noCaptureNames</a>
<a class="sourceLine" id="cb4-84" title="84">            , matchArray    <span class="fu">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-85" title="85">                [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;b&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">10</span>, captureLength <span class="fu">=</span> <span class="dv">1</span>})</a>
<a class="sourceLine" id="cb4-86" title="86">                , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;&quot;</span> , captureOffset <span class="fu">=</span> <span class="fu">-</span><span class="dv">1</span>, captureLength <span class="fu">=</span> <span class="dv">0</span>})</a>
<a class="sourceLine" id="cb4-87" title="87">                , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="fu">=</span> str_, capturedText <span class="fu">=</span> <span class="st">&quot;b&quot;</span>, captureOffset <span class="fu">=</span> <span class="dv">10</span>, captureLength <span class="fu">=</span> <span class="dv">1</span>})</a>
<a class="sourceLine" id="cb4-88" title="88">                ]</a>
<a class="sourceLine" id="cb4-89" title="89">            }</a>
<a class="sourceLine" id="cb4-90" title="90">        ]</a>
<a class="sourceLine" id="cb4-91" title="91">    }</a></code></pre></div>
<h3>
testing the compileRegex functions
</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" title="1"><span class="ot">compiling_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb5-2" title="2">compiling_tests <span class="fu">=</span> testGroup <span class="st">&quot;Compiling&quot;</span></a>
<a class="sourceLine" id="cb5-3" title="3">  [ testCase <span class="st">&quot;complete check (matchM/ByteString)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-4" title="4">      r <span class="ot">&lt;-</span> TDFA.compileRegex <span class="fu">$</span> reSource regex_</a>
<a class="sourceLine" id="cb5-5" title="5">      assertEqual <span class="st">&quot;Match&quot;</span> (B.pack <span class="fu">&lt;$&gt;</span> regex_str_match) <span class="fu">$</span> B.pack str_ <span class="fu">?=~</span> r</a>
<a class="sourceLine" id="cb5-6" title="6">  , testCase <span class="st">&quot;matched (matchM/Text)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-7" title="7">      r <span class="ot">&lt;-</span> TDFA.compileRegex <span class="fu">$</span> reSource regex_</a>
<a class="sourceLine" id="cb5-8" title="8">      assertBool <span class="st">&quot;matched&quot;</span> <span class="fu">$</span> matched <span class="fu">$</span> T.pack str_ <span class="fu">?=~</span> r</a>
<a class="sourceLine" id="cb5-9" title="9">  , tc <span class="st">&quot;TDFA.String&quot;</span>  TDFA.compileRegex</a>
<a class="sourceLine" id="cb5-10" title="10">  , tc <span class="st">&quot;TDFA.B&quot;</span>     <span class="fu">$</span> TDFA.compileRegex <span class="fu">.</span> B.unpack</a>
<a class="sourceLine" id="cb5-11" title="11">  , tc <span class="st">&quot;TDFA.LBS&quot;</span>   <span class="fu">$</span> TDFA.compileRegex <span class="fu">.</span> LBS.unpack</a>
<a class="sourceLine" id="cb5-12" title="12">  , tc <span class="st">&quot;TDFA.T&quot;</span>     <span class="fu">$</span> TDFA.compileRegex <span class="fu">.</span> T.unpack</a>
<a class="sourceLine" id="cb5-13" title="13">  , tc <span class="st">&quot;TDFA.LT&quot;</span>    <span class="fu">$</span> TDFA.compileRegex <span class="fu">.</span> <span class="dt">LT</span><span class="fu">.</span>unpack</a>
<a class="sourceLine" id="cb5-14" title="14">  , tc <span class="st">&quot;TDFA.S&quot;</span>     <span class="fu">$</span> TDFA.compileRegex <span class="fu">.</span> s_toList</a>
<a class="sourceLine" id="cb5-15" title="15">  , tc <span class="st">&quot;PCRE.String&quot;</span>  PCRE.compileRegex</a>
<a class="sourceLine" id="cb5-16" title="16">  , tc <span class="st">&quot;PCRE.B&quot;</span>     <span class="fu">$</span> PCRE.compileRegex <span class="fu">.</span> B.unpack</a>
<a class="sourceLine" id="cb5-17" title="17">  , tc <span class="st">&quot;PCRE.LBS&quot;</span>   <span class="fu">$</span> PCRE.compileRegex <span class="fu">.</span> LBS.unpack</a>
<a class="sourceLine" id="cb5-18" title="18">  , tc <span class="st">&quot;PCRE.S&quot;</span>     <span class="fu">$</span> PCRE.compileRegex <span class="fu">.</span> s_toList</a>
<a class="sourceLine" id="cb5-19" title="19">  ]</a>
<a class="sourceLine" id="cb5-20" title="20">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="ot">    tc ::</span> <span class="dt">IsRegex</span> re s <span class="ot">=&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span><span class="dt">IO</span> re) <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb5-22" title="22">    tc lab mk0 <span class="fu">=</span> testGroup lab</a>
<a class="sourceLine" id="cb5-23" title="23">        [ testCase <span class="st">&quot;loop&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-24" title="24">            r <span class="ot">&lt;-</span> mk re_s</a>
<a class="sourceLine" id="cb5-25" title="25">            assertEqual <span class="st">&quot;RE&quot;</span> re_s <span class="fu">$</span> regexSource r</a>
<a class="sourceLine" id="cb5-26" title="26">        , testCase <span class="st">&quot;Match&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-27" title="27">            r <span class="ot">&lt;-</span> mk&#39; re_s</a>
<a class="sourceLine" id="cb5-28" title="28">            assertEqual <span class="st">&quot;Match&quot;</span>  (pk <span class="fu">&lt;$&gt;</span> regex_str_match) <span class="fu">$</span> matchOnce r <span class="fu">$</span> pk str_</a>
<a class="sourceLine" id="cb5-29" title="29">        , testCase <span class="st">&quot;Escape&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-30" title="30">            r <span class="ot">&lt;-</span> esc <span class="fu">$</span> pk <span class="st">&quot;foobar&quot;</span></a>
<a class="sourceLine" id="cb5-31" title="31">            assertEqual <span class="st">&quot;String&quot;</span> (pk <span class="st">&quot;bar&quot;</span>) <span class="fu">$</span> matchSource <span class="fu">$</span> matchOnce r <span class="fu">$</span> pk <span class="st">&quot;bar&quot;</span></a>
<a class="sourceLine" id="cb5-32" title="32">        ]</a>
<a class="sourceLine" id="cb5-33" title="33">      <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-34" title="34">        mk   <span class="fu">=</span> makeRegex              <span class="ot">`asTypeOf`</span> mk0</a>
<a class="sourceLine" id="cb5-35" title="35"></a>
<a class="sourceLine" id="cb5-36" title="36">        mk&#39;  <span class="fu">=</span> makeRegexWith <span class="fu">minBound</span> <span class="ot">`asTypeOf`</span> mk0</a>
<a class="sourceLine" id="cb5-37" title="37"></a>
<a class="sourceLine" id="cb5-38" title="38">        esc  <span class="fu">=</span> makeEscaped <span class="fu">id</span>         <span class="ot">`asTypeOf`</span> mk0</a>
<a class="sourceLine" id="cb5-39" title="39"></a>
<a class="sourceLine" id="cb5-40" title="40">        re_s <span class="fu">=</span> pk <span class="fu">$</span> reSource regex_</a>
<a class="sourceLine" id="cb5-41" title="41"></a>
<a class="sourceLine" id="cb5-42" title="42">        pk   <span class="fu">=</span> mk_pk mk0</a>
<a class="sourceLine" id="cb5-43" title="43"></a>
<a class="sourceLine" id="cb5-44" title="44"><span class="ot">        mk_pk ::</span> <span class="dt">Replace</span> s&#39; <span class="ot">=&gt;</span> (s&#39;<span class="ot">-&gt;</span><span class="dt">IO</span> re&#39;) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> s&#39;</a>
<a class="sourceLine" id="cb5-45" title="45">        mk_pk _ <span class="fu">=</span> packR</a></code></pre></div>
<h3>
core tests
</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" title="1"><span class="ot">core_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb6-2" title="2">core_tests <span class="fu">=</span> testGroup <span class="st">&quot;Match&quot;</span></a>
<a class="sourceLine" id="cb6-3" title="3">  [ testCase <span class="st">&quot;text (=~~Text.Lazy)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-4" title="4">      txt <span class="ot">&lt;-</span> <span class="dt">LT</span><span class="fu">.pack</span> str_ <span class="fu">=~~</span> [re|(a+) (b+)|]<span class="ot"> ::</span> <span class="dt">IO</span> (<span class="dt">LT</span><span class="fu">.</span><span class="dt">Text</span>)</a>
<a class="sourceLine" id="cb6-5" title="5">      assertEqual <span class="st">&quot;text&quot;</span> txt <span class="st">&quot;a bbbb&quot;</span></a>
<a class="sourceLine" id="cb6-6" title="6">  , testCase <span class="st">&quot;multi (=~~/String)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-7" title="7">      <span class="kw">let</span> sm <span class="fu">=</span> str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Match</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb6-8" title="8">          m  <span class="fu">=</span> capture [cp|0|] sm</a>
<a class="sourceLine" id="cb6-9" title="9">      assertEqual <span class="st">&quot;captureSource&quot;</span> <span class="st">&quot;a bbbb aa b&quot;</span> <span class="fu">$</span> captureSource m</a>
<a class="sourceLine" id="cb6-10" title="10">      assertEqual <span class="st">&quot;capturedText&quot;</span>  <span class="st">&quot;a bbbb&quot;</span>      <span class="fu">$</span> capturedText  m</a>
<a class="sourceLine" id="cb6-11" title="11">      assertEqual <span class="st">&quot;capturePrefix&quot;</span> <span class="st">&quot;&quot;</span>            <span class="fu">$</span> capturePrefix m</a>
<a class="sourceLine" id="cb6-12" title="12">      assertEqual <span class="st">&quot;captureSuffix&quot;</span> <span class="st">&quot; aa b&quot;</span>       <span class="fu">$</span> captureSuffix m</a>
<a class="sourceLine" id="cb6-13" title="13">  , testCase <span class="st">&quot;complete (=~~/ByteString)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-14" title="14">      mtch <span class="ot">&lt;-</span> B.pack str_ <span class="fu">=~~</span><span class="ot"> regex_ ::</span> <span class="dt">IO</span> (<span class="dt">Match</span> <span class="dt">B.ByteString</span>)</a>
<a class="sourceLine" id="cb6-15" title="15">      assertEqual <span class="st">&quot;Match&quot;</span> mtch <span class="fu">$</span> B.pack <span class="fu">&lt;$&gt;</span> regex_str_match</a>
<a class="sourceLine" id="cb6-16" title="16">  , testCase <span class="st">&quot;complete (all,String)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-17" title="17">      <span class="kw">let</span> mtchs <span class="fu">=</span> str_ <span class="fu">=~</span><span class="ot"> regex_     ::</span> <span class="dt">Matches</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb6-18" title="18">      assertEqual <span class="st">&quot;Matches&quot;</span> mtchs regex_str_matches</a>
<a class="sourceLine" id="cb6-19" title="19">  , testCase <span class="st">&quot;complete (all,reg_alt)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-20" title="20">      <span class="kw">let</span> mtchs <span class="fu">=</span> str_ <span class="fu">=~</span><span class="ot"> regex_alt  ::</span> <span class="dt">Matches</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb6-21" title="21">      assertEqual <span class="st">&quot;Matches&quot;</span> mtchs regex_alt_str_matches</a>
<a class="sourceLine" id="cb6-22" title="22">  , testCase <span class="st">&quot;complete (=~~,all)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-23" title="23">      mtchs <span class="ot">&lt;-</span> str_ <span class="fu">=~~</span><span class="ot"> regex_       ::</span> <span class="dt">IO</span> (<span class="dt">Matches</span> <span class="dt">String</span>)</a>
<a class="sourceLine" id="cb6-24" title="24">      assertEqual <span class="st">&quot;Matches&quot;</span> mtchs regex_str_matches</a>
<a class="sourceLine" id="cb6-25" title="25">  , testCase <span class="st">&quot;fail (all)&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-26" title="26">      <span class="kw">let</span> mtchs <span class="fu">=</span> str&#39; <span class="fu">=~</span><span class="ot"> regex_    ::</span> <span class="dt">Matches</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb6-27" title="27">      assertEqual <span class="st">&quot;not.anyMatches&quot;</span> <span class="dt">False</span> <span class="fu">$</span> anyMatches mtchs</a>
<a class="sourceLine" id="cb6-28" title="28">  ]</a></code></pre></div>
<h3>
testing the replace functions at different types
</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" title="1"><span class="ot">replace_methods_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb7-2" title="2">replace_methods_tests <span class="fu">=</span> testGroup <span class="st">&quot;Replace&quot;</span></a>
<a class="sourceLine" id="cb7-3" title="3">  [ testCase <span class="st">&quot;String/single&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-4" title="4">      <span class="kw">let</span> m <span class="fu">=</span> str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Match</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb7-5" title="5">          r <span class="fu">=</span> replaceCaptures <span class="dt">ALL</span> fmt m</a>
<a class="sourceLine" id="cb7-6" title="6">      assertEqual <span class="st">&quot;replaceCaptures&quot;</span> r <span class="st">&quot;(0:0:(0:1:a) (0:2:bbbb)) aa b&quot;</span></a>
<a class="sourceLine" id="cb7-7" title="7">  , testCase <span class="st">&quot;String/alt&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-8" title="8">      <span class="kw">let</span> ms <span class="fu">=</span> str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb7-9" title="9">          r  <span class="fu">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</a>
<a class="sourceLine" id="cb7-10" title="10">      chk r</a>
<a class="sourceLine" id="cb7-11" title="11">  , testCase <span class="st">&quot;String&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-12" title="12">      <span class="kw">let</span> ms <span class="fu">=</span> str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb7-13" title="13">          r  <span class="fu">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</a>
<a class="sourceLine" id="cb7-14" title="14">      chk r</a>
<a class="sourceLine" id="cb7-15" title="15">  , testCase <span class="st">&quot;ByteString&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-16" title="16">      <span class="kw">let</span> ms <span class="fu">=</span> B.pack str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">B.ByteString</span></a>
<a class="sourceLine" id="cb7-17" title="17">          r  <span class="fu">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</a>
<a class="sourceLine" id="cb7-18" title="18">      chk r</a>
<a class="sourceLine" id="cb7-19" title="19">  , testCase <span class="st">&quot;LBS.ByteString&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-20" title="20">      <span class="kw">let</span> ms <span class="fu">=</span> LBS.pack str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">LBS.ByteString</span></a>
<a class="sourceLine" id="cb7-21" title="21">          r  <span class="fu">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</a>
<a class="sourceLine" id="cb7-22" title="22">      chk r</a>
<a class="sourceLine" id="cb7-23" title="23">  , testCase <span class="st">&quot;Seq Char&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-24" title="24">      <span class="kw">let</span> ms <span class="fu">=</span> S.fromList str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> (<span class="dt">S.Seq</span> <span class="dt">Char</span>)</a>
<a class="sourceLine" id="cb7-25" title="25">          f  <span class="fu">=</span> \_ (<span class="dt">RELocation</span> i j) <span class="dt">Capture</span>{<span class="fu">..</span>} <span class="ot">-&gt;</span> <span class="dt">Just</span> <span class="fu">$</span> S.fromList <span class="fu">$</span></a>
<a class="sourceLine" id="cb7-26" title="26">                  <span class="st">&quot;(&quot;</span> <span class="fu">M.&lt;&gt;</span> <span class="fu">show</span> i <span class="fu">M.&lt;&gt;</span> <span class="st">&quot;:&quot;</span> <span class="fu">M.&lt;&gt;</span> show_co j <span class="fu">M.&lt;&gt;</span> <span class="st">&quot;:&quot;</span> <span class="fu">M.&lt;&gt;</span></a>
<a class="sourceLine" id="cb7-27" title="27">                    F.toList capturedText <span class="fu">M.&lt;&gt;</span> <span class="st">&quot;)&quot;</span></a>
<a class="sourceLine" id="cb7-28" title="28">          r  <span class="fu">=</span> replaceAllCaptures <span class="dt">ALL</span> f ms</a>
<a class="sourceLine" id="cb7-29" title="29">      assertEqual <span class="st">&quot;replaceAllCaptures&quot;</span> r <span class="fu">$</span></a>
<a class="sourceLine" id="cb7-30" title="30">        S.fromList <span class="st">&quot;(0:0:(0:1:a) (0:2:bbbb)) (1:0:(1:1:aa) (1:2:b))&quot;</span></a>
<a class="sourceLine" id="cb7-31" title="31">  , testCase <span class="st">&quot;Text&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-32" title="32">      <span class="kw">let</span> ms <span class="fu">=</span> T.pack str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">T.Text</span></a>
<a class="sourceLine" id="cb7-33" title="33">          r  <span class="fu">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</a>
<a class="sourceLine" id="cb7-34" title="34">      chk r</a>
<a class="sourceLine" id="cb7-35" title="35">  , testCase <span class="st">&quot;LT.Text&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-36" title="36">      <span class="kw">let</span> ms <span class="fu">=</span> <span class="dt">LT</span><span class="fu">.pack</span> str_ <span class="fu">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">LT</span><span class="fu">.</span><span class="dt">Text</span></a>
<a class="sourceLine" id="cb7-37" title="37">          r  <span class="fu">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</a>
<a class="sourceLine" id="cb7-38" title="38">      chk r</a>
<a class="sourceLine" id="cb7-39" title="39">  ]</a>
<a class="sourceLine" id="cb7-40" title="40">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb7-41" title="41">    chk r <span class="fu">=</span></a>
<a class="sourceLine" id="cb7-42" title="42">      assertEqual</a>
<a class="sourceLine" id="cb7-43" title="43">        <span class="st">&quot;replaceAllCaptures&quot;</span></a>
<a class="sourceLine" id="cb7-44" title="44">        r</a>
<a class="sourceLine" id="cb7-45" title="45">        <span class="st">&quot;(0:0:(0:1:a) (0:2:bbbb)) (1:0:(1:1:aa) (1:2:b))&quot;</span></a>
<a class="sourceLine" id="cb7-46" title="46"></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="ot">    fmt ::</span> (<span class="dt">IsString</span> s,<span class="dt">Replace</span> s) <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">RELocation</span> <span class="ot">-&gt;</span> <span class="dt">Capture</span> s <span class="ot">-&gt;</span> <span class="dt">Maybe</span> s</a>
<a class="sourceLine" id="cb7-48" title="48">    fmt _ (<span class="dt">RELocation</span> i j) <span class="dt">Capture</span>{<span class="fu">..</span>} <span class="fu">=</span> <span class="dt">Just</span> <span class="fu">$</span> <span class="st">&quot;(&quot;</span> <span class="fu">M.&lt;&gt;</span> packR (<span class="fu">show</span> i) <span class="fu">M.&lt;&gt;</span> <span class="st">&quot;:&quot;</span> <span class="fu">M.&lt;&gt;</span></a>
<a class="sourceLine" id="cb7-49" title="49">      packR (show_co j) <span class="fu">M.&lt;&gt;</span> <span class="st">&quot;:&quot;</span> <span class="fu">M.&lt;&gt;</span> capturedText <span class="fu">M.&lt;&gt;</span> <span class="st">&quot;)&quot;</span></a>
<a class="sourceLine" id="cb7-50" title="50"></a>
<a class="sourceLine" id="cb7-51" title="51">    show_co (<span class="dt">CaptureOrdinal</span> j) <span class="fu">=</span> <span class="fu">show</span> j</a></code></pre></div>
<h3>
SearchReplace
</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" title="1"><span class="ot">search_replace_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb8-2" title="2">search_replace_tests <span class="fu">=</span> testGroup <span class="st">&quot;SearchReplace&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-3" title="3">    [ testCase <span class="st">&quot;?=~/ [ed_| ... |]&quot;</span> <span class="fu">$</span> <span class="st">&quot;baz bar foobar&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;foo bar foobar&quot;</span> <span class="fu">T_ST.?=~/</span> [ed_|foo///baz|] ()</a>
<a class="sourceLine" id="cb8-4" title="4">    , testCase <span class="st">&quot;*=~/ [ed_| ... |]&quot;</span> <span class="fu">$</span> <span class="st">&quot;baz bar bazbar&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;foo bar foobar&quot;</span> <span class="fu">T_ST.*=~/</span> [ed_|foo///baz|] <span class="dt">MultilineSensitive</span></a>
<a class="sourceLine" id="cb8-5" title="5">    , testCase <span class="st">&quot;TDFA.ed/String&quot;</span> <span class="fu">$</span> test_ <span class="fu">id</span>         tdfa_eds</a>
<a class="sourceLine" id="cb8-6" title="6">    , testCase <span class="st">&quot;PCRE.ed/String&quot;</span> <span class="fu">$</span> test_ <span class="fu">id</span>         pcre_eds</a>
<a class="sourceLine" id="cb8-7" title="7">    , testCase <span class="st">&quot;TDFA.ed/B&quot;</span>      <span class="fu">$</span> test_ B.pack     tdfa_eds</a>
<a class="sourceLine" id="cb8-8" title="8">    , testCase <span class="st">&quot;PCRE.ed/B&quot;</span>      <span class="fu">$</span> test_ B.pack     pcre_eds</a>
<a class="sourceLine" id="cb8-9" title="9">    , testCase <span class="st">&quot;TDFA.ed/LBS&quot;</span>    <span class="fu">$</span> test_ LBS.pack   tdfa_eds</a>
<a class="sourceLine" id="cb8-10" title="10">    , testCase <span class="st">&quot;PCRE.ed/LBS&quot;</span>    <span class="fu">$</span> test_ LBS.pack   pcre_eds</a>
<a class="sourceLine" id="cb8-11" title="11">    , testCase <span class="st">&quot;TDFA.ed/S&quot;</span>      <span class="fu">$</span> test_ S.fromList tdfa_eds</a>
<a class="sourceLine" id="cb8-12" title="12">    , testCase <span class="st">&quot;PCRE.ed/S&quot;</span>      <span class="fu">$</span> test_ S.fromList pcre_eds</a>
<a class="sourceLine" id="cb8-13" title="13">    , testCase <span class="st">&quot;TDFA.ed/T&quot;</span>      <span class="fu">$</span> test_ T.pack     tdfa_eds</a>
<a class="sourceLine" id="cb8-14" title="14">    , testCase <span class="st">&quot;TDFA.ed/LT&quot;</span>     <span class="fu">$</span> test_ <span class="dt">LT</span><span class="fu">.pack</span>    tdfa_eds</a>
<a class="sourceLine" id="cb8-15" title="15">    , testCase <span class="st">&quot;TDFA.ed/T(d)&quot;</span>   <span class="fu">$</span> test_ T.pack     tdfa_eds&#39;</a>
<a class="sourceLine" id="cb8-16" title="16">    , testCase <span class="st">&quot;PCRE.ed/LBS(d)&quot;</span> <span class="fu">$</span> test_ LBS.pack   pcre_eds&#39;</a>
<a class="sourceLine" id="cb8-17" title="17">    , testg <span class="st">&quot;TDFA.op&quot;</span>        (<span class="fu">T_ST.?=~/</span>) (<span class="fu">T_ST.*=~/</span>) tdfa_sr</a>
<a class="sourceLine" id="cb8-18" title="18">    , testg <span class="st">&quot;PCRE.op&quot;</span>        (<span class="fu">P_ST.?=~/</span>) (<span class="fu">P_ST.*=~/</span>) pcre_sr</a>
<a class="sourceLine" id="cb8-19" title="19">    , testg <span class="st">&quot;TDFA.op/String&quot;</span> (<span class="fu">T_ST.?=~/</span>) (<span class="fu">T_ST.*=~/</span>) tdfa_sr_str</a>
<a class="sourceLine" id="cb8-20" title="20">    , testg <span class="st">&quot;PCRE.op/String&quot;</span> (<span class="fu">P_ST.?=~/</span>) (<span class="fu">P_ST.*=~/</span>) pcre_sr_str</a>
<a class="sourceLine" id="cb8-21" title="21">    , testg <span class="st">&quot;TDFA.op/B&quot;</span>      (<span class="fu">T_BS.?=~/</span>) (<span class="fu">T_BS.*=~/</span>) tdfa_sr_b</a>
<a class="sourceLine" id="cb8-22" title="22">    , testg <span class="st">&quot;PCRE.op/B&quot;</span>      (<span class="fu">P_BS.?=~/</span>) (<span class="fu">P_BS.*=~/</span>) pcre_sr_b</a>
<a class="sourceLine" id="cb8-23" title="23">    , testg <span class="st">&quot;TDFA.op/LBS&quot;</span>    (<span class="fu">TLBS.?=~/</span>) (<span class="fu">TLBS.*=~/</span>) tdfa_sr_lbs</a>
<a class="sourceLine" id="cb8-24" title="24">    , testg <span class="st">&quot;PCRE.op/LBS&quot;</span>    (<span class="fu">PLBS.?=~/</span>) (<span class="fu">PLBS.*=~/</span>) pcre_sr_lbs</a>
<a class="sourceLine" id="cb8-25" title="25">    , testg <span class="st">&quot;TDFA.op/T&quot;</span>      (<span class="fu">T_TX.?=~/</span>) (<span class="fu">T_TX.*=~/</span>) tdfa_sr_t</a>
<a class="sourceLine" id="cb8-26" title="26">    , testg <span class="st">&quot;PCRE.op/T&quot;</span>      (<span class="fu">P_TX.?=~/</span>) (<span class="fu">P_TX.*=~/</span>) pcre_sr_t</a>
<a class="sourceLine" id="cb8-27" title="27">    , testg <span class="st">&quot;TDFA.op/LT&quot;</span>     (<span class="fu">TLTX.?=~/</span>) (<span class="fu">TLTX.*=~/</span>) tdfa_sr_lt</a>
<a class="sourceLine" id="cb8-28" title="28">    , testg <span class="st">&quot;PCRE.op/LT&quot;</span>     (<span class="fu">PLTX.?=~/</span>) (<span class="fu">PLTX.*=~/</span>) pcre_sr_lt</a>
<a class="sourceLine" id="cb8-29" title="29">    , testG <span class="st">&quot;TDFA.op/S&quot;</span>      (<span class="fu">T_SQ.?=~/</span>) (<span class="fu">T_SQ.*=~/</span>) tdfa_sr_s</a>
<a class="sourceLine" id="cb8-30" title="30">    , testG <span class="st">&quot;PCRE.op/S&quot;</span>      (<span class="fu">P_SQ.?=~/</span>) (<span class="fu">P_SQ.*=~/</span>) pcre_sr_s</a>
<a class="sourceLine" id="cb8-31" title="31">    , testu <span class="st">&quot;TDFA.U/String&quot;</span> <span class="fu">id</span>              (<span class="fu">T_ST.*=~/</span>) [T_ST.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">T_ST.*=~</span>) [T_ST.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-32" title="32">    , testu <span class="st">&quot;TDFA.U/B&quot;</span>      B.fromString    (<span class="fu">T_BS.*=~/</span>) [T_BS.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">T_BS.*=~</span>) [T_BS.re<span class="fu">|</span>burble<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-33" title="33">    , testu <span class="st">&quot;TDFA.U/LBS&quot;</span>    LBS.fromString  (<span class="fu">TLBS.*=~/</span>) [TLBS.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">TLBS.*=~</span>) [TLBS.re<span class="fu">|</span>burble<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-34" title="34">    , testu <span class="st">&quot;TDFA.U/T&quot;</span>      T.pack          (<span class="fu">T_TX.*=~/</span>) [T_TX.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">T_TX.*=~</span>) [T_TX.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-35" title="35">    , testu <span class="st">&quot;TDFA.U/LT&quot;</span>     <span class="dt">LT</span><span class="fu">.pack</span>         (<span class="fu">TLTX.*=~/</span>) [TLTX.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">TLTX.*=~</span>) [TLTX.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-36" title="36">    , testu <span class="st">&quot;TDFA.U/S&quot;</span>      S.fromList      (<span class="fu">T_SQ.*=~/</span>) [T_SQ.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">T_SQ.*=~</span>) [T_SQ.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-37" title="37">    ] <span class="fu">++</span> not_win32_for_now</a>
<a class="sourceLine" id="cb8-38" title="38">    [ testu <span class="st">&quot;PCRE.U/String&quot;</span> <span class="fu">id</span>              (<span class="fu">P_ST.*=~/</span>) [P_ST.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">P_ST.*=~</span>) [P_ST.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-39" title="39">    , testu <span class="st">&quot;PCRE.U/B&quot;</span>      B.fromString    (<span class="fu">P_BS.*=~/</span>) [P_BS.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">P_BS.*=~</span>) [P_BS.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-40" title="40">    , testu <span class="st">&quot;PCRE.U/LBS&quot;</span>    LBS.fromString  (<span class="fu">PLBS.*=~/</span>) [PLBS.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">PLBS.*=~</span>) [PLBS.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-41" title="41">    , testu <span class="st">&quot;PCRE.U/T&quot;</span>      T.pack          (<span class="fu">P_TX.*=~/</span>) [P_TX.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">P_TX.*=~</span>) [P_TX.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-42" title="42">    , testu <span class="st">&quot;PCRE.U/LT&quot;</span>     <span class="dt">LT</span><span class="fu">.pack</span>         (<span class="fu">PLTX.*=~/</span>) [PLTX.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">PLTX.*=~</span>) [PLTX.re<span class="fu">|</span>Î»<span class="fu">-|</span>]</a>
<a class="sourceLine" id="cb8-43" title="43">    , testu <span class="st">&quot;PCRE.U/S&quot;</span>      S.fromList      (<span class="fu">P_SQ.*=~/</span>) [P_SQ.ed<span class="fu">|</span>scientist<span class="fu">///</span>boffin<span class="fu">|</span>] (<span class="fu">P_SQ.*=~</span>) [P_SQ.re<span class="fu">|</span>burble<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-44" title="44">    ]</a>
<a class="sourceLine" id="cb8-45" title="45">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb8-46" title="46"><span class="ot">    not_win32_for_now ::</span> [a] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb8-47" title="47">    not_win32_for_now <span class="fu">=</span> <span class="kw">case</span> SI.os <span class="fu">==</span> <span class="st">&quot;mingw32&quot;</span> <span class="kw">of</span></a>
<a class="sourceLine" id="cb8-48" title="48">      <span class="dt">True</span>  <span class="ot">-&gt;</span> <span class="fu">const</span> []</a>
<a class="sourceLine" id="cb8-49" title="49">      <span class="dt">False</span> <span class="ot">-&gt;</span> <span class="fu">id</span></a>
<a class="sourceLine" id="cb8-50" title="50"></a>
<a class="sourceLine" id="cb8-51" title="51"><span class="ot">    test_ ::</span> <span class="dt">IsRegex</span> re a <span class="ot">=&gt;</span> (<span class="dt">String</span><span class="ot">-&gt;</span>a) <span class="ot">-&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> re a <span class="ot">-&gt;</span> <span class="dt">Assertion</span></a>
<a class="sourceLine" id="cb8-52" title="52">    test_ inj eds <span class="fu">=</span>  inj rsm <span class="fu">@=?</span> runIdentity (sed&#39; eds <span class="fu">$</span> inj inp)</a>
<a class="sourceLine" id="cb8-53" title="53"></a>
<a class="sourceLine" id="cb8-54" title="54">    testg lab op1 opm sr <span class="fu">=</span> testGroup lab</a>
<a class="sourceLine" id="cb8-55" title="55">      [ testCase <span class="st">&quot;?=~/&quot;</span> <span class="fu">$</span> rs1 <span class="fu">@=?</span> inp <span class="ot">`op1`</span> sr</a>
<a class="sourceLine" id="cb8-56" title="56">      , testCase <span class="st">&quot;*=~/&quot;</span> <span class="fu">$</span> rsm <span class="fu">@=?</span> inp <span class="ot">`opm`</span> sr</a>
<a class="sourceLine" id="cb8-57" title="57">      ]</a>
<a class="sourceLine" id="cb8-58" title="58"></a>
<a class="sourceLine" id="cb8-59" title="59">    testG lab op1 opm sr <span class="fu">=</span> testGroup lab</a>
<a class="sourceLine" id="cb8-60" title="60">      [ testCase <span class="st">&quot;?=~/&quot;</span> <span class="fu">$</span> S.fromList rs1 <span class="fu">@=?</span> S.fromList inp <span class="ot">`op1`</span> sr</a>
<a class="sourceLine" id="cb8-61" title="61">      , testCase <span class="st">&quot;*=~/&quot;</span> <span class="fu">$</span> S.fromList rsm <span class="fu">@=?</span> S.fromList inp <span class="ot">`opm`</span> sr</a>
<a class="sourceLine" id="cb8-62" title="62">      ]</a>
<a class="sourceLine" id="cb8-63" title="63"></a>
<a class="sourceLine" id="cb8-64" title="64">    testu lab inj op sr qop rex <span class="fu">=</span> testGroup lab</a>
<a class="sourceLine" id="cb8-65" title="65">      [ testCase <span class="st">&quot;*=~/&quot;</span> <span class="fu">$</span> inj unr <span class="fu">@=?</span> inj uni <span class="ot">`op`</span> sr</a>
<a class="sourceLine" id="cb8-66" title="66">      , testCase <span class="st">&quot;*=~&quot;</span>  <span class="fu">$</span> <span class="dv">1</span>       <span class="fu">@=?</span> countMatches (inj uni <span class="ot">`qop`</span> rex)</a>
<a class="sourceLine" id="cb8-67" title="67">      ]</a>
<a class="sourceLine" id="cb8-68" title="68"></a>
<a class="sourceLine" id="cb8-69" title="69">    inp, rs1,<span class="ot"> rsm ::</span> <span class="dt">IsString</span> a <span class="ot">=&gt;</span> a</a>
<a class="sourceLine" id="cb8-70" title="70">    inp <span class="fu">=</span> <span class="st">&quot;16/03/2017 01/01/2000\n&quot;</span></a>
<a class="sourceLine" id="cb8-71" title="71">    rs1 <span class="fu">=</span> <span class="st">&quot;2017-03-16 01/01/2000\n&quot;</span></a>
<a class="sourceLine" id="cb8-72" title="72">    rsm <span class="fu">=</span> <span class="st">&quot;2017-03-16 2000-01-01\n&quot;</span></a>
<a class="sourceLine" id="cb8-73" title="73"></a>
<a class="sourceLine" id="cb8-74" title="74">    uni,<span class="ot"> unr ::</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb8-75" title="75">    uni <span class="fu">=</span> <span class="st">&quot;\x2070E-\8364-\955-scientist-burble&quot;</span></a>
<a class="sourceLine" id="cb8-76" title="76">    unr <span class="fu">=</span> <span class="st">&quot;\x2070E-\8364-\955-boffin-burble&quot;</span></a>
<a class="sourceLine" id="cb8-77" title="77"></a>
<a class="sourceLine" id="cb8-78" title="78"><span class="ot">    tdfa_eds    ::</span> <span class="dt">IsRegex</span> <span class="dt">TDFA.RE</span> a <span class="ot">=&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> <span class="dt">TDFA.RE</span> a</a>
<a class="sourceLine" id="cb8-79" title="79">    tdfa_eds    <span class="fu">=</span> <span class="dt">Select</span> [<span class="dt">Template</span> tdfa_sr]</a>
<a class="sourceLine" id="cb8-80" title="80"></a>
<a class="sourceLine" id="cb8-81" title="81"><span class="ot">    pcre_eds    ::</span> <span class="dt">IsRegex</span> <span class="dt">PCRE.RE</span> a <span class="ot">=&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> <span class="dt">PCRE.RE</span> a</a>
<a class="sourceLine" id="cb8-82" title="82">    pcre_eds    <span class="fu">=</span> <span class="dt">Select</span> [<span class="dt">Template</span> pcre_sr]</a>
<a class="sourceLine" id="cb8-83" title="83"></a>
<a class="sourceLine" id="cb8-84" title="84"><span class="ot">    tdfa_sr     ::</span> <span class="dt">IsRegex</span> <span class="dt">TDFA.RE</span> a <span class="ot">=&gt;</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> a</a>
<a class="sourceLine" id="cb8-85" title="85">    tdfa_sr     <span class="fu">=</span> [TDFA.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-86" title="86"></a>
<a class="sourceLine" id="cb8-87" title="87"><span class="ot">    pcre_sr     ::</span> <span class="dt">IsRegex</span> <span class="dt">PCRE.RE</span> a <span class="ot">=&gt;</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> a</a>
<a class="sourceLine" id="cb8-88" title="88">    pcre_sr     <span class="fu">=</span> [PCRE.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-89" title="89"></a>
<a class="sourceLine" id="cb8-90" title="90"><span class="ot">    tdfa_sr_str ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb8-91" title="91">    tdfa_sr_str <span class="fu">=</span> [T_ST.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-92" title="92"></a>
<a class="sourceLine" id="cb8-93" title="93"><span class="ot">    pcre_sr_str ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb8-94" title="94">    pcre_sr_str <span class="fu">=</span> [P_ST.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-95" title="95"></a>
<a class="sourceLine" id="cb8-96" title="96"><span class="ot">    tdfa_sr_b   ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">B.ByteString</span></a>
<a class="sourceLine" id="cb8-97" title="97">    tdfa_sr_b   <span class="fu">=</span> [T_BS.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-98" title="98"></a>
<a class="sourceLine" id="cb8-99" title="99"><span class="ot">    pcre_sr_b   ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">B.ByteString</span></a>
<a class="sourceLine" id="cb8-100" title="100">    pcre_sr_b   <span class="fu">=</span> [P_BS.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-101" title="101"></a>
<a class="sourceLine" id="cb8-102" title="102"><span class="ot">    tdfa_sr_lbs ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">LBS.ByteString</span></a>
<a class="sourceLine" id="cb8-103" title="103">    tdfa_sr_lbs <span class="fu">=</span> [TLBS.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-104" title="104"></a>
<a class="sourceLine" id="cb8-105" title="105"><span class="ot">    pcre_sr_lbs ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">LBS.ByteString</span></a>
<a class="sourceLine" id="cb8-106" title="106">    pcre_sr_lbs <span class="fu">=</span> [PLBS.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-107" title="107"></a>
<a class="sourceLine" id="cb8-108" title="108"><span class="ot">    tdfa_sr_t   ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">T.Text</span></a>
<a class="sourceLine" id="cb8-109" title="109">    tdfa_sr_t   <span class="fu">=</span> [T_TX.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-110" title="110"></a>
<a class="sourceLine" id="cb8-111" title="111"><span class="ot">    pcre_sr_t   ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">T.Text</span></a>
<a class="sourceLine" id="cb8-112" title="112">    pcre_sr_t   <span class="fu">=</span> [P_TX.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-113" title="113"></a>
<a class="sourceLine" id="cb8-114" title="114"><span class="ot">    tdfa_sr_lt  ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">LT</span><span class="fu">.</span><span class="dt">Text</span></a>
<a class="sourceLine" id="cb8-115" title="115">    tdfa_sr_lt  <span class="fu">=</span> [TLTX.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-116" title="116"></a>
<a class="sourceLine" id="cb8-117" title="117"><span class="ot">    pcre_sr_lt  ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">LT</span><span class="fu">.</span><span class="dt">Text</span></a>
<a class="sourceLine" id="cb8-118" title="118">    pcre_sr_lt  <span class="fu">=</span> [PLTX.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-119" title="119"></a>
<a class="sourceLine" id="cb8-120" title="120"><span class="ot">    tdfa_sr_s   ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> (<span class="dt">S.Seq</span> <span class="dt">Char</span>)</a>
<a class="sourceLine" id="cb8-121" title="121">    tdfa_sr_s   <span class="fu">=</span> [T_SQ.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-122" title="122"></a>
<a class="sourceLine" id="cb8-123" title="123"><span class="ot">    pcre_sr_s   ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> (<span class="dt">S.Seq</span> <span class="dt">Char</span>)</a>
<a class="sourceLine" id="cb8-124" title="124">    pcre_sr_s   <span class="fu">=</span> [P_SQ.ed<span class="fu">|$</span>{d}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{m}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="fu">/$</span>{y}([<span class="dv">0</span><span class="fu">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="fu">///$</span>{y}<span class="fu">-$</span>{m}<span class="fu">-$</span>{d}<span class="fu">|</span>]</a>
<a class="sourceLine" id="cb8-125" title="125"></a>
<a class="sourceLine" id="cb8-126" title="126"><span class="ot">    tdfa_eds&#39;   ::</span> <span class="dt">IsRegex</span> <span class="dt">TDFA.RE</span> a <span class="ot">=&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> <span class="dt">TDFA.RE</span> a</a>
<a class="sourceLine" id="cb8-127" title="127">    tdfa_eds&#39;   <span class="fu">=</span> <span class="dt">Select</span> [<span class="dt">Template</span> <span class="fu">$</span> tdfa_csr <span class="st">&quot;${d}([0-9]{2})/${m}([0-9]{2})/${y}([0-9]{4})&quot;</span> <span class="st">&quot;${y}-${m}-${d}&quot;</span>]</a>
<a class="sourceLine" id="cb8-128" title="128"></a>
<a class="sourceLine" id="cb8-129" title="129"><span class="ot">    pcre_eds&#39;   ::</span> <span class="dt">IsRegex</span> <span class="dt">PCRE.RE</span> a <span class="ot">=&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> <span class="dt">PCRE.RE</span> a</a>
<a class="sourceLine" id="cb8-130" title="130">    pcre_eds&#39;   <span class="fu">=</span> <span class="dt">Select</span> [<span class="dt">Template</span> <span class="fu">$</span> pcre_csr <span class="st">&quot;${d}([0-9]{2})/${m}([0-9]{2})/${y}([0-9]{4})&quot;</span> <span class="st">&quot;${y}-${m}-${d}&quot;</span>]</a>
<a class="sourceLine" id="cb8-131" title="131"></a>
<a class="sourceLine" id="cb8-132" title="132"><span class="ot">    tdfa_csr    ::</span> <span class="dt">IsRegex</span> <span class="dt">TDFA.RE</span> s</a>
<a class="sourceLine" id="cb8-133" title="133">                <span class="ot">=&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb8-134" title="134">                <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb8-135" title="135">                <span class="ot">-&gt;</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> s</a>
<a class="sourceLine" id="cb8-136" title="136">    tdfa_csr re_s <span class="fu">=</span> <span class="fu">either</span> <span class="fu">error</span> <span class="fu">id</span> <span class="fu">.</span> TDFA.compileSearchReplace re_s</a>
<a class="sourceLine" id="cb8-137" title="137"></a>
<a class="sourceLine" id="cb8-138" title="138"><span class="ot">    pcre_csr    ::</span> <span class="dt">IsRegex</span> <span class="dt">PCRE.RE</span> s</a>
<a class="sourceLine" id="cb8-139" title="139">                <span class="ot">=&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb8-140" title="140">                <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb8-141" title="141">                <span class="ot">-&gt;</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> s</a>
<a class="sourceLine" id="cb8-142" title="142">    pcre_csr re_s <span class="fu">=</span> <span class="fu">either</span> <span class="fu">error</span> <span class="fu">id</span> <span class="fu">.</span> PCRE.compileSearchReplace re_s</a></code></pre></div>
<h3>
Testing The REOptions
</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" title="1"><span class="ot">options_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb9-2" title="2">options_tests <span class="fu">=</span> testGroup <span class="st">&quot;Simple REOptions&quot;</span></a>
<a class="sourceLine" id="cb9-3" title="3">  [ testGroup <span class="st">&quot;TDFA Simple REOptions&quot;</span></a>
<a class="sourceLine" id="cb9-4" title="4">      [ testCase <span class="st">&quot;default (MultilineSensitive)&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">2</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-5" title="5">          countMatches <span class="fu">$</span> s <span class="fu">TDFA.*=~</span> [TDFA.re<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-6" title="6">      , testCase <span class="st">&quot;MultilineSensitive&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">2</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-7" title="7">          countMatches <span class="fu">$</span> s <span class="fu">TDFA.*=~</span> [TDFA.reMultilineSensitive<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-8" title="8">      , testCase <span class="st">&quot;MultilineInsensitive&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">4</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-9" title="9">          countMatches <span class="fu">$</span> s <span class="fu">TDFA.*=~</span> [TDFA.reMultilineInsensitive<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-10" title="10">      , testCase <span class="st">&quot;BlockSensitive&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">0</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-11" title="11">          countMatches <span class="fu">$</span> s <span class="fu">TDFA.*=~</span> [TDFA.reBlockSensitive<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-12" title="12">      , testCase <span class="st">&quot;BlockInsensitive&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">1</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-13" title="13">          countMatches <span class="fu">$</span> s <span class="fu">TDFA.*=~</span> [TDFA.reBlockInsensitive<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-14" title="14">      ]</a>
<a class="sourceLine" id="cb9-15" title="15">  , testGroup <span class="st">&quot;PCRE Simple REOptions&quot;</span></a>
<a class="sourceLine" id="cb9-16" title="16">      [ testCase <span class="st">&quot;default (MultilineSensitive)&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">2</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-17" title="17">          countMatches <span class="fu">$</span> s <span class="fu">PCRE.*=~</span> [PCRE.re<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-18" title="18">      , testCase <span class="st">&quot;MultilineSensitive&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">2</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-19" title="19">          countMatches <span class="fu">$</span> s <span class="fu">PCRE.*=~</span> [PCRE.reMultilineSensitive<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-20" title="20">      , testCase <span class="st">&quot;MultilineInsensitive&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">4</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-21" title="21">          countMatches <span class="fu">$</span> s <span class="fu">PCRE.*=~</span> [PCRE.reMultilineInsensitive<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-22" title="22">      , testCase <span class="st">&quot;BlockSensitive&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">0</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-23" title="23">          countMatches <span class="fu">$</span> s <span class="fu">PCRE.*=~</span> [PCRE.reBlockSensitive<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-24" title="24">      , testCase <span class="st">&quot;BlockInsensitive&quot;</span> <span class="fu">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">1</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-25" title="25">          countMatches <span class="fu">$</span> s <span class="fu">PCRE.*=~</span> [PCRE.reBlockInsensitive<span class="fu">|</span>[<span class="dv">0</span><span class="fu">-</span>9a<span class="fu">-</span>f]{<span class="dv">2</span>}<span class="fu">$|</span>]</a>
<a class="sourceLine" id="cb9-26" title="26">      ]</a>
<a class="sourceLine" id="cb9-27" title="27">    ]</a>
<a class="sourceLine" id="cb9-28" title="28">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb9-29" title="29">    s <span class="fu">=</span> <span class="st">&quot;0a\nbb\nFe\nA5&quot;</span><span class="ot"> ::</span> <span class="dt">String</span></a></code></pre></div>
<h3>
Exercising Our Many APIs
</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" title="1"><span class="ot">many_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb10-2" title="2">many_tests <span class="fu">=</span> testGroup <span class="st">&quot;Many Tests&quot;</span></a>
<a class="sourceLine" id="cb10-3" title="3">    [ testCase <span class="st">&quot;PCRE a&quot;</span>               <span class="fu">$</span> test_ (<span class="fu">PCRE.*=~</span>) (<span class="fu">PCRE.?=~</span>) (<span class="fu">PCRE.=~</span>) (<span class="fu">PCRE.=~~</span>) matchOnce matchMany makeSearchReplace <span class="fu">id</span>          re_pcre</a>
<a class="sourceLine" id="cb10-4" title="4">    , testCase <span class="st">&quot;PCRE ByteString&quot;</span>      <span class="fu">$</span> test_ (<span class="fu">P_BS.*=~</span>) (<span class="fu">P_BS.?=~</span>) (<span class="fu">P_BS.=~</span>) (<span class="fu">P_BS.=~~</span>) matchOnce matchMany makeSearchReplace B.pack      re_pcre</a>
<a class="sourceLine" id="cb10-5" title="5">    , testCase <span class="st">&quot;PCRE ByteString.Lazy&quot;</span> <span class="fu">$</span> test_ (<span class="fu">PLBS.*=~</span>) (<span class="fu">PLBS.?=~</span>) (<span class="fu">PLBS.=~</span>) (<span class="fu">PLBS.=~~</span>) matchOnce matchMany makeSearchReplace LBS.pack    re_pcre</a>
<a class="sourceLine" id="cb10-6" title="6">    , testCase <span class="st">&quot;PCRE Sequence&quot;</span>        <span class="fu">$</span> test_ (<span class="fu">P_SQ.*=~</span>) (<span class="fu">P_SQ.?=~</span>) (<span class="fu">P_SQ.=~</span>) (<span class="fu">P_SQ.=~~</span>) matchOnce matchMany makeSearchReplace S.fromList  re_pcre</a>
<a class="sourceLine" id="cb10-7" title="7">    , testCase <span class="st">&quot;PCRE String&quot;</span>          <span class="fu">$</span> test_ (<span class="fu">P_ST.*=~</span>) (<span class="fu">P_ST.?=~</span>) (<span class="fu">P_ST.=~</span>) (<span class="fu">P_ST.=~~</span>) matchOnce matchMany makeSearchReplace <span class="fu">id</span>          re_pcre</a>
<a class="sourceLine" id="cb10-8" title="8">    , testCase <span class="st">&quot;PCRE Text&quot;</span>            <span class="fu">$</span> test_ (<span class="fu">P_TX.*=~</span>) (<span class="fu">P_TX.?=~</span>) (<span class="fu">P_TX.=~</span>) (<span class="fu">P_TX.=~~</span>) matchOnce matchMany makeSearchReplace T.pack      re_pcre</a>
<a class="sourceLine" id="cb10-9" title="9">    , testCase <span class="st">&quot;PCRE Text.Lazy&quot;</span>       <span class="fu">$</span> test_ (<span class="fu">PLTX.*=~</span>) (<span class="fu">PLTX.?=~</span>) (<span class="fu">PLTX.=~</span>) (<span class="fu">PLTX.=~~</span>) matchOnce matchMany makeSearchReplace <span class="dt">LT</span><span class="fu">.pack</span>     re_pcre</a>
<a class="sourceLine" id="cb10-10" title="10">    , testCase <span class="st">&quot;TDFA a&quot;</span>               <span class="fu">$</span> test_ (<span class="fu">TDFA.*=~</span>) (<span class="fu">TDFA.?=~</span>) (<span class="fu">TDFA.=~</span>) (<span class="fu">TDFA.=~~</span>) matchOnce matchMany makeSearchReplace <span class="fu">id</span>          re_tdfa</a>
<a class="sourceLine" id="cb10-11" title="11">    , testCase <span class="st">&quot;TDFA ByteString&quot;</span>      <span class="fu">$</span> test_ (<span class="fu">T_BS.*=~</span>) (<span class="fu">T_BS.?=~</span>) (<span class="fu">T_BS.=~</span>) (<span class="fu">T_BS.=~~</span>) matchOnce matchMany makeSearchReplace B.pack      re_tdfa</a>
<a class="sourceLine" id="cb10-12" title="12">    , testCase <span class="st">&quot;TDFA ByteString.Lazy&quot;</span> <span class="fu">$</span> test_ (<span class="fu">TLBS.*=~</span>) (<span class="fu">TLBS.?=~</span>) (<span class="fu">TLBS.=~</span>) (<span class="fu">TLBS.=~~</span>) matchOnce matchMany makeSearchReplace LBS.pack    re_tdfa</a>
<a class="sourceLine" id="cb10-13" title="13">    , testCase <span class="st">&quot;TDFA Sequence&quot;</span>        <span class="fu">$</span> test_ (<span class="fu">T_SQ.*=~</span>) (<span class="fu">T_SQ.?=~</span>) (<span class="fu">T_SQ.=~</span>) (<span class="fu">T_SQ.=~~</span>) matchOnce matchMany makeSearchReplace S.fromList  re_tdfa</a>
<a class="sourceLine" id="cb10-14" title="14">    , testCase <span class="st">&quot;TDFA String&quot;</span>          <span class="fu">$</span> test_ (<span class="fu">T_ST.*=~</span>) (<span class="fu">T_ST.?=~</span>) (<span class="fu">T_ST.=~</span>) (<span class="fu">T_ST.=~~</span>) matchOnce matchMany makeSearchReplace <span class="fu">id</span>          re_tdfa</a>
<a class="sourceLine" id="cb10-15" title="15">    , testCase <span class="st">&quot;TDFA Text&quot;</span>            <span class="fu">$</span> test_ (<span class="fu">T_TX.*=~</span>) (<span class="fu">T_TX.?=~</span>) (<span class="fu">T_TX.=~</span>) (<span class="fu">T_TX.=~~</span>) matchOnce matchMany makeSearchReplace T.pack      re_tdfa</a>
<a class="sourceLine" id="cb10-16" title="16">    , testCase <span class="st">&quot;TDFA Text.Lazy&quot;</span>       <span class="fu">$</span> test_ (<span class="fu">TLTX.*=~</span>) (<span class="fu">TLTX.?=~</span>) (<span class="fu">TLTX.=~</span>) (<span class="fu">TLTX.=~~</span>) matchOnce matchMany makeSearchReplace <span class="dt">LT</span><span class="fu">.pack</span>     re_tdfa</a>
<a class="sourceLine" id="cb10-17" title="17">    ]</a>
<a class="sourceLine" id="cb10-18" title="18">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="ot">    test_ ::</span> (<span class="dt">IsRegex</span> r s,<span class="dt">Show</span> s,<span class="dt">Eq</span> s)</a>
<a class="sourceLine" id="cb10-20" title="20">          <span class="ot">=&gt;</span> (s<span class="ot">-&gt;</span>r<span class="ot">-&gt;</span><span class="dt">Matches</span> s)</a>
<a class="sourceLine" id="cb10-21" title="21">          <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span>r<span class="ot">-&gt;</span><span class="dt">Match</span>   s)</a>
<a class="sourceLine" id="cb10-22" title="22">          <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span>r<span class="ot">-&gt;</span><span class="dt">Matches</span> s)</a>
<a class="sourceLine" id="cb10-23" title="23">          <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span>r<span class="ot">-&gt;</span><span class="dt">Maybe</span>(<span class="dt">Match</span> s))</a>
<a class="sourceLine" id="cb10-24" title="24">          <span class="ot">-&gt;</span> (r<span class="ot">-&gt;</span>s<span class="ot">-&gt;</span><span class="dt">Match</span>   s)</a>
<a class="sourceLine" id="cb10-25" title="25">          <span class="ot">-&gt;</span> (r<span class="ot">-&gt;</span>s<span class="ot">-&gt;</span><span class="dt">Matches</span> s)</a>
<a class="sourceLine" id="cb10-26" title="26">          <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span>s<span class="ot">-&gt;</span><span class="dt">Either</span> <span class="dt">String</span> (<span class="dt">SearchReplace</span> r s))</a>
<a class="sourceLine" id="cb10-27" title="27">          <span class="ot">-&gt;</span> (<span class="dt">String</span><span class="ot">-&gt;</span>s)</a>
<a class="sourceLine" id="cb10-28" title="28">          <span class="ot">-&gt;</span> r</a>
<a class="sourceLine" id="cb10-29" title="29">          <span class="ot">-&gt;</span> <span class="dt">Assertion</span></a>
<a class="sourceLine" id="cb10-30" title="30">    test_ (<span class="fu">%*=~</span>) (<span class="fu">%?=~</span>) (<span class="fu">%=~</span>) (<span class="fu">%=~~</span>) mo mm mk_sr0 inj r <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb10-31" title="31">        <span class="dv">2</span>         <span class="fu">@=?</span> countMatches mtchs</a>
<a class="sourceLine" id="cb10-32" title="32">        <span class="dt">Just</span> txt&#39; <span class="fu">@=?</span> matchedText  mtch</a>
<a class="sourceLine" id="cb10-33" title="33">        mtchs     <span class="fu">@=?</span> mtchs&#39;</a>
<a class="sourceLine" id="cb10-34" title="34">        mb_mtch   <span class="fu">@=?</span> <span class="dt">Just</span> mtch</a>
<a class="sourceLine" id="cb10-35" title="35">        mtch      <span class="fu">@=?</span> mtch&#39;&#39;</a>
<a class="sourceLine" id="cb10-36" title="36">        mtchs     <span class="fu">@=?</span> mtchs&#39;&#39;</a>
<a class="sourceLine" id="cb10-37" title="37">        txt&#39;&#39;     <span class="fu">@=?</span> searchReplaceAll (mk_sr re_t tpl) txt</a>
<a class="sourceLine" id="cb10-38" title="38">      <span class="kw">where</span></a>
<a class="sourceLine" id="cb10-39" title="39">        mtchs   <span class="fu">=</span> txt <span class="fu">%*=~</span> r</a>
<a class="sourceLine" id="cb10-40" title="40">        mtch    <span class="fu">=</span> txt <span class="fu">%?=~</span> r</a>
<a class="sourceLine" id="cb10-41" title="41">        mtchs&#39;  <span class="fu">=</span> txt <span class="fu">%=~</span>  r</a>
<a class="sourceLine" id="cb10-42" title="42">        mb_mtch <span class="fu">=</span> txt <span class="fu">%=~~</span> r</a>
<a class="sourceLine" id="cb10-43" title="43">        mtch&#39;&#39;  <span class="fu">=</span> mo r txt</a>
<a class="sourceLine" id="cb10-44" title="44">        mtchs&#39;&#39; <span class="fu">=</span> mm r txt</a>
<a class="sourceLine" id="cb10-45" title="45"></a>
<a class="sourceLine" id="cb10-46" title="46">        re_t    <span class="fu">=</span> inj re_s</a>
<a class="sourceLine" id="cb10-47" title="47">        tpl     <span class="fu">=</span> inj <span class="st">&quot;${d}/${m}/${y}&quot;</span></a>
<a class="sourceLine" id="cb10-48" title="48"></a>
<a class="sourceLine" id="cb10-49" title="49">        txt     <span class="fu">=</span> inj <span class="st">&quot;2016-01-09 2015-12-5 2015-10-05&quot;</span></a>
<a class="sourceLine" id="cb10-50" title="50">        txt&#39;    <span class="fu">=</span> inj <span class="st">&quot;2016-01-09&quot;</span></a>
<a class="sourceLine" id="cb10-51" title="51">        txt&#39;&#39;   <span class="fu">=</span> inj <span class="st">&quot;09/01/2016 2015-12-5 05/10/2015&quot;</span></a>
<a class="sourceLine" id="cb10-52" title="52"></a>
<a class="sourceLine" id="cb10-53" title="53">        mk_sr   <span class="fu">=</span> \r_ t_ <span class="ot">-&gt;</span> <span class="fu">either</span> <span class="fu">error</span> <span class="fu">id</span> <span class="fu">$</span> mk_sr0 r_ t_</a>
<a class="sourceLine" id="cb10-54" title="54"></a>
<a class="sourceLine" id="cb10-55" title="55"></a>
<a class="sourceLine" id="cb10-56" title="56">    re_pcre <span class="fu">=</span> fromMaybe oops <span class="fu">$</span> PCRE.compileRegex <span class="st">&quot;[0-9]{4}-[0-9]{2}-[0-9]{2}&quot;</span></a>
<a class="sourceLine" id="cb10-57" title="57">    re_tdfa <span class="fu">=</span> fromMaybe oops <span class="fu">$</span> TDFA.compileRegex <span class="st">&quot;[0-9]{4}-[0-9]{2}-[0-9]{2}&quot;</span></a>
<a class="sourceLine" id="cb10-58" title="58"></a>
<a class="sourceLine" id="cb10-59" title="59">    re_s    <span class="fu">=</span> <span class="st">&quot;${y}([0-9]{4})-${m}([0-9]{2})-${d}([0-9]{2})&quot;</span></a>
<a class="sourceLine" id="cb10-60" title="60"></a>
<a class="sourceLine" id="cb10-61" title="61">    oops    <span class="fu">=</span> <span class="fu">error</span> <span class="st">&quot;many_tests&quot;</span></a></code></pre></div>
<h2 id="testing-the-re-escape-functions">Testing the RE Escape Functions</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" title="1"><span class="ot">escape_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb11-2" title="2">escape_tests <span class="fu">=</span> testGroup <span class="st">&quot;Escape Tests&quot;</span></a>
<a class="sourceLine" id="cb11-3" title="3">    [ testGroup <span class="st">&quot;PCRE&quot;</span></a>
<a class="sourceLine" id="cb11-4" title="4">        [ testCase  <span class="st">&quot;Escaping empty string&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-5" title="5">            assertBool <span class="st">&quot;empty string&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-6" title="6">              tst P_ST.escape (<span class="fu">P_ST.?=~</span>) <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb11-7" title="7">        , testCase  <span class="st">&quot;Escaping RE metacharacters&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-8" title="8">            assertBool <span class="st">&quot;metacharacters&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-9" title="9">              tst P_ST.escape (<span class="fu">P_ST.?=~</span>) metacharacters</a>
<a class="sourceLine" id="cb11-10" title="10">        , localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">6</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-11" title="11">            SC.testProperty <span class="st">&quot;matched $ &lt;s&gt; ?=~ [re|^escape(&lt;s&gt;)$|]&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-12" title="12">              tst P_ST.escape (<span class="fu">P_ST.?=~</span>)</a>
<a class="sourceLine" id="cb11-13" title="13">        ]</a>
<a class="sourceLine" id="cb11-14" title="14">    , testGroup <span class="st">&quot;TDFA&quot;</span></a>
<a class="sourceLine" id="cb11-15" title="15">        [ testCase  <span class="st">&quot;Escaping empty string&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-16" title="16">            assertBool <span class="st">&quot;empty string&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-17" title="17">              tst T_ST.escape (<span class="fu">T_ST.?=~</span>) <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb11-18" title="18">        , testCase  <span class="st">&quot;Escaping RE metacharacters&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-19" title="19">            assertBool <span class="st">&quot;metacharacters&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-20" title="20">              tst T_ST.escape (<span class="fu">T_ST.?=~</span>) metacharacters</a>
<a class="sourceLine" id="cb11-21" title="21">        , localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">6</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-22" title="22">            SC.testProperty <span class="st">&quot;matched $ &lt;s&gt; ?=~ [re|^escape(&lt;s&gt;)$|]&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-23" title="23">              tst T_ST.escape (<span class="fu">T_ST.?=~</span>)</a>
<a class="sourceLine" id="cb11-24" title="24">        ]</a>
<a class="sourceLine" id="cb11-25" title="25">    ]</a>
<a class="sourceLine" id="cb11-26" title="26">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb11-27" title="27"><span class="ot">    tst ::</span> ((<span class="dt">String</span><span class="ot">-&gt;</span><span class="dt">String</span>)<span class="ot">-&gt;</span><span class="dt">String</span><span class="ot">-&gt;</span><span class="dt">Either</span> <span class="dt">String</span> a)</a>
<a class="sourceLine" id="cb11-28" title="28">        <span class="ot">-&gt;</span> (<span class="dt">String</span><span class="ot">-&gt;</span>a<span class="ot">-&gt;</span><span class="dt">Match</span> <span class="dt">String</span>)</a>
<a class="sourceLine" id="cb11-29" title="29">        <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb11-30" title="30">        <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb11-31" title="31">    tst esc0 (<span class="fu">%=~</span>) s <span class="fu">=</span> matched <span class="fu">$</span> s <span class="fu">%=~</span> esc s</a>
<a class="sourceLine" id="cb11-32" title="32">      <span class="kw">where</span></a>
<a class="sourceLine" id="cb11-33" title="33">        esc <span class="fu">=</span> un_either <span class="fu">.</span> esc0 ((<span class="st">&quot;^&quot;</span> <span class="fu">++</span>) <span class="fu">.</span> (<span class="fu">++</span> <span class="st">&quot;$&quot;</span>))</a>
<a class="sourceLine" id="cb11-34" title="34"></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="ot">    metacharacters ::</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb11-36" title="36">    metacharacters <span class="fu">=</span> <span class="st">&quot;^\\.|*+?()[]{}$&quot;</span></a></code></pre></div>
<h2 id="named-capture-tests">Named Capture Tests</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" title="1"><span class="ot">named_capture_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb12-2" title="2">named_capture_tests <span class="fu">=</span> localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">4</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb12-3" title="3">  testGroup <span class="st">&quot;NamedCaptures&quot;</span></a>
<a class="sourceLine" id="cb12-4" title="4">    [ format_scan_tests</a>
<a class="sourceLine" id="cb12-5" title="5">    , analyse_tokens_tests</a>
<a class="sourceLine" id="cb12-6" title="6">    ]</a>
<a class="sourceLine" id="cb12-7" title="7"></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="kw">instance</span> <span class="dt">Monad</span> m <span class="ot">=&gt;</span> <span class="dt">Serial</span> m <span class="dt">Token</span></a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="ot">format_scan_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb12-11" title="11">format_scan_tests <span class="fu">=</span></a>
<a class="sourceLine" id="cb12-12" title="12">  testGroup <span class="st">&quot;FormatToken/Scan Properties&quot;</span></a>
<a class="sourceLine" id="cb12-13" title="13">    [ localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">4</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb12-14" title="14">        SC.testProperty <span class="st">&quot;formatTokens == formatTokens0&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb12-15" title="15">          \tks <span class="ot">-&gt;</span> formatTokens tks <span class="fu">==</span> formatTokens0 tks</a>
<a class="sourceLine" id="cb12-16" title="16">    , localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">4</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb12-17" title="17">        SC.testProperty <span class="st">&quot;scan . formatTokens&#39; idFormatTokenREOptions == id&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb12-18" title="18">          \tks <span class="ot">-&gt;</span> <span class="fu">all</span> validToken tks <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb12-19" title="19">                    scan (formatTokens&#39; idFormatTokenREOptions tks) <span class="fu">==</span> tks</a>
<a class="sourceLine" id="cb12-20" title="20">    ]</a>
<a class="sourceLine" id="cb12-21" title="21"></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="ot">analyse_tokens_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb12-23" title="23">analyse_tokens_tests <span class="fu">=</span></a>
<a class="sourceLine" id="cb12-24" title="24">  testGroup <span class="st">&quot;Analysing [Token] Unit Tests&quot;</span></a>
<a class="sourceLine" id="cb12-25" title="25">    [ tc [here|foobar|]                                       []</a>
<a class="sourceLine" id="cb12-26" title="26">    , tc [here||]                                             []</a>
<a class="sourceLine" id="cb12-27" title="27">    , tc [here|$([0-9]{4})|]                                  []</a>
<a class="sourceLine" id="cb12-28" title="28">    , tc [here|${x}()|]                                       [(<span class="dv">1</span>,<span class="st">&quot;x&quot;</span>)]</a>
<a class="sourceLine" id="cb12-29" title="29">    , tc [here|${}()|]                                        []</a>
<a class="sourceLine" id="cb12-30" title="30">    , tc [here|${}()${foo}()|]                                [(<span class="dv">2</span>,<span class="st">&quot;foo&quot;</span>)]</a>
<a class="sourceLine" id="cb12-31" title="31">    , tc [here|${x}(${y()})|]                                 [(<span class="dv">1</span>,<span class="st">&quot;x&quot;</span>)]</a>
<a class="sourceLine" id="cb12-32" title="32">    , tc [here|${x}(${y}())|]                                 [(<span class="dv">1</span>,<span class="st">&quot;x&quot;</span>),(<span class="dv">2</span>,<span class="st">&quot;y&quot;</span>)]</a>
<a class="sourceLine" id="cb12-33" title="33">    , tc [here|${a}(${b{}())|]                                [(<span class="dv">1</span>,<span class="st">&quot;a&quot;</span>)]</a>
<a class="sourceLine" id="cb12-34" title="34">    , tc [here|${y}([0-9]{4})-${m}([0-9]{2})-${d}([0-9]{2})|] [(<span class="dv">1</span>,<span class="st">&quot;y&quot;</span>),(<span class="dv">2</span>,<span class="st">&quot;m&quot;</span>),(<span class="dv">3</span>,<span class="st">&quot;d&quot;</span>)]</a>
<a class="sourceLine" id="cb12-35" title="35">    , tc [here|@$(@|\{${name}([^{}]+)\})|]                    [(<span class="dv">2</span>,<span class="st">&quot;name&quot;</span>)]</a>
<a class="sourceLine" id="cb12-36" title="36">    , tc [here|${y}[0-9]{4}|]                                 []</a>
<a class="sourceLine" id="cb12-37" title="37">    , tc [here|${}([0-9]{4})|]                                []</a>
<a class="sourceLine" id="cb12-38" title="38">    ]</a>
<a class="sourceLine" id="cb12-39" title="39">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb12-40" title="40">    tc s al <span class="fu">=</span></a>
<a class="sourceLine" id="cb12-41" title="41">      testCase s <span class="fu">$</span> assertEqual <span class="st">&quot;CaptureNames&quot;</span></a>
<a class="sourceLine" id="cb12-42" title="42">        (xnc s)</a>
<a class="sourceLine" id="cb12-43" title="43">        (HM.fromList</a>
<a class="sourceLine" id="cb12-44" title="44">          [ (<span class="dt">CaptureName</span> <span class="fu">$</span> T.pack n,<span class="dt">CaptureOrdinal</span> i)</a>
<a class="sourceLine" id="cb12-45" title="45">              <span class="fu">|</span> (i,n)<span class="ot">&lt;-</span>al</a>
<a class="sourceLine" id="cb12-46" title="46">              ]</a>
<a class="sourceLine" id="cb12-47" title="47">        )</a>
<a class="sourceLine" id="cb12-48" title="48"></a>
<a class="sourceLine" id="cb12-49" title="49">    xnc <span class="fu">=</span> <span class="fu">either</span> oops (<span class="fu">snd</span> <span class="fu">.</span> <span class="fu">fst</span>) <span class="fu">.</span> extractNamedCaptures</a>
<a class="sourceLine" id="cb12-50" title="50">      <span class="kw">where</span></a>
<a class="sourceLine" id="cb12-51" title="51">        oops <span class="fu">=</span> <span class="fu">error</span> <span class="st">&quot;analyse_tokens_tests: unexpected parse failure&quot;</span></a></code></pre></div>
<h2 id="addcapturenames-tests">AddCaptureNames Tests</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" title="1"><span class="ot">add_capture_names_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb13-2" title="2">add_capture_names_tests <span class="fu">=</span> testGroup <span class="st">&quot;AddCaptureNames Tests&quot;</span></a>
<a class="sourceLine" id="cb13-3" title="3">    [ test_add_capture_name <span class="st">&quot;Match   String&quot;</span>          test_match                    regex_str_match</a>
<a class="sourceLine" id="cb13-4" title="4">    , test_add_capture_name <span class="st">&quot;Matches String&quot;</span>          test_matches                  regex_str_matches</a>
<a class="sourceLine" id="cb13-5" title="5">    , test_add_capture_name <span class="st">&quot;Match   B.ByteString&quot;</span>    test_match   <span class="fu">$</span> B.pack     <span class="fu">&lt;$&gt;</span> regex_str_match</a>
<a class="sourceLine" id="cb13-6" title="6">    , test_add_capture_name <span class="st">&quot;Matches B.ByteString&quot;</span>    test_matches <span class="fu">$</span> B.pack     <span class="fu">&lt;$&gt;</span> regex_str_matches</a>
<a class="sourceLine" id="cb13-7" title="7">    , test_add_capture_name <span class="st">&quot;Match   LBS.ByteString&quot;</span>  test_match   <span class="fu">$</span> LBS.pack   <span class="fu">&lt;$&gt;</span> regex_str_match</a>
<a class="sourceLine" id="cb13-8" title="8">    , test_add_capture_name <span class="st">&quot;Matches LBS.ByteString&quot;</span>  test_matches <span class="fu">$</span> LBS.pack   <span class="fu">&lt;$&gt;</span> regex_str_matches</a>
<a class="sourceLine" id="cb13-9" title="9">    , test_add_capture_name <span class="st">&quot;Match   T.Text&quot;</span>          test_match   <span class="fu">$</span> T.pack     <span class="fu">&lt;$&gt;</span> regex_str_match</a>
<a class="sourceLine" id="cb13-10" title="10">    , test_add_capture_name <span class="st">&quot;Matches T.Text&quot;</span>          test_matches <span class="fu">$</span> T.pack     <span class="fu">&lt;$&gt;</span> regex_str_matches</a>
<a class="sourceLine" id="cb13-11" title="11">    , test_add_capture_name <span class="st">&quot;Match   LT.Text&quot;</span>         test_match   <span class="fu">$</span> <span class="dt">LT</span><span class="fu">.pack</span>    <span class="fu">&lt;$&gt;</span> regex_str_match</a>
<a class="sourceLine" id="cb13-12" title="12">    , test_add_capture_name <span class="st">&quot;Matches LT.Text&quot;</span>         test_matches <span class="fu">$</span> <span class="dt">LT</span><span class="fu">.pack</span>    <span class="fu">&lt;$&gt;</span> regex_str_matches</a>
<a class="sourceLine" id="cb13-13" title="13">    , test_add_capture_name <span class="st">&quot;Match   (Seq Char)&quot;</span>      test_match   <span class="fu">$</span> S.fromList <span class="fu">&lt;$&gt;</span> regex_str_match</a>
<a class="sourceLine" id="cb13-14" title="14">    , test_add_capture_name <span class="st">&quot;Matches (Seq Char)&quot;</span>      test_matches <span class="fu">$</span> S.fromList <span class="fu">&lt;$&gt;</span> regex_str_matches</a>
<a class="sourceLine" id="cb13-15" title="15">    ]</a>
<a class="sourceLine" id="cb13-16" title="16"></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="ot">test_matches ::</span> <span class="dt">CaptureNames</span> <span class="ot">-&gt;</span> <span class="dt">Matches</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb13-18" title="18">test_matches cnms <span class="fu">=</span> <span class="fu">all</span> (test_match cnms) <span class="fu">.</span> allMatches</a>
<a class="sourceLine" id="cb13-19" title="19"></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="ot">test_match ::</span> <span class="dt">CaptureNames</span> <span class="ot">-&gt;</span> <span class="dt">Match</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb13-21" title="21">test_match cnms mtch <span class="fu">=</span> captureNames mtch <span class="fu">==</span> cnms</a>
<a class="sourceLine" id="cb13-22" title="22"></a>
<a class="sourceLine" id="cb13-23" title="23"><span class="ot">test_add_capture_name ::</span> <span class="dt">Typeable</span> a</a>
<a class="sourceLine" id="cb13-24" title="24">                      <span class="ot">=&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb13-25" title="25">                      <span class="ot">-&gt;</span> (<span class="dt">CaptureNames</span><span class="ot">-&gt;</span>a<span class="ot">-&gt;</span><span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb13-26" title="26">                      <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb13-27" title="27">                      <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb13-28" title="28">test_add_capture_name lab tst x <span class="fu">=</span> testCase lab <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-29" title="29">    assertBool lab <span class="fu">$</span> tst cnms <span class="fu">$</span> addCaptureNames cnms x</a>
<a class="sourceLine" id="cb13-30" title="30">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb13-31" title="31">    cnms <span class="fu">=</span> HM.fromList</a>
<a class="sourceLine" id="cb13-32" title="32">      [ (<span class="dt">CaptureName</span> <span class="st">&quot;x&quot;</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-33" title="33">      , (<span class="dt">CaptureName</span> <span class="st">&quot;y&quot;</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-34" title="34">      ]</a></code></pre></div>
<h2 id="the-find-tests">The Find Tests</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" title="1"><span class="ot">find_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb14-2" title="2">find_tests <span class="fu">=</span> testGroup <span class="st">&quot;Find Tests&quot;</span></a>
<a class="sourceLine" id="cb14-3" title="3">    [ testCase <span class="st">&quot;examples/&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-4" title="4">        fps <span class="ot">&lt;-</span> findMatches_ findMethods [re|^re-.*\.lhs|] <span class="st">&quot;examples/&quot;</span></a>
<a class="sourceLine" id="cb14-5" title="5">        example_paths <span class="fu">@=?</span> <span class="fu">filter</span> (<span class="fu">not</span> <span class="fu">.</span> matched <span class="fu">.</span> (<span class="fu">?=~</span> [re|master\.lhs|])) fps</a>
<a class="sourceLine" id="cb14-6" title="6">    ]</a>
<a class="sourceLine" id="cb14-7" title="7"></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="ot">example_paths ::</span> [<span class="dt">String</span>]</a>
<a class="sourceLine" id="cb14-9" title="9">example_paths <span class="fu">=</span></a>
<a class="sourceLine" id="cb14-10" title="10">  [ <span class="st">&quot;examples/re-gen-cabals.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-11" title="11">  , <span class="st">&quot;examples/re-gen-modules.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-12" title="12">  , <span class="st">&quot;examples/re-include.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-13" title="13">  , <span class="st">&quot;examples/re-nginx-log-processor.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-14" title="14">  , <span class="st">&quot;examples/re-prep.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-15" title="15">  , <span class="st">&quot;examples/re-sort-imports.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-16" title="16">  , <span class="st">&quot;examples/re-tests.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-17" title="17">  , <span class="st">&quot;examples/re-top.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-18" title="18">  , <span class="st">&quot;examples/re-tutorial-options.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-19" title="19">  , <span class="st">&quot;examples/re-tutorial-replacing.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-20" title="20">  , <span class="st">&quot;examples/re-tutorial-testbench.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-21" title="21">  , <span class="st">&quot;examples/re-tutorial-tools.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-22" title="22">  , <span class="st">&quot;examples/re-tutorial.lhs&quot;</span></a>
<a class="sourceLine" id="cb14-23" title="23">  ]</a>
<a class="sourceLine" id="cb14-24" title="24"></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="ot">findMethods ::</span> <span class="dt">FindMethods</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb14-26" title="26">findMethods <span class="fu">=</span></a>
<a class="sourceLine" id="cb14-27" title="27">  <span class="dt">FindMethods</span></a>
<a class="sourceLine" id="cb14-28" title="28">    { doesDirectoryExistDM <span class="fu">=</span> doesDirectoryExist</a>
<a class="sourceLine" id="cb14-29" title="29">    , listDirectoryDM      <span class="fu">=</span> getDirectoryContents</a>
<a class="sourceLine" id="cb14-30" title="30">    , combineDM            <span class="fu">=</span> (<span class="fu">&lt;/&gt;</span>)</a>
<a class="sourceLine" id="cb14-31" title="31">    }</a></code></pre></div>
<h2 id="the-backslash-tests">The Backslash Tests</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" title="1"><span class="ot">backslash_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb15-2" title="2">backslash_tests <span class="fu">=</span> testGroup <span class="st">&quot;Backslash Tests&quot;</span></a>
<a class="sourceLine" id="cb15-3" title="3">  [ testGroup <span class="st">&quot;PCRE&quot;</span></a>
<a class="sourceLine" id="cb15-4" title="4">      [ testCase <span class="st">&quot;backslash-a&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\ay&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\ay&quot;</span> <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\a]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-5" title="5">      , testCase <span class="st">&quot;backslash-b&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\by&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\by&quot;</span> <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\b]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-6" title="6">      , testCase <span class="st">&quot;backslash-f&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\fy&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\fy&quot;</span> <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\f]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-7" title="7">      , testCase <span class="st">&quot;backslash-n&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\ny&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\ny&quot;</span> <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\n]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-8" title="8">      , testCase <span class="st">&quot;backslash-r&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\ry&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\ry&quot;</span> <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\r]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-9" title="9">      , testCase <span class="st">&quot;backslash-t&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\ty&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\ty&quot;</span> <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\t]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-10" title="10">      , testCase <span class="st">&quot;backslash-v&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\vy&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\vy&quot;</span> <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\v]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-11" title="11">      , testCase <span class="st">&quot;backslash-$&quot;</span>         <span class="fu">$</span> <span class="st">&quot;$y&quot;</span>  <span class="fu">@=?</span> <span class="st">&quot;--foo$y&quot;</span>  <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\<span class="fu">$</span>]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-12" title="12">      , testCase <span class="st">&quot;backslash-backslash&quot;</span> <span class="fu">$</span> <span class="st">&quot;\\y&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\\y&quot;</span> <span class="fu">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\\]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-13" title="13">      ]</a>
<a class="sourceLine" id="cb15-14" title="14">  , testGroup <span class="st">&quot;TDFA&quot;</span></a>
<a class="sourceLine" id="cb15-15" title="15">      [ testCase <span class="st">&quot;backslash-a&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\ay&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\ay&quot;</span> <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\a]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-16" title="16">      , testCase <span class="st">&quot;backslash-b&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\by&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\by&quot;</span> <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\b]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-17" title="17">      , testCase <span class="st">&quot;backslash-f&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\fy&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\fy&quot;</span> <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\f]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-18" title="18">      , testCase <span class="st">&quot;backslash-n&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\ny&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\ny&quot;</span> <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\n]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-19" title="19">      , testCase <span class="st">&quot;backslash-r&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\ry&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\ry&quot;</span> <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\r]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-20" title="20">      , testCase <span class="st">&quot;backslash-t&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\ty&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\ty&quot;</span> <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\t]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-21" title="21">      , testCase <span class="st">&quot;backslash-v&quot;</span>         <span class="fu">$</span> <span class="st">&quot;\vy&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\vy&quot;</span> <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\v]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-22" title="22">      , testCase <span class="st">&quot;backslash-$&quot;</span>         <span class="fu">$</span> <span class="st">&quot;$y&quot;</span>  <span class="fu">@=?</span> <span class="st">&quot;--foo$y&quot;</span>  <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\<span class="fu">$</span>]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-23" title="23">      , testCase <span class="st">&quot;backslash-backslash&quot;</span> <span class="fu">$</span> <span class="st">&quot;\\y&quot;</span> <span class="fu">@=?</span> <span class="st">&quot;--foo\\y&quot;</span> <span class="fu">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="fu">|--</span>[<span class="fu">^</span>\\]<span class="fu">*///|</span>]</a>
<a class="sourceLine" id="cb15-24" title="24">      ]</a>
<a class="sourceLine" id="cb15-25" title="25">  ]</a></code></pre></div>
<h2 id="the-miscelaneous-tests">The Miscelaneous Tests</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" title="1"><span class="ot">misc_tests ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb16-2" title="2">misc_tests <span class="fu">=</span> testGroup <span class="st">&quot;Miscelaneous Tests&quot;</span></a>
<a class="sourceLine" id="cb16-3" title="3">    [ testGroup <span class="st">&quot;CaptureID&quot;</span></a>
<a class="sourceLine" id="cb16-4" title="4">        [ testCase <span class="st">&quot;CaptureID lookup failure&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb16-5" title="5">            ok <span class="ot">&lt;-</span> isValidError <span class="fu">$</span> unsafe_find_capture_id [cp|foo|] <span class="fu">$</span> reCaptureNames [re|foo|]</a>
<a class="sourceLine" id="cb16-6" title="6">            assertBool <span class="st">&quot;failed&quot;</span> ok</a>
<a class="sourceLine" id="cb16-7" title="7">        ]</a>
<a class="sourceLine" id="cb16-8" title="8">    , testGroup <span class="st">&quot;QQ&quot;</span></a>
<a class="sourceLine" id="cb16-9" title="9">        [ qq_tc <span class="st">&quot;re&quot;</span>                      re</a>
<a class="sourceLine" id="cb16-10" title="10">        , qq_tc <span class="st">&quot;reMS&quot;</span>                    reMS</a>
<a class="sourceLine" id="cb16-11" title="11">        , qq_tc <span class="st">&quot;reMI&quot;</span>                    reMI</a>
<a class="sourceLine" id="cb16-12" title="12">        , qq_tc <span class="st">&quot;reBS&quot;</span>                    reBS</a>
<a class="sourceLine" id="cb16-13" title="13">        , qq_tc <span class="st">&quot;reBI&quot;</span>                    reBI</a>
<a class="sourceLine" id="cb16-14" title="14">        , qq_tc <span class="st">&quot;reMultilineSensitive&quot;</span>    reMultilineSensitive</a>
<a class="sourceLine" id="cb16-15" title="15">        , qq_tc <span class="st">&quot;reMultilineInsensitive&quot;</span>  reMultilineInsensitive</a>
<a class="sourceLine" id="cb16-16" title="16">        , qq_tc <span class="st">&quot;reBlockSensitive&quot;</span>        reBlockSensitive</a>
<a class="sourceLine" id="cb16-17" title="17">        , qq_tc <span class="st">&quot;reBlockInsensitive&quot;</span>      reBlockInsensitive</a>
<a class="sourceLine" id="cb16-18" title="18">        , qq_tc <span class="st">&quot;re_&quot;</span>                     re_</a>
<a class="sourceLine" id="cb16-19" title="19">        , qq_tc <span class="st">&quot;ed&quot;</span>                      ed</a>
<a class="sourceLine" id="cb16-20" title="20">        , qq_tc <span class="st">&quot;edMS&quot;</span>                    edMS</a>
<a class="sourceLine" id="cb16-21" title="21">        , qq_tc <span class="st">&quot;edMI&quot;</span>                    edMI</a>
<a class="sourceLine" id="cb16-22" title="22">        , qq_tc <span class="st">&quot;edBS&quot;</span>                    edBS</a>
<a class="sourceLine" id="cb16-23" title="23">        , qq_tc <span class="st">&quot;edBI&quot;</span>                    edBI</a>
<a class="sourceLine" id="cb16-24" title="24">        , qq_tc <span class="st">&quot;edMultilineSensitive&quot;</span>    edMultilineSensitive</a>
<a class="sourceLine" id="cb16-25" title="25">        , qq_tc <span class="st">&quot;edMultilineInsensitive&quot;</span>  edMultilineInsensitive</a>
<a class="sourceLine" id="cb16-26" title="26">        , qq_tc <span class="st">&quot;edBlockSensitive&quot;</span>        edBlockSensitive</a>
<a class="sourceLine" id="cb16-27" title="27">        , qq_tc <span class="st">&quot;edBlockInsensitive&quot;</span>      edBlockInsensitive</a>
<a class="sourceLine" id="cb16-28" title="28">        , qq_tc <span class="st">&quot;ed_&quot;</span>                     ed_</a>
<a class="sourceLine" id="cb16-29" title="29">        ]</a>
<a class="sourceLine" id="cb16-30" title="30">    , testGroup <span class="st">&quot;PreludeMacros&quot;</span></a>
<a class="sourceLine" id="cb16-31" title="31">        [ valid_string <span class="st">&quot;preludeMacroTable&quot;</span>    preludeMacroTable</a>
<a class="sourceLine" id="cb16-32" title="32">        , valid_macro  <span class="st">&quot;preludeMacroSummary&quot;</span>  preludeMacroSummary</a>
<a class="sourceLine" id="cb16-33" title="33">        , valid_string <span class="st">&quot;preludeMacroSources&quot;</span>  preludeMacroSources</a>
<a class="sourceLine" id="cb16-34" title="34">        , valid_macro  <span class="st">&quot;preludeMacroSource&quot;</span>   preludeMacroSource</a>
<a class="sourceLine" id="cb16-35" title="35">        ]</a>
<a class="sourceLine" id="cb16-36" title="36">    <span class="co">-- because HPC can&#39;t measure our testing of [re|..|] forms,</span></a>
<a class="sourceLine" id="cb16-37" title="37">    <span class="co">-- we are eliminating them from our enquiries</span></a>
<a class="sourceLine" id="cb16-38" title="38">    , testGroup <span class="st">&quot;RE&quot;</span></a>
<a class="sourceLine" id="cb16-39" title="39">        [ valid_res TDFA.regexType</a>
<a class="sourceLine" id="cb16-40" title="40">            [ TDFA.re</a>
<a class="sourceLine" id="cb16-41" title="41">            , TDFA.reMS</a>
<a class="sourceLine" id="cb16-42" title="42">            , TDFA.reMI</a>
<a class="sourceLine" id="cb16-43" title="43">            , TDFA.reBS</a>
<a class="sourceLine" id="cb16-44" title="44">            , TDFA.reBI</a>
<a class="sourceLine" id="cb16-45" title="45">            , TDFA.reMultilineSensitive</a>
<a class="sourceLine" id="cb16-46" title="46">            , TDFA.reMultilineInsensitive</a>
<a class="sourceLine" id="cb16-47" title="47">            , TDFA.reBlockSensitive</a>
<a class="sourceLine" id="cb16-48" title="48">            , TDFA.reBlockInsensitive</a>
<a class="sourceLine" id="cb16-49" title="49">            , TDFA.re_</a>
<a class="sourceLine" id="cb16-50" title="50">            , TDFA.ed</a>
<a class="sourceLine" id="cb16-51" title="51">            , TDFA.edMS</a>
<a class="sourceLine" id="cb16-52" title="52">            , TDFA.edMI</a>
<a class="sourceLine" id="cb16-53" title="53">            , TDFA.edBS</a>
<a class="sourceLine" id="cb16-54" title="54">            , TDFA.edBI</a>
<a class="sourceLine" id="cb16-55" title="55">            , TDFA.edMultilineSensitive</a>
<a class="sourceLine" id="cb16-56" title="56">            , TDFA.edMultilineInsensitive</a>
<a class="sourceLine" id="cb16-57" title="57">            , TDFA.edBlockSensitive</a>
<a class="sourceLine" id="cb16-58" title="58">            , TDFA.edBlockInsensitive</a>
<a class="sourceLine" id="cb16-59" title="59">            , TDFA.ed_</a>
<a class="sourceLine" id="cb16-60" title="60">            ]</a>
<a class="sourceLine" id="cb16-61" title="61">        , testCase  <span class="st">&quot;TDFA.regexType&quot;</span>           <span class="fu">$</span> assertBool <span class="st">&quot;TDFA&quot;</span> <span class="fu">$</span> isTDFA TDFA.regexType</a>
<a class="sourceLine" id="cb16-62" title="62">        , testCase  <span class="st">&quot;TDFA.reOptions&quot;</span>           <span class="fu">$</span> assert_empty_macs <span class="fu">$</span> optionsMacs (TDFA.reOptions tdfa_re)</a>
<a class="sourceLine" id="cb16-63" title="63">        , testCase  <span class="st">&quot;TDFA.makeREOptions md&quot;</span>      <span class="fu">$</span> assert_empty_macs <span class="fu">$</span> optionsMacs tdfa_opts</a>
<a class="sourceLine" id="cb16-64" title="64">        , testCase  <span class="st">&quot;TDFA.preludeTestsFailing&quot;</span> <span class="fu">$</span> []      <span class="fu">@=?</span> TDFA.preludeTestsFailing</a>
<a class="sourceLine" id="cb16-65" title="65">        , ne_string <span class="st">&quot;TDFA.preludeTable&quot;</span>          TDFA.preludeTable</a>
<a class="sourceLine" id="cb16-66" title="66">        , ne_string <span class="st">&quot;TDFA.preludeSources&quot;</span>        TDFA.preludeSources</a>
<a class="sourceLine" id="cb16-67" title="67">        , testGroup <span class="st">&quot;TDFA.preludeSummary&quot;</span></a>
<a class="sourceLine" id="cb16-68" title="68">            [ ne_string (presentPreludeMacro pm) <span class="fu">$</span> TDFA.preludeSummary pm</a>
<a class="sourceLine" id="cb16-69" title="69">                <span class="fu">|</span> pm <span class="ot">&lt;-</span> tdfa_prelude_macros</a>
<a class="sourceLine" id="cb16-70" title="70">                ]</a>
<a class="sourceLine" id="cb16-71" title="71">        , testGroup  <span class="st">&quot;TDFA.preludeSource&quot;</span></a>
<a class="sourceLine" id="cb16-72" title="72">            [ ne_string (presentPreludeMacro pm) <span class="fu">$</span> TDFA.preludeSource  pm</a>
<a class="sourceLine" id="cb16-73" title="73">                <span class="fu">|</span> pm <span class="ot">&lt;-</span> tdfa_prelude_macros</a>
<a class="sourceLine" id="cb16-74" title="74">                ]</a>
<a class="sourceLine" id="cb16-75" title="75">    <span class="co">-- because HPC can&#39;t measure our testing of [re|..|] forms,</span></a>
<a class="sourceLine" id="cb16-76" title="76">    <span class="co">-- we are eliminating them from our enquiries</span></a>
<a class="sourceLine" id="cb16-77" title="77">        , valid_res PCRE.regexType</a>
<a class="sourceLine" id="cb16-78" title="78">            [ PCRE.re</a>
<a class="sourceLine" id="cb16-79" title="79">            , PCRE.reMS</a>
<a class="sourceLine" id="cb16-80" title="80">            , PCRE.reMI</a>
<a class="sourceLine" id="cb16-81" title="81">            , PCRE.reBS</a>
<a class="sourceLine" id="cb16-82" title="82">            , PCRE.reBI</a>
<a class="sourceLine" id="cb16-83" title="83">            , PCRE.reMultilineSensitive</a>
<a class="sourceLine" id="cb16-84" title="84">            , PCRE.reMultilineInsensitive</a>
<a class="sourceLine" id="cb16-85" title="85">            , PCRE.reBlockSensitive</a>
<a class="sourceLine" id="cb16-86" title="86">            , PCRE.reBlockInsensitive</a>
<a class="sourceLine" id="cb16-87" title="87">            , PCRE.re_</a>
<a class="sourceLine" id="cb16-88" title="88">            , PCRE.ed</a>
<a class="sourceLine" id="cb16-89" title="89">            , PCRE.edMS</a>
<a class="sourceLine" id="cb16-90" title="90">            , PCRE.edMI</a>
<a class="sourceLine" id="cb16-91" title="91">            , PCRE.edBS</a>
<a class="sourceLine" id="cb16-92" title="92">            , PCRE.edBI</a>
<a class="sourceLine" id="cb16-93" title="93">            , PCRE.edMultilineSensitive</a>
<a class="sourceLine" id="cb16-94" title="94">            , PCRE.edMultilineInsensitive</a>
<a class="sourceLine" id="cb16-95" title="95">            , PCRE.edBlockSensitive</a>
<a class="sourceLine" id="cb16-96" title="96">            , PCRE.edBlockInsensitive</a>
<a class="sourceLine" id="cb16-97" title="97">            , PCRE.ed_</a>
<a class="sourceLine" id="cb16-98" title="98">            ]</a>
<a class="sourceLine" id="cb16-99" title="99">        , testCase  <span class="st">&quot;PCRE.regexType&quot;</span>           <span class="fu">$</span> assertBool <span class="st">&quot;PCRE&quot;</span> <span class="fu">$</span> isPCRE PCRE.regexType</a>
<a class="sourceLine" id="cb16-100" title="100">        , testCase  <span class="st">&quot;PCRE.reOptions&quot;</span>           <span class="fu">$</span> assert_empty_macs <span class="fu">$</span> optionsMacs (PCRE.reOptions pcre_re)</a>
<a class="sourceLine" id="cb16-101" title="101">        , testCase  <span class="st">&quot;PCRE.makeREOptions md&quot;</span>      <span class="fu">$</span> assert_empty_macs <span class="fu">$</span> optionsMacs pcre_opts</a>
<a class="sourceLine" id="cb16-102" title="102">        , testCase  <span class="st">&quot;PCRE.preludeTestsFailing&quot;</span> <span class="fu">$</span> []      <span class="fu">@=?</span> PCRE.preludeTestsFailing</a>
<a class="sourceLine" id="cb16-103" title="103">        , ne_string <span class="st">&quot;PCRE.preludeTable&quot;</span>          PCRE.preludeTable</a>
<a class="sourceLine" id="cb16-104" title="104">        , ne_string <span class="st">&quot;PCRE.preludeTable&quot;</span>          PCRE.preludeSources</a>
<a class="sourceLine" id="cb16-105" title="105">        , testGroup <span class="st">&quot;PCRE.preludeSummary&quot;</span></a>
<a class="sourceLine" id="cb16-106" title="106">            [ ne_string (presentPreludeMacro pm) <span class="fu">$</span> PCRE.preludeSummary pm</a>
<a class="sourceLine" id="cb16-107" title="107">                <span class="fu">|</span> pm <span class="ot">&lt;-</span> pcre_prelude_macros</a>
<a class="sourceLine" id="cb16-108" title="108">                ]</a>
<a class="sourceLine" id="cb16-109" title="109">        , testGroup <span class="st">&quot;PCRE.preludeSource&quot;</span></a>
<a class="sourceLine" id="cb16-110" title="110">            [ ne_string (presentPreludeMacro pm) <span class="fu">$</span> PCRE.preludeSource  pm</a>
<a class="sourceLine" id="cb16-111" title="111">                <span class="fu">|</span> pm <span class="ot">&lt;-</span> pcre_prelude_macros</a>
<a class="sourceLine" id="cb16-112" title="112">                ]</a>
<a class="sourceLine" id="cb16-113" title="113">        ]</a>
<a class="sourceLine" id="cb16-114" title="114">    ]</a>
<a class="sourceLine" id="cb16-115" title="115">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb16-116" title="116">    tdfa_re   <span class="fu">=</span> fromMaybe oops <span class="fu">$</span> TDFA.compileRegexWithOptions tdfa_opts <span class="st">&quot;.*&quot;</span></a>
<a class="sourceLine" id="cb16-117" title="117">    pcre_re   <span class="fu">=</span> fromMaybe oops <span class="fu">$</span> PCRE.compileRegexWithOptions pcre_opts <span class="st">&quot;.*&quot;</span></a>
<a class="sourceLine" id="cb16-118" title="118"></a>
<a class="sourceLine" id="cb16-119" title="119">    tdfa_opts <span class="fu">=</span> TDFA.makeREOptions<span class="ot"> no_macs_t ::</span> <span class="dt">REOptions_</span> <span class="dt">TDFA.RE</span> <span class="dt">TDFA_.CompOption</span> <span class="dt">TDFA_.ExecOption</span></a>
<a class="sourceLine" id="cb16-120" title="120">    pcre_opts <span class="fu">=</span> PCRE.makeREOptions<span class="ot"> no_macs_p ::</span> <span class="dt">REOptions_</span> <span class="dt">PCRE.RE</span> <span class="dt">PCRE_.CompOption</span> <span class="dt">PCRE_.ExecOption</span></a>
<a class="sourceLine" id="cb16-121" title="121"></a>
<a class="sourceLine" id="cb16-122" title="122">    no_macs_t <span class="fu">=</span> HM.fromList []<span class="ot"> ::</span> <span class="dt">Macros</span> <span class="dt">TDFA.RE</span></a>
<a class="sourceLine" id="cb16-123" title="123">    no_macs_p <span class="fu">=</span> HM.fromList []<span class="ot"> ::</span> <span class="dt">Macros</span> <span class="dt">PCRE.RE</span></a>
<a class="sourceLine" id="cb16-124" title="124"></a>
<a class="sourceLine" id="cb16-125" title="125">    oops      <span class="fu">=</span> <span class="fu">error</span> <span class="st">&quot;misc_tests&quot;</span></a>
<a class="sourceLine" id="cb16-126" title="126"></a>
<a class="sourceLine" id="cb16-127" title="127">    assert_empty_macs <span class="fu">=</span> assertBool <span class="st">&quot;macros not empty&quot;</span> <span class="fu">.</span> HM.null</a>
<a class="sourceLine" id="cb16-128" title="128"></a>
<a class="sourceLine" id="cb16-129" title="129"><span class="ot">qq_tc ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">QuasiQuoter</span> <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb16-130" title="130">qq_tc lab qq <span class="fu">=</span> testCase lab <span class="fu">$</span> quoteExp qq <span class="ot">`seq`</span> assertBool <span class="st">&quot;qq_tc&quot;</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb16-131" title="131"></a>
<a class="sourceLine" id="cb16-132" title="132"><span class="ot">valid_macro ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> (<span class="dt">RegexType</span><span class="ot">-&gt;</span><span class="dt">PreludeMacro</span><span class="ot">-&gt;</span><span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb16-133" title="133">valid_macro label f <span class="fu">=</span> testGroup label</a>
<a class="sourceLine" id="cb16-134" title="134">    [ valid_string (presentPreludeMacro pm) (<span class="fu">flip</span> f pm)</a>
<a class="sourceLine" id="cb16-135" title="135">        <span class="fu">|</span> pm<span class="ot">&lt;-</span>[<span class="fu">minBound..maxBound</span>]</a>
<a class="sourceLine" id="cb16-136" title="136">        ]</a>
<a class="sourceLine" id="cb16-137" title="137"></a>
<a class="sourceLine" id="cb16-138" title="138"><span class="ot">valid_string ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> (<span class="dt">RegexType</span><span class="ot">-&gt;</span><span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb16-139" title="139">valid_string label f <span class="fu">=</span> testGroup label</a>
<a class="sourceLine" id="cb16-140" title="140">    [ ne_string (presentRegexType rty) <span class="fu">$</span> f rty</a>
<a class="sourceLine" id="cb16-141" title="141">        <span class="fu">|</span> rty<span class="ot">&lt;-</span>[TDFA.regexType] <span class="co">-- until PCRE has a binding for all macros</span></a>
<a class="sourceLine" id="cb16-142" title="142">        ]</a>
<a class="sourceLine" id="cb16-143" title="143"></a>
<a class="sourceLine" id="cb16-144" title="144"><span class="ot">ne_string ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb16-145" title="145">ne_string label s <span class="fu">=</span></a>
<a class="sourceLine" id="cb16-146" title="146">  testCase label <span class="fu">$</span> assertBool <span class="st">&quot;non-empty string&quot;</span> <span class="fu">$</span> <span class="fu">length</span> s <span class="fu">&gt;</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb16-147" title="147"></a>
<a class="sourceLine" id="cb16-148" title="148"><span class="co">-- just evaluating quasi quoters to HNF for now -- they</span></a>
<a class="sourceLine" id="cb16-149" title="149"><span class="co">-- being tested everywhere [re|...|] (etc.) calculations</span></a>
<a class="sourceLine" id="cb16-150" title="150"><span class="co">-- are bings used but HPC isn&#39;t measuring this</span></a>
<a class="sourceLine" id="cb16-151" title="151"><span class="ot">valid_res ::</span> <span class="dt">RegexType</span> <span class="ot">-&gt;</span> [<span class="dt">QuasiQuoter</span>] <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb16-152" title="152">valid_res rty <span class="fu">=</span> testCase (<span class="fu">show</span> rty) <span class="fu">.</span> <span class="fu">foldr</span> <span class="fu">seq</span> (<span class="fu">return</span> ())</a>
<a class="sourceLine" id="cb16-153" title="153"></a>
<a class="sourceLine" id="cb16-154" title="154"><span class="ot">pcre_prelude_macros ::</span> [<span class="dt">PreludeMacro</span>]</a>
<a class="sourceLine" id="cb16-155" title="155">pcre_prelude_macros <span class="fu">=</span> <span class="fu">filter</span> (<span class="fu">/=</span> <span class="dt">PM_string</span>) [<span class="fu">minBound..maxBound</span>]</a>
<a class="sourceLine" id="cb16-156" title="156"></a>
<a class="sourceLine" id="cb16-157" title="157"><span class="ot">tdfa_prelude_macros ::</span> [<span class="dt">PreludeMacro</span>]</a>
<a class="sourceLine" id="cb16-158" title="158">tdfa_prelude_macros <span class="fu">=</span> [<span class="fu">minBound..maxBound</span>]</a>
<a class="sourceLine" id="cb16-159" title="159"></a>
<a class="sourceLine" id="cb16-160" title="160"><span class="ot">s_toList ::</span> <span class="dt">S.Seq</span> <span class="dt">Char</span> <span class="ot">-&gt;</span> [<span class="dt">Char</span>]</a>
<a class="sourceLine" id="cb16-161" title="161">s_toList <span class="fu">=</span> F.toList</a>
<a class="sourceLine" id="cb16-162" title="162"></a>
<a class="sourceLine" id="cb16-163" title="163"><span class="kw">newtype</span> <span class="dt">Identity</span> a <span class="fu">=</span> <span class="dt">Identity</span> {<span class="ot"> runIdentity ::</span> a }</a>
<a class="sourceLine" id="cb16-164" title="164">  <span class="kw">deriving</span> (<span class="dt">Functor</span>)</a>
<a class="sourceLine" id="cb16-165" title="165"></a>
<a class="sourceLine" id="cb16-166" title="166"><span class="kw">instance</span> <span class="dt">Applicative</span> <span class="dt">Identity</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb16-167" title="167">  <span class="fu">pure</span> <span class="fu">=</span> <span class="dt">Identity</span></a>
<a class="sourceLine" id="cb16-168" title="168">  (<span class="fu">&lt;*&gt;</span>) (<span class="dt">Identity</span> f) (<span class="dt">Identity</span> x) <span class="fu">=</span> <span class="dt">Identity</span> <span class="fu">$</span> f x</a>
<a class="sourceLine" id="cb16-169" title="169"></a>
<a class="sourceLine" id="cb16-170" title="170"><span class="kw">instance</span> <span class="dt">Monad</span> <span class="dt">Identity</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb16-171" title="171">  <span class="fu">return</span> <span class="fu">=</span> <span class="dt">Identity</span></a>
<a class="sourceLine" id="cb16-172" title="172">  (<span class="fu">&gt;&gt;=</span>) (<span class="dt">Identity</span> x) f <span class="fu">=</span> f x</a>
<a class="sourceLine" id="cb16-173" title="173"></a>
<a class="sourceLine" id="cb16-174" title="174"><span class="ot">isValidError ::</span> a <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb16-175" title="175">isValidError x <span class="fu">=</span> <span class="fu">catch</span> (x <span class="ot">`seq`</span> <span class="fu">return</span> <span class="dt">False</span>) hdl</a>
<a class="sourceLine" id="cb16-176" title="176">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb16-177" title="177"><span class="ot">    hdl ::</span> <span class="dt">SomeException</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb16-178" title="178">    hdl se <span class="fu">=</span> <span class="fu">return</span> <span class="fu">$</span> (<span class="fu">length</span> <span class="fu">$</span> <span class="fu">show</span> se) <span class="ot">`seq`</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb16-179" title="179"></a>
<a class="sourceLine" id="cb16-180" title="180"><span class="ot">unsafe_find_capture_id ::</span> <span class="dt">CaptureID</span> <span class="ot">-&gt;</span> <span class="dt">CaptureNames</span> <span class="ot">-&gt;</span> <span class="dt">CaptureOrdinal</span></a>
<a class="sourceLine" id="cb16-181" title="181">unsafe_find_capture_id cid <span class="fu">=</span> <span class="fu">either</span> <span class="fu">error</span> <span class="fu">id</span> <span class="fu">.</span> findCaptureID cid</a>
<a class="sourceLine" id="cb16-182" title="182"></a>
<a class="sourceLine" id="cb16-183" title="183"><span class="ot">un_either ::</span> <span class="dt">Either</span> <span class="dt">String</span> a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb16-184" title="184">un_either <span class="fu">=</span> <span class="fu">either</span> <span class="fu">error</span> <span class="fu">id</span></a></code></pre></div>
</div>    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-92650418-1', 'auto');
      ga('send', 'pageview');

    </script>
</body>
</html>
