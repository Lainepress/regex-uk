<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>regex â€“ examples/re-tests.lhs</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lib/lhs-styles.css" />
  <link rel="stylesheet" href="lib/bs.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"/>
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/>
  <link rel="manifest" href="/manifest.json"/>
  <link rel="mask-icon" href="/safari-pinned-tab.svg"/>
  <meta name="theme-color" content="#ffffff"/>
</head>
<body>
<div class='bcdiv'>
  <ol class='breadcrumb'>
    <li><a href="." style="font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;" id="branding">[<span style='color:red;'>re</span>|${<span style='color:red;'>gex</span>}(.*)|<span></span>]</a></li>
    <li><a title='source file' href='https://github.com/iconnect/regex/blob/master/examples/re-tests.lhs'>examples/re-tests.lhs</a></li>
</ol>
</div>
<div class='litcontent'>
<header id="title-block-header">
<h1 class="title">examples/re-tests.lhs</h1>
</header>
<h1 id="regex-test-suite">Regex Test Suite</h1>
<p>All of the regex exampes are self-testing and together make up the regex test suite run during development and over each release of the test suite. But here we have the unit an small-check tests used to systematically probe the library for weak points and guard against regressions.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="ot">{-# LANGUAGE NoImplicitPrelude          #-}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="ot">{-# LANGUAGE RecordWildCards            #-}</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="ot">{-# LANGUAGE OverloadedStrings          #-}</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="ot">{-# LANGUAGE QuasiQuotes                #-}</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="ot">{-# LANGUAGE MultiParamTypeClasses      #-}</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="ot">{-# LANGUAGE FlexibleInstances          #-}</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="ot">{-# LANGUAGE TemplateHaskell            #-}</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="ot">{-# LANGUAGE FlexibleContexts           #-}</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="ot">{-# LANGUAGE DeriveFunctor              #-}</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="ot">{-# LANGUAGE StandaloneDeriving         #-}</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="ot">{-# OPTIONS_GHC -fno-warn-orphans       #-}</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a><span class="kw">module</span> <span class="dt">Main</span> (main) <span class="kw">where</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Control.Exception</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Control.Monad</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Data.Array</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.Char8</span>          <span class="kw">as</span> <span class="dt">B</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.Lazy.Char8</span>     <span class="kw">as</span> <span class="dt">LBS</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.Lazy.UTF8</span>      <span class="kw">as</span> <span class="dt">LBS</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.UTF8</span>           <span class="kw">as</span> <span class="dt">B</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Data.Char</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Foldable</span>                  <span class="kw">as</span> <span class="dt">F</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.HashMap.Strict</span>            <span class="kw">as</span> <span class="dt">HM</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Data.Maybe</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Monoid</span>                    <span class="kw">as</span> <span class="dt">M</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Sequence</span>                  <span class="kw">as</span> <span class="dt">S</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Data.String</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Text</span>                      <span class="kw">as</span> <span class="dt">T</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Text.Lazy</span>                 <span class="kw">as</span> <span class="dt">LT</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Data.Typeable</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Language.Haskell.TH.Quote</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Prelude.Compat</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">System.Directory</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">System.FilePath</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">System.Info</span>                    <span class="kw">as</span> <span class="dt">SI</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Test.SmallCheck.Series</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Test.Tasty</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Test.Tasty.HUnit</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Test.Tasty.SmallCheck</span>          <span class="kw">as</span> <span class="dt">SC</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">TestKit</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Text.Heredoc</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE</span>                   <span class="kw">as</span> <span class="dt">PCRE</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.ByteString</span>        <span class="kw">as</span> <span class="dt">P_BS</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.ByteString.Lazy</span>   <span class="kw">as</span> <span class="dt">PLBS</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.Sequence</span>          <span class="kw">as</span> <span class="dt">P_SQ</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.String</span>            <span class="kw">as</span> <span class="dt">P_ST</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.Text</span>              <span class="kw">as</span> <span class="dt">P_TX</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.PCRE.Text.Lazy</span>         <span class="kw">as</span> <span class="dt">PLTX</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Text.RE.REOptions</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Text.RE.Replace</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Text.RE.TDFA</span>                   <span class="kw">as</span> <span class="dt">TDFA</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.ByteString</span>        <span class="kw">as</span> <span class="dt">T_BS</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.ByteString.Lazy</span>   <span class="kw">as</span> <span class="dt">TLBS</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.Sequence</span>          <span class="kw">as</span> <span class="dt">T_SQ</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.String</span>            <span class="kw">as</span> <span class="dt">T_ST</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.Text</span>              <span class="kw">as</span> <span class="dt">T_TX</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.RE.TDFA.Text.Lazy</span>         <span class="kw">as</span> <span class="dt">TLTX</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Text.RE.TestBench</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Text.RE.Tools.Find</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Text.RE.Tools.Sed</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true"></a><span class="kw">import</span>           <span class="dt">Text.RE.ZeInternals</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.Regex.PCRE</span>                <span class="kw">as</span> <span class="dt">PCRE_</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Text.Regex.TDFA</span>                <span class="kw">as</span> <span class="dt">TDFA_</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>  <span class="fu">print</span> SI.os</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>  defaultMain <span class="op">$</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>    testGroup <span class="st">&quot;Tests&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>      [ prelude_tests</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>      , compiling_tests</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>      , core_tests</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>      , replace_methods_tests</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>      , search_replace_tests</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>      , options_tests</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>      , named_capture_tests</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a>      , many_tests</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>      , escape_tests</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>      , add_capture_names_tests</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a>      , find_tests</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a>      , backslash_tests</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a>      , misc_tests</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a>      ]</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co">-- | check that our self-testing macro environments are good</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="ot">prelude_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>prelude_tests <span class="ot">=</span> testGroup <span class="st">&quot;Prelude&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>  [ tc TDFA.regexType TDFA.preludeEnv</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>  , tc PCRE.regexType PCRE.preludeEnv</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>  ]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>    tc rty m_env <span class="ot">=</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>      testCase (<span class="fu">show</span> rty) <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>        is_docs <span class="ot">&lt;-</span> doesDirectoryExist <span class="st">&quot;docs&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>        when is_docs <span class="op">$</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>          dumpMacroTable (fp <span class="st">&quot;docs&quot;</span> <span class="st">&quot;.txt&quot;</span>) (fp <span class="st">&quot;docs&quot;</span> <span class="st">&quot;-src.txt&quot;</span>) rty m_env</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>        dumpMacroTable   (fp <span class="st">&quot;data&quot;</span> <span class="st">&quot;.txt&quot;</span>) (fp <span class="st">&quot;data&quot;</span> <span class="st">&quot;-src.txt&quot;</span>) rty m_env</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>        assertBool <span class="st">&quot;testMacroEnv&quot;</span> <span class="op">=&lt;&lt;</span> testMacroEnv <span class="st">&quot;prelude&quot;</span> rty m_env</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a>      <span class="kw">where</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a>        fp dir sfx <span class="ot">=</span> dir <span class="op">&lt;/&gt;</span> (rty_s <span class="op">++</span> <span class="st">&quot;-macros&quot;</span> <span class="op">++</span> sfx)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a>        rty_s      <span class="ot">=</span> <span class="fu">map</span> <span class="fu">toLower</span> <span class="op">$</span> presentRegexType rty</span></code></pre></div>
<h2 id="core-matchreplace-tests">Core Match/Replace Tests</h2>
<h3>
test vectors
</h3>
<p>The core tests rely on these simple test vectors.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co">-- | our standard test strings</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>str_,<span class="ot"> str&#39; ::</span> <span class="dt">String</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>str_      <span class="ot">=</span> <span class="st">&quot;a bbbb aa b&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>str&#39;      <span class="ot">=</span> <span class="st">&quot;foo&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="co">-- | standard test REs</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>regex_,<span class="ot"> regex_alt ::</span> <span class="dt">RE</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>regex_    <span class="ot">=</span> [re|(a+) (b+)|]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>regex_alt <span class="ot">=</span> [re|(a+)|(b+)|]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a><span class="co">-- | golden matches result 1</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="ot">regex_str_matches ::</span> <span class="dt">Matches</span> <span class="dt">String</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a>regex_str_matches <span class="ot">=</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>  <span class="dt">Matches</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a>    { matchesSource <span class="ot">=</span> str_</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a>    , allMatches <span class="ot">=</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a>        [ regex_str_match</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a>        , regex_str_match_2</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a>        ]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a>    }</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a><span class="co">-- | golden match result 1</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a><span class="ot">regex_str_match ::</span> <span class="dt">Match</span> <span class="dt">String</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true"></a>regex_str_match <span class="ot">=</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true"></a>  <span class="dt">Match</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true"></a>    { matchSource   <span class="ot">=</span> str_</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true"></a>    , captureNames  <span class="ot">=</span> noCaptureNames</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true"></a>    , matchArray    <span class="ot">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true"></a>        [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;a bbbb&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">0</span>, captureLength <span class="ot">=</span> <span class="dv">6</span>})</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true"></a>        , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;a&quot;</span>     , captureOffset <span class="ot">=</span> <span class="dv">0</span>, captureLength <span class="ot">=</span> <span class="dv">1</span>})</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true"></a>        , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;bbbb&quot;</span>  , captureOffset <span class="ot">=</span> <span class="dv">2</span>, captureLength <span class="ot">=</span> <span class="dv">4</span>})</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true"></a>        ]</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true"></a>    }</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true"></a><span class="co">-- | golden match result 2</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true"></a><span class="ot">regex_str_match_2 ::</span> <span class="dt">Match</span> <span class="dt">String</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true"></a>regex_str_match_2 <span class="ot">=</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true"></a>  <span class="dt">Match</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true"></a>    { matchSource   <span class="ot">=</span> str_</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true"></a>    , captureNames  <span class="ot">=</span> noCaptureNames</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true"></a>    , matchArray    <span class="ot">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true"></a>        [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;aa b&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">7</span> , captureLength <span class="ot">=</span> <span class="dv">4</span>})</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true"></a>        , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;aa&quot;</span>  , captureOffset <span class="ot">=</span> <span class="dv">7</span> , captureLength <span class="ot">=</span> <span class="dv">2</span>})</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true"></a>        , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;b&quot;</span>   , captureOffset <span class="ot">=</span> <span class="dv">10</span>, captureLength <span class="ot">=</span> <span class="dv">1</span>})</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true"></a>        ]</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true"></a>    }</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true"></a></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true"></a><span class="co">-- | golden match result 2</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true"></a><span class="ot">regex_alt_str_matches ::</span> <span class="dt">Matches</span> <span class="dt">String</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true"></a>regex_alt_str_matches <span class="ot">=</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true"></a>  <span class="dt">Matches</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true"></a>    { matchesSource <span class="ot">=</span> str_</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true"></a>    , allMatches    <span class="ot">=</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true"></a>        [ <span class="dt">Match</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true"></a>            { matchSource   <span class="ot">=</span> str_</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true"></a>            , captureNames  <span class="ot">=</span> noCaptureNames</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true"></a>            , matchArray    <span class="ot">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true"></a>                [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;a&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">0</span>, captureLength <span class="ot">=</span> <span class="dv">1</span>})</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true"></a>                , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;a&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">0</span>, captureLength <span class="ot">=</span> <span class="dv">1</span>})</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true"></a>                , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;&quot;</span>, captureOffset <span class="ot">=</span> <span class="op">-</span><span class="dv">1</span>, captureLength <span class="ot">=</span> <span class="dv">0</span>})</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true"></a>                ]</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true"></a>            }</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true"></a>        , <span class="dt">Match</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true"></a>            { matchSource   <span class="ot">=</span> str_</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true"></a>            , captureNames  <span class="ot">=</span> noCaptureNames</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true"></a>            , matchArray    <span class="ot">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true"></a>                [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;bbbb&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">2</span> , captureLength <span class="ot">=</span> <span class="dv">4</span>})</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true"></a>                , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;&quot;</span>    , captureOffset <span class="ot">=</span> <span class="op">-</span><span class="dv">1</span>, captureLength <span class="ot">=</span> <span class="dv">0</span>})</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true"></a>                , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;bbbb&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">2</span> , captureLength <span class="ot">=</span> <span class="dv">4</span>})</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true"></a>                ]</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true"></a>            }</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true"></a>        , <span class="dt">Match</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true"></a>            { matchSource   <span class="ot">=</span> str_</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true"></a>            , captureNames  <span class="ot">=</span> noCaptureNames</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true"></a>            , matchArray    <span class="ot">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true"></a>                [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;aa&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">7</span> , captureLength <span class="ot">=</span> <span class="dv">2</span>})</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true"></a>                , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;aa&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">7</span> , captureLength <span class="ot">=</span> <span class="dv">2</span>})</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true"></a>                , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;&quot;</span>  , captureOffset <span class="ot">=</span> <span class="op">-</span><span class="dv">1</span>, captureLength <span class="ot">=</span> <span class="dv">0</span>})</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true"></a>                ]</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true"></a>            }</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true"></a>        , <span class="dt">Match</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true"></a>            { matchSource   <span class="ot">=</span> str_</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true"></a>            , captureNames  <span class="ot">=</span> noCaptureNames</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true"></a>            , matchArray    <span class="ot">=</span> array (<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true"></a>                [ (<span class="dv">0</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;b&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">10</span>, captureLength <span class="ot">=</span> <span class="dv">1</span>})</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true"></a>                , (<span class="dv">1</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;&quot;</span> , captureOffset <span class="ot">=</span> <span class="op">-</span><span class="dv">1</span>, captureLength <span class="ot">=</span> <span class="dv">0</span>})</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true"></a>                , (<span class="dv">2</span>,<span class="dt">Capture</span> {captureSource <span class="ot">=</span> str_, capturedText <span class="ot">=</span> <span class="st">&quot;b&quot;</span>, captureOffset <span class="ot">=</span> <span class="dv">10</span>, captureLength <span class="ot">=</span> <span class="dv">1</span>})</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true"></a>                ]</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true"></a>            }</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true"></a>        ]</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true"></a>    }</span></code></pre></div>
<h3>
testing the compileRegex functions
</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="ot">compiling_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>compiling_tests <span class="ot">=</span> testGroup <span class="st">&quot;Compiling&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>  [ testCase <span class="st">&quot;complete check (matchM/ByteString)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>      r <span class="ot">&lt;-</span> TDFA.compileRegex <span class="op">$</span> reSource regex_</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>      assertEqual <span class="st">&quot;Match&quot;</span> (B.pack <span class="op">&lt;$&gt;</span> regex_str_match) <span class="op">$</span> B.pack str_ <span class="op">?=~</span> r</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>  , testCase <span class="st">&quot;matched (matchM/Text)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>      r <span class="ot">&lt;-</span> TDFA.compileRegex <span class="op">$</span> reSource regex_</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a>      assertBool <span class="st">&quot;matched&quot;</span> <span class="op">$</span> matched <span class="op">$</span> T.pack str_ <span class="op">?=~</span> r</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a>  , tc <span class="st">&quot;TDFA.String&quot;</span>  TDFA.compileRegex</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>  , tc <span class="st">&quot;TDFA.B&quot;</span>     <span class="op">$</span> TDFA.compileRegex <span class="op">.</span> B.unpack</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>  , tc <span class="st">&quot;TDFA.LBS&quot;</span>   <span class="op">$</span> TDFA.compileRegex <span class="op">.</span> LBS.unpack</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>  , tc <span class="st">&quot;TDFA.T&quot;</span>     <span class="op">$</span> TDFA.compileRegex <span class="op">.</span> T.unpack</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>  , tc <span class="st">&quot;TDFA.LT&quot;</span>    <span class="op">$</span> TDFA.compileRegex <span class="op">.</span> <span class="dt">LT</span><span class="op">.</span>unpack</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a>  , tc <span class="st">&quot;TDFA.S&quot;</span>     <span class="op">$</span> TDFA.compileRegex <span class="op">.</span> s_toList</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>  , tc <span class="st">&quot;PCRE.String&quot;</span>  PCRE.compileRegex</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a>  , tc <span class="st">&quot;PCRE.B&quot;</span>     <span class="op">$</span> PCRE.compileRegex <span class="op">.</span> B.unpack</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a>  , tc <span class="st">&quot;PCRE.LBS&quot;</span>   <span class="op">$</span> PCRE.compileRegex <span class="op">.</span> LBS.unpack</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a>  , tc <span class="st">&quot;PCRE.S&quot;</span>     <span class="op">$</span> PCRE.compileRegex <span class="op">.</span> s_toList</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a>  ]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a><span class="ot">    tc ::</span> <span class="dt">IsRegex</span> re s <span class="ot">=&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span><span class="dt">IO</span> re) <span class="ot">-&gt;</span> <span class="dt">TestTree</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a>    tc lab mk0 <span class="ot">=</span> testGroup lab</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true"></a>        [ testCase <span class="st">&quot;loop&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true"></a>            r <span class="ot">&lt;-</span> mk re_s</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true"></a>            assertEqual <span class="st">&quot;RE&quot;</span> re_s <span class="op">$</span> regexSource r</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true"></a>        , testCase <span class="st">&quot;Match&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true"></a>            r <span class="ot">&lt;-</span> mk&#39; re_s</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true"></a>            assertEqual <span class="st">&quot;Match&quot;</span>  (pk <span class="op">&lt;$&gt;</span> regex_str_match) <span class="op">$</span> matchOnce r <span class="op">$</span> pk str_</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true"></a>        , testCase <span class="st">&quot;Escape&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true"></a>            r <span class="ot">&lt;-</span> esc <span class="op">$</span> pk <span class="st">&quot;foobar&quot;</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true"></a>            assertEqual <span class="st">&quot;String&quot;</span> (pk <span class="st">&quot;bar&quot;</span>) <span class="op">$</span> matchSource <span class="op">$</span> matchOnce r <span class="op">$</span> pk <span class="st">&quot;bar&quot;</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true"></a>        ]</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true"></a>      <span class="kw">where</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true"></a>        mk   <span class="ot">=</span> makeRegex              <span class="ot">`asTypeOf`</span> mk0</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true"></a>        mk&#39;  <span class="ot">=</span> makeRegexWith <span class="fu">minBound</span> <span class="ot">`asTypeOf`</span> mk0</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true"></a>        esc  <span class="ot">=</span> makeEscaped <span class="fu">id</span>         <span class="ot">`asTypeOf`</span> mk0</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true"></a>        re_s <span class="ot">=</span> pk <span class="op">$</span> reSource regex_</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true"></a>        pk   <span class="ot">=</span> mk_pk mk0</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true"></a><span class="ot">        mk_pk ::</span> <span class="dt">Replace</span> s&#39; <span class="ot">=&gt;</span> (s&#39;<span class="ot">-&gt;</span><span class="dt">IO</span> re&#39;) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> s&#39;</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true"></a>        mk_pk _ <span class="ot">=</span> packR</span></code></pre></div>
<h3>
core tests
</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="ot">core_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>core_tests <span class="ot">=</span> testGroup <span class="st">&quot;Match&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>  [ testCase <span class="st">&quot;text (=~~Text.Lazy)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>      txt <span class="ot">&lt;-</span> <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span> str_ <span class="op">=~~</span> [re|(a+) (b+)|]<span class="ot"> ::</span> <span class="dt">IO</span> (<span class="dt">LT</span><span class="op">.</span><span class="dt">Text</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>      assertEqual <span class="st">&quot;text&quot;</span> txt <span class="st">&quot;a bbbb&quot;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>  , testCase <span class="st">&quot;multi (=~~/String)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a>      <span class="kw">let</span> sm <span class="ot">=</span> str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Match</span> <span class="dt">String</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>          m  <span class="ot">=</span> capture [cp|0|] sm</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>      assertEqual <span class="st">&quot;captureSource&quot;</span> <span class="st">&quot;a bbbb aa b&quot;</span> <span class="op">$</span> captureSource m</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a>      assertEqual <span class="st">&quot;capturedText&quot;</span>  <span class="st">&quot;a bbbb&quot;</span>      <span class="op">$</span> capturedText  m</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a>      assertEqual <span class="st">&quot;capturePrefix&quot;</span> <span class="st">&quot;&quot;</span>            <span class="op">$</span> capturePrefix m</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>      assertEqual <span class="st">&quot;captureSuffix&quot;</span> <span class="st">&quot; aa b&quot;</span>       <span class="op">$</span> captureSuffix m</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>  , testCase <span class="st">&quot;complete (=~~/ByteString)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>      mtch <span class="ot">&lt;-</span> B.pack str_ <span class="op">=~~</span><span class="ot"> regex_ ::</span> <span class="dt">IO</span> (<span class="dt">Match</span> <span class="dt">B.ByteString</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a>      assertEqual <span class="st">&quot;Match&quot;</span> mtch <span class="op">$</span> B.pack <span class="op">&lt;$&gt;</span> regex_str_match</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a>  , testCase <span class="st">&quot;complete (all,String)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a>      <span class="kw">let</span> mtchs <span class="ot">=</span> str_ <span class="op">=~</span><span class="ot"> regex_     ::</span> <span class="dt">Matches</span> <span class="dt">String</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>      assertEqual <span class="st">&quot;Matches&quot;</span> mtchs regex_str_matches</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>  , testCase <span class="st">&quot;complete (all,reg_alt)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>      <span class="kw">let</span> mtchs <span class="ot">=</span> str_ <span class="op">=~</span><span class="ot"> regex_alt  ::</span> <span class="dt">Matches</span> <span class="dt">String</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a>      assertEqual <span class="st">&quot;Matches&quot;</span> mtchs regex_alt_str_matches</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a>  , testCase <span class="st">&quot;complete (=~~,all)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a>      mtchs <span class="ot">&lt;-</span> str_ <span class="op">=~~</span><span class="ot"> regex_       ::</span> <span class="dt">IO</span> (<span class="dt">Matches</span> <span class="dt">String</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true"></a>      assertEqual <span class="st">&quot;Matches&quot;</span> mtchs regex_str_matches</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true"></a>  , testCase <span class="st">&quot;fail (all)&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true"></a>      <span class="kw">let</span> mtchs <span class="ot">=</span> str&#39; <span class="op">=~</span><span class="ot"> regex_    ::</span> <span class="dt">Matches</span> <span class="dt">String</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true"></a>      assertEqual <span class="st">&quot;not.anyMatches&quot;</span> <span class="dt">False</span> <span class="op">$</span> anyMatches mtchs</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true"></a>  ]</span></code></pre></div>
<h3>
testing the replace functions at different types
</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="ot">replace_methods_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>replace_methods_tests <span class="ot">=</span> testGroup <span class="st">&quot;Replace&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>  [ testCase <span class="st">&quot;String/single&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>      <span class="kw">let</span> m <span class="ot">=</span> str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Match</span> <span class="dt">String</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>          r <span class="ot">=</span> replaceCaptures <span class="dt">ALL</span> fmt m</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>      assertEqual <span class="st">&quot;replaceCaptures&quot;</span> r <span class="st">&quot;(0:0:(0:1:a) (0:2:bbbb)) aa b&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>  , testCase <span class="st">&quot;String/alt&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>      <span class="kw">let</span> ms <span class="ot">=</span> str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">String</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>          r  <span class="ot">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>      chk r</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>  , testCase <span class="st">&quot;String&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a>      <span class="kw">let</span> ms <span class="ot">=</span> str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">String</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a>          r  <span class="ot">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a>      chk r</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a>  , testCase <span class="st">&quot;ByteString&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a>      <span class="kw">let</span> ms <span class="ot">=</span> B.pack str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">B.ByteString</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a>          r  <span class="ot">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a>      chk r</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a>  , testCase <span class="st">&quot;LBS.ByteString&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true"></a>      <span class="kw">let</span> ms <span class="ot">=</span> LBS.pack str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">LBS.ByteString</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true"></a>          r  <span class="ot">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true"></a>      chk r</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true"></a>  , testCase <span class="st">&quot;Seq Char&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true"></a>      <span class="kw">let</span> ms <span class="ot">=</span> S.fromList str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> (<span class="dt">S.Seq</span> <span class="dt">Char</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true"></a>          f  <span class="ot">=</span> \_ (<span class="dt">RELocation</span> i j) <span class="dt">Capture</span>{<span class="op">..</span>} <span class="ot">-&gt;</span> <span class="dt">Just</span> <span class="op">$</span> S.fromList <span class="op">$</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true"></a>                  <span class="st">&quot;(&quot;</span> <span class="op">M.&lt;&gt;</span> <span class="fu">show</span> i <span class="op">M.&lt;&gt;</span> <span class="st">&quot;:&quot;</span> <span class="op">M.&lt;&gt;</span> show_co j <span class="op">M.&lt;&gt;</span> <span class="st">&quot;:&quot;</span> <span class="op">M.&lt;&gt;</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true"></a>                    F.toList capturedText <span class="op">M.&lt;&gt;</span> <span class="st">&quot;)&quot;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true"></a>          r  <span class="ot">=</span> replaceAllCaptures <span class="dt">ALL</span> f ms</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true"></a>      assertEqual <span class="st">&quot;replaceAllCaptures&quot;</span> r <span class="op">$</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true"></a>        S.fromList <span class="st">&quot;(0:0:(0:1:a) (0:2:bbbb)) (1:0:(1:1:aa) (1:2:b))&quot;</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true"></a>  , testCase <span class="st">&quot;Text&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true"></a>      <span class="kw">let</span> ms <span class="ot">=</span> T.pack str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">T.Text</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true"></a>          r  <span class="ot">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true"></a>      chk r</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true"></a>  , testCase <span class="st">&quot;LT.Text&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true"></a>      <span class="kw">let</span> ms <span class="ot">=</span> <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span> str_ <span class="op">=~</span><span class="ot"> regex_ ::</span> <span class="dt">Matches</span> <span class="dt">LT</span><span class="op">.</span><span class="dt">Text</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true"></a>          r  <span class="ot">=</span> replaceAllCaptures <span class="dt">ALL</span> fmt ms</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true"></a>      chk r</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true"></a>  ]</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true"></a>    chk r <span class="ot">=</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true"></a>      assertEqual</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true"></a>        <span class="st">&quot;replaceAllCaptures&quot;</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true"></a>        r</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true"></a>        <span class="st">&quot;(0:0:(0:1:a) (0:2:bbbb)) (1:0:(1:1:aa) (1:2:b))&quot;</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true"></a><span class="ot">    fmt ::</span> (<span class="dt">IsString</span> s,<span class="dt">Replace</span> s) <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">RELocation</span> <span class="ot">-&gt;</span> <span class="dt">Capture</span> s <span class="ot">-&gt;</span> <span class="dt">Maybe</span> s</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true"></a>    fmt _ (<span class="dt">RELocation</span> i j) <span class="dt">Capture</span>{<span class="op">..</span>} <span class="ot">=</span> <span class="dt">Just</span> <span class="op">$</span> <span class="st">&quot;(&quot;</span> <span class="op">M.&lt;&gt;</span> packR (<span class="fu">show</span> i) <span class="op">M.&lt;&gt;</span> <span class="st">&quot;:&quot;</span> <span class="op">M.&lt;&gt;</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true"></a>      packR (show_co j) <span class="op">M.&lt;&gt;</span> <span class="st">&quot;:&quot;</span> <span class="op">M.&lt;&gt;</span> capturedText <span class="op">M.&lt;&gt;</span> <span class="st">&quot;)&quot;</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true"></a>    show_co (<span class="dt">CaptureOrdinal</span> j) <span class="ot">=</span> <span class="fu">show</span> j</span></code></pre></div>
<h3>
SearchReplace
</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="ot">search_replace_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>search_replace_tests <span class="ot">=</span> testGroup <span class="st">&quot;SearchReplace&quot;</span> <span class="op">$</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>    [ testCase <span class="st">&quot;?=~/ [ed_| ... |]&quot;</span> <span class="op">$</span> <span class="st">&quot;baz bar foobar&quot;</span> <span class="op">@=?</span> <span class="st">&quot;foo bar foobar&quot;</span> <span class="op">T_ST.?=~/</span> [ed_|foo///baz|] ()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>    , testCase <span class="st">&quot;*=~/ [ed_| ... |]&quot;</span> <span class="op">$</span> <span class="st">&quot;baz bar bazbar&quot;</span> <span class="op">@=?</span> <span class="st">&quot;foo bar foobar&quot;</span> <span class="op">T_ST.*=~/</span> [ed_|foo///baz|] <span class="dt">MultilineSensitive</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA.ed/String&quot;</span> <span class="op">$</span> test_ <span class="fu">id</span>         tdfa_eds</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE.ed/String&quot;</span> <span class="op">$</span> test_ <span class="fu">id</span>         pcre_eds</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA.ed/B&quot;</span>      <span class="op">$</span> test_ B.pack     tdfa_eds</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE.ed/B&quot;</span>      <span class="op">$</span> test_ B.pack     pcre_eds</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA.ed/LBS&quot;</span>    <span class="op">$</span> test_ LBS.pack   tdfa_eds</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE.ed/LBS&quot;</span>    <span class="op">$</span> test_ LBS.pack   pcre_eds</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA.ed/S&quot;</span>      <span class="op">$</span> test_ S.fromList tdfa_eds</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE.ed/S&quot;</span>      <span class="op">$</span> test_ S.fromList pcre_eds</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA.ed/T&quot;</span>      <span class="op">$</span> test_ T.pack     tdfa_eds</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA.ed/LT&quot;</span>     <span class="op">$</span> test_ <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span>    tdfa_eds</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA.ed/T(d)&quot;</span>   <span class="op">$</span> test_ T.pack     tdfa_eds&#39;</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE.ed/LBS(d)&quot;</span> <span class="op">$</span> test_ LBS.pack   pcre_eds&#39;</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true"></a>    , testg <span class="st">&quot;TDFA.op&quot;</span>        (<span class="op">T_ST.?=~/</span>) (<span class="op">T_ST.*=~/</span>) tdfa_sr</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true"></a>    , testg <span class="st">&quot;PCRE.op&quot;</span>        (<span class="op">P_ST.?=~/</span>) (<span class="op">P_ST.*=~/</span>) pcre_sr</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true"></a>    , testg <span class="st">&quot;TDFA.op/String&quot;</span> (<span class="op">T_ST.?=~/</span>) (<span class="op">T_ST.*=~/</span>) tdfa_sr_str</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true"></a>    , testg <span class="st">&quot;PCRE.op/String&quot;</span> (<span class="op">P_ST.?=~/</span>) (<span class="op">P_ST.*=~/</span>) pcre_sr_str</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true"></a>    , testg <span class="st">&quot;TDFA.op/B&quot;</span>      (<span class="op">T_BS.?=~/</span>) (<span class="op">T_BS.*=~/</span>) tdfa_sr_b</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true"></a>    , testg <span class="st">&quot;PCRE.op/B&quot;</span>      (<span class="op">P_BS.?=~/</span>) (<span class="op">P_BS.*=~/</span>) pcre_sr_b</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true"></a>    , testg <span class="st">&quot;TDFA.op/LBS&quot;</span>    (<span class="op">TLBS.?=~/</span>) (<span class="op">TLBS.*=~/</span>) tdfa_sr_lbs</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true"></a>    , testg <span class="st">&quot;PCRE.op/LBS&quot;</span>    (<span class="op">PLBS.?=~/</span>) (<span class="op">PLBS.*=~/</span>) pcre_sr_lbs</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true"></a>    , testg <span class="st">&quot;TDFA.op/T&quot;</span>      (<span class="op">T_TX.?=~/</span>) (<span class="op">T_TX.*=~/</span>) tdfa_sr_t</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true"></a>    , testg <span class="st">&quot;PCRE.op/T&quot;</span>      (<span class="op">P_TX.?=~/</span>) (<span class="op">P_TX.*=~/</span>) pcre_sr_t</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true"></a>    , testg <span class="st">&quot;TDFA.op/LT&quot;</span>     (<span class="op">TLTX.?=~/</span>) (<span class="op">TLTX.*=~/</span>) tdfa_sr_lt</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true"></a>    , testg <span class="st">&quot;PCRE.op/LT&quot;</span>     (<span class="op">PLTX.?=~/</span>) (<span class="op">PLTX.*=~/</span>) pcre_sr_lt</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true"></a>    , testG <span class="st">&quot;TDFA.op/S&quot;</span>      (<span class="op">T_SQ.?=~/</span>) (<span class="op">T_SQ.*=~/</span>) tdfa_sr_s</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true"></a>    , testG <span class="st">&quot;PCRE.op/S&quot;</span>      (<span class="op">P_SQ.?=~/</span>) (<span class="op">P_SQ.*=~/</span>) pcre_sr_s</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true"></a>    , testu <span class="st">&quot;TDFA.U/String&quot;</span> <span class="fu">id</span>              (<span class="op">T_ST.*=~/</span>) [T_ST.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">T_ST.*=~</span>) [T_ST.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true"></a>    , testu <span class="st">&quot;TDFA.U/B&quot;</span>      B.fromString    (<span class="op">T_BS.*=~/</span>) [T_BS.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">T_BS.*=~</span>) [T_BS.re<span class="op">|</span>burble<span class="op">|</span>]</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true"></a>    , testu <span class="st">&quot;TDFA.U/LBS&quot;</span>    LBS.fromString  (<span class="op">TLBS.*=~/</span>) [TLBS.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">TLBS.*=~</span>) [TLBS.re<span class="op">|</span>burble<span class="op">|</span>]</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true"></a>    , testu <span class="st">&quot;TDFA.U/T&quot;</span>      T.pack          (<span class="op">T_TX.*=~/</span>) [T_TX.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">T_TX.*=~</span>) [T_TX.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true"></a>    , testu <span class="st">&quot;TDFA.U/LT&quot;</span>     <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span>         (<span class="op">TLTX.*=~/</span>) [TLTX.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">TLTX.*=~</span>) [TLTX.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true"></a>    , testu <span class="st">&quot;TDFA.U/S&quot;</span>      S.fromList      (<span class="op">T_SQ.*=~/</span>) [T_SQ.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">T_SQ.*=~</span>) [T_SQ.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true"></a>    ] <span class="op">++</span> not_win32_for_now</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true"></a>    [ testu <span class="st">&quot;PCRE.U/String&quot;</span> <span class="fu">id</span>              (<span class="op">P_ST.*=~/</span>) [P_ST.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">P_ST.*=~</span>) [P_ST.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true"></a>    , testu <span class="st">&quot;PCRE.U/B&quot;</span>      B.fromString    (<span class="op">P_BS.*=~/</span>) [P_BS.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">P_BS.*=~</span>) [P_BS.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true"></a>    , testu <span class="st">&quot;PCRE.U/LBS&quot;</span>    LBS.fromString  (<span class="op">PLBS.*=~/</span>) [PLBS.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">PLBS.*=~</span>) [PLBS.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true"></a>    , testu <span class="st">&quot;PCRE.U/T&quot;</span>      T.pack          (<span class="op">P_TX.*=~/</span>) [P_TX.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">P_TX.*=~</span>) [P_TX.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true"></a>    , testu <span class="st">&quot;PCRE.U/LT&quot;</span>     <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span>         (<span class="op">PLTX.*=~/</span>) [PLTX.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">PLTX.*=~</span>) [PLTX.re<span class="op">|</span>Î»<span class="op">-|</span>]</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true"></a>    , testu <span class="st">&quot;PCRE.U/S&quot;</span>      S.fromList      (<span class="op">P_SQ.*=~/</span>) [P_SQ.ed<span class="op">|</span>scientist<span class="op">///</span>boffin<span class="op">|</span>] (<span class="op">P_SQ.*=~</span>) [P_SQ.re<span class="op">|</span>burble<span class="op">|</span>]</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true"></a>    ]</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true"></a><span class="ot">    not_win32_for_now ::</span> [a] <span class="ot">-&gt;</span> [a]</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true"></a>    not_win32_for_now <span class="ot">=</span> <span class="kw">case</span> SI.os <span class="op">==</span> <span class="st">&quot;mingw32&quot;</span> <span class="kw">of</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true"></a>      <span class="dt">True</span>  <span class="ot">-&gt;</span> <span class="fu">const</span> []</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true"></a>      <span class="dt">False</span> <span class="ot">-&gt;</span> <span class="fu">id</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true"></a><span class="ot">    test_ ::</span> <span class="dt">IsRegex</span> re a <span class="ot">=&gt;</span> (<span class="dt">String</span><span class="ot">-&gt;</span>a) <span class="ot">-&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> re a <span class="ot">-&gt;</span> <span class="dt">Assertion</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true"></a>    test_ inj eds <span class="ot">=</span>  inj rsm <span class="op">@=?</span> runIdentity (sed&#39; eds <span class="op">$</span> inj inp)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true"></a></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true"></a>    testg lab op1 opm sr <span class="ot">=</span> testGroup lab</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true"></a>      [ testCase <span class="st">&quot;?=~/&quot;</span> <span class="op">$</span> rs1 <span class="op">@=?</span> inp <span class="ot">`op1`</span> sr</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true"></a>      , testCase <span class="st">&quot;*=~/&quot;</span> <span class="op">$</span> rsm <span class="op">@=?</span> inp <span class="ot">`opm`</span> sr</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true"></a>      ]</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true"></a></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true"></a>    testG lab op1 opm sr <span class="ot">=</span> testGroup lab</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true"></a>      [ testCase <span class="st">&quot;?=~/&quot;</span> <span class="op">$</span> S.fromList rs1 <span class="op">@=?</span> S.fromList inp <span class="ot">`op1`</span> sr</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true"></a>      , testCase <span class="st">&quot;*=~/&quot;</span> <span class="op">$</span> S.fromList rsm <span class="op">@=?</span> S.fromList inp <span class="ot">`opm`</span> sr</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true"></a>      ]</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true"></a>    testu lab inj op sr qop rex <span class="ot">=</span> testGroup lab</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true"></a>      [ testCase <span class="st">&quot;*=~/&quot;</span> <span class="op">$</span> inj unr <span class="op">@=?</span> inj uni <span class="ot">`op`</span> sr</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true"></a>      , testCase <span class="st">&quot;*=~&quot;</span>  <span class="op">$</span> <span class="dv">1</span>       <span class="op">@=?</span> countMatches (inj uni <span class="ot">`qop`</span> rex)</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true"></a>      ]</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true"></a></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true"></a>    inp, rs1,<span class="ot"> rsm ::</span> <span class="dt">IsString</span> a <span class="ot">=&gt;</span> a</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true"></a>    inp <span class="ot">=</span> <span class="st">&quot;16/03/2017 01/01/2000\n&quot;</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true"></a>    rs1 <span class="ot">=</span> <span class="st">&quot;2017-03-16 01/01/2000\n&quot;</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true"></a>    rsm <span class="ot">=</span> <span class="st">&quot;2017-03-16 2000-01-01\n&quot;</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true"></a></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true"></a>    uni,<span class="ot"> unr ::</span> <span class="dt">String</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true"></a>    uni <span class="ot">=</span> <span class="st">&quot;\x2070E-\8364-\955-scientist-burble&quot;</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true"></a>    unr <span class="ot">=</span> <span class="st">&quot;\x2070E-\8364-\955-boffin-burble&quot;</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true"></a></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true"></a><span class="ot">    tdfa_eds    ::</span> <span class="dt">IsRegex</span> <span class="dt">TDFA.RE</span> a <span class="ot">=&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> <span class="dt">TDFA.RE</span> a</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true"></a>    tdfa_eds    <span class="ot">=</span> <span class="dt">Select</span> [<span class="dt">Template</span> tdfa_sr]</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true"></a></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true"></a><span class="ot">    pcre_eds    ::</span> <span class="dt">IsRegex</span> <span class="dt">PCRE.RE</span> a <span class="ot">=&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> <span class="dt">PCRE.RE</span> a</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true"></a>    pcre_eds    <span class="ot">=</span> <span class="dt">Select</span> [<span class="dt">Template</span> pcre_sr]</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true"></a></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true"></a><span class="ot">    tdfa_sr     ::</span> <span class="dt">IsRegex</span> <span class="dt">TDFA.RE</span> a <span class="ot">=&gt;</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> a</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true"></a>    tdfa_sr     <span class="ot">=</span> [TDFA.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true"></a></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true"></a><span class="ot">    pcre_sr     ::</span> <span class="dt">IsRegex</span> <span class="dt">PCRE.RE</span> a <span class="ot">=&gt;</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> a</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true"></a>    pcre_sr     <span class="ot">=</span> [PCRE.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true"></a><span class="ot">    tdfa_sr_str ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">String</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true"></a>    tdfa_sr_str <span class="ot">=</span> [T_ST.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true"></a></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true"></a><span class="ot">    pcre_sr_str ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">String</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true"></a>    pcre_sr_str <span class="ot">=</span> [P_ST.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true"></a></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true"></a><span class="ot">    tdfa_sr_b   ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">B.ByteString</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true"></a>    tdfa_sr_b   <span class="ot">=</span> [T_BS.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true"></a></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true"></a><span class="ot">    pcre_sr_b   ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">B.ByteString</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true"></a>    pcre_sr_b   <span class="ot">=</span> [P_BS.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true"></a></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true"></a><span class="ot">    tdfa_sr_lbs ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">LBS.ByteString</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true"></a>    tdfa_sr_lbs <span class="ot">=</span> [TLBS.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true"></a></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true"></a><span class="ot">    pcre_sr_lbs ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">LBS.ByteString</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true"></a>    pcre_sr_lbs <span class="ot">=</span> [PLBS.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true"></a></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true"></a><span class="ot">    tdfa_sr_t   ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">T.Text</span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true"></a>    tdfa_sr_t   <span class="ot">=</span> [T_TX.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true"></a></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true"></a><span class="ot">    pcre_sr_t   ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">T.Text</span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true"></a>    pcre_sr_t   <span class="ot">=</span> [P_TX.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true"></a></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true"></a><span class="ot">    tdfa_sr_lt  ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> <span class="dt">LT</span><span class="op">.</span><span class="dt">Text</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true"></a>    tdfa_sr_lt  <span class="ot">=</span> [TLTX.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true"></a></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true"></a><span class="ot">    pcre_sr_lt  ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> <span class="dt">LT</span><span class="op">.</span><span class="dt">Text</span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true"></a>    pcre_sr_lt  <span class="ot">=</span> [PLTX.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true"></a></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true"></a><span class="ot">    tdfa_sr_s   ::</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> (<span class="dt">S.Seq</span> <span class="dt">Char</span>)</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true"></a>    tdfa_sr_s   <span class="ot">=</span> [T_SQ.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true"></a></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true"></a><span class="ot">    pcre_sr_s   ::</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> (<span class="dt">S.Seq</span> <span class="dt">Char</span>)</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true"></a>    pcre_sr_s   <span class="ot">=</span> [P_SQ.ed<span class="op">|$</span>{d}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{m}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">2</span>})<span class="op">/$</span>{y}([<span class="dv">0</span><span class="op">-</span><span class="dv">9</span>]{<span class="dv">4</span>})<span class="op">///$</span>{y}<span class="op">-$</span>{m}<span class="op">-$</span>{d}<span class="op">|</span>]</span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true"></a></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true"></a><span class="ot">    tdfa_eds&#39;   ::</span> <span class="dt">IsRegex</span> <span class="dt">TDFA.RE</span> a <span class="ot">=&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> <span class="dt">TDFA.RE</span> a</span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true"></a>    tdfa_eds&#39;   <span class="ot">=</span> <span class="dt">Select</span> [<span class="dt">Template</span> <span class="op">$</span> tdfa_csr <span class="st">&quot;${d}([0-9]{2})/${m}([0-9]{2})/${y}([0-9]{4})&quot;</span> <span class="st">&quot;${y}-${m}-${d}&quot;</span>]</span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true"></a></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true"></a><span class="ot">    pcre_eds&#39;   ::</span> <span class="dt">IsRegex</span> <span class="dt">PCRE.RE</span> a <span class="ot">=&gt;</span> <span class="dt">Edits</span> <span class="dt">Identity</span> <span class="dt">PCRE.RE</span> a</span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true"></a>    pcre_eds&#39;   <span class="ot">=</span> <span class="dt">Select</span> [<span class="dt">Template</span> <span class="op">$</span> pcre_csr <span class="st">&quot;${d}([0-9]{2})/${m}([0-9]{2})/${y}([0-9]{4})&quot;</span> <span class="st">&quot;${y}-${m}-${d}&quot;</span>]</span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true"></a></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true"></a><span class="ot">    tdfa_csr    ::</span> <span class="dt">IsRegex</span> <span class="dt">TDFA.RE</span> s</span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true"></a>                <span class="ot">=&gt;</span> <span class="dt">String</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true"></a>                <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true"></a>                <span class="ot">-&gt;</span> <span class="dt">SearchReplace</span> <span class="dt">TDFA.RE</span> s</span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true"></a>    tdfa_csr re_s <span class="ot">=</span> <span class="fu">maybe</span> (<span class="fu">error</span> <span class="st">&quot;eek&quot;</span>) <span class="fu">id</span> <span class="op">.</span> TDFA.compileSearchReplace re_s</span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true"></a></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true"></a><span class="ot">    pcre_csr    ::</span> <span class="dt">IsRegex</span> <span class="dt">PCRE.RE</span> s</span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true"></a>                <span class="ot">=&gt;</span> <span class="dt">String</span></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true"></a>                <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true"></a>                <span class="ot">-&gt;</span> <span class="dt">SearchReplace</span> <span class="dt">PCRE.RE</span> s</span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true"></a>    pcre_csr re_s <span class="ot">=</span> <span class="fu">maybe</span> (<span class="fu">error</span> <span class="st">&quot;eek&quot;</span>) <span class="fu">id</span> <span class="op">.</span> PCRE.compileSearchReplace re_s</span></code></pre></div>
<h3>
Testing The REOptions
</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="ot">options_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>options_tests <span class="ot">=</span> testGroup <span class="st">&quot;Simple REOptions&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>  [ testGroup <span class="st">&quot;TDFA Simple REOptions&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>      [ testCase <span class="st">&quot;default (MultilineSensitive)&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">2</span> <span class="op">$</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">TDFA.*=~</span> [TDFA.re<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>      , testCase <span class="st">&quot;MultilineSensitive&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">2</span> <span class="op">$</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">TDFA.*=~</span> [TDFA.reMultilineSensitive<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>      , testCase <span class="st">&quot;MultilineInsensitive&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">4</span> <span class="op">$</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">TDFA.*=~</span> [TDFA.reMultilineInsensitive<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>      , testCase <span class="st">&quot;BlockSensitive&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">0</span> <span class="op">$</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">TDFA.*=~</span> [TDFA.reBlockSensitive<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a>      , testCase <span class="st">&quot;BlockInsensitive&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">1</span> <span class="op">$</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">TDFA.*=~</span> [TDFA.reBlockInsensitive<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a>      ]</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a>  , testGroup <span class="st">&quot;PCRE Simple REOptions&quot;</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a>      [ testCase <span class="st">&quot;default (MultilineSensitive)&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">2</span> <span class="op">$</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">PCRE.*=~</span> [PCRE.re<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true"></a>      , testCase <span class="st">&quot;MultilineSensitive&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">2</span> <span class="op">$</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">PCRE.*=~</span> [PCRE.reMultilineSensitive<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true"></a>      , testCase <span class="st">&quot;MultilineInsensitive&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">4</span> <span class="op">$</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">PCRE.*=~</span> [PCRE.reMultilineInsensitive<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true"></a>      , testCase <span class="st">&quot;BlockSensitive&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">0</span> <span class="op">$</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">PCRE.*=~</span> [PCRE.reBlockSensitive<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true"></a>      , testCase <span class="st">&quot;BlockInsensitive&quot;</span> <span class="op">$</span> assertEqual <span class="st">&quot;#&quot;</span> <span class="dv">1</span> <span class="op">$</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true"></a>          countMatches <span class="op">$</span> s <span class="op">PCRE.*=~</span> [PCRE.reBlockInsensitive<span class="op">|</span>[<span class="dv">0</span><span class="op">-</span>9a<span class="op">-</span>f]{<span class="dv">2</span>}<span class="op">$|</span>]</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true"></a>      ]</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true"></a>    ]</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true"></a>    s <span class="ot">=</span> <span class="st">&quot;0a\nbb\nFe\nA5&quot;</span><span class="ot"> ::</span> <span class="dt">String</span></span></code></pre></div>
<h3>
Exercising Our Many APIs
</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="ot">many_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>many_tests <span class="ot">=</span> testGroup <span class="st">&quot;Many Tests&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>    [ testCase <span class="st">&quot;PCRE a&quot;</span>               <span class="op">$</span> test_ (<span class="op">PCRE.*=~</span>) (<span class="op">PCRE.?=~</span>) (<span class="op">PCRE.=~</span>) (<span class="op">PCRE.=~~</span>) matchOnce matchMany makeSearchReplace <span class="fu">id</span>          re_pcre</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE ByteString&quot;</span>      <span class="op">$</span> test_ (<span class="op">P_BS.*=~</span>) (<span class="op">P_BS.?=~</span>) (<span class="op">P_BS.=~</span>) (<span class="op">P_BS.=~~</span>) matchOnce matchMany makeSearchReplace B.pack      re_pcre</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE ByteString.Lazy&quot;</span> <span class="op">$</span> test_ (<span class="op">PLBS.*=~</span>) (<span class="op">PLBS.?=~</span>) (<span class="op">PLBS.=~</span>) (<span class="op">PLBS.=~~</span>) matchOnce matchMany makeSearchReplace LBS.pack    re_pcre</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE Sequence&quot;</span>        <span class="op">$</span> test_ (<span class="op">P_SQ.*=~</span>) (<span class="op">P_SQ.?=~</span>) (<span class="op">P_SQ.=~</span>) (<span class="op">P_SQ.=~~</span>) matchOnce matchMany makeSearchReplace S.fromList  re_pcre</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE String&quot;</span>          <span class="op">$</span> test_ (<span class="op">P_ST.*=~</span>) (<span class="op">P_ST.?=~</span>) (<span class="op">P_ST.=~</span>) (<span class="op">P_ST.=~~</span>) matchOnce matchMany makeSearchReplace <span class="fu">id</span>          re_pcre</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE Text&quot;</span>            <span class="op">$</span> test_ (<span class="op">P_TX.*=~</span>) (<span class="op">P_TX.?=~</span>) (<span class="op">P_TX.=~</span>) (<span class="op">P_TX.=~~</span>) matchOnce matchMany makeSearchReplace T.pack      re_pcre</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a>    , testCase <span class="st">&quot;PCRE Text.Lazy&quot;</span>       <span class="op">$</span> test_ (<span class="op">PLTX.*=~</span>) (<span class="op">PLTX.?=~</span>) (<span class="op">PLTX.=~</span>) (<span class="op">PLTX.=~~</span>) matchOnce matchMany makeSearchReplace <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span>     re_pcre</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA a&quot;</span>               <span class="op">$</span> test_ (<span class="op">TDFA.*=~</span>) (<span class="op">TDFA.?=~</span>) (<span class="op">TDFA.=~</span>) (<span class="op">TDFA.=~~</span>) matchOnce matchMany makeSearchReplace <span class="fu">id</span>          re_tdfa</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA ByteString&quot;</span>      <span class="op">$</span> test_ (<span class="op">T_BS.*=~</span>) (<span class="op">T_BS.?=~</span>) (<span class="op">T_BS.=~</span>) (<span class="op">T_BS.=~~</span>) matchOnce matchMany makeSearchReplace B.pack      re_tdfa</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA ByteString.Lazy&quot;</span> <span class="op">$</span> test_ (<span class="op">TLBS.*=~</span>) (<span class="op">TLBS.?=~</span>) (<span class="op">TLBS.=~</span>) (<span class="op">TLBS.=~~</span>) matchOnce matchMany makeSearchReplace LBS.pack    re_tdfa</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA Sequence&quot;</span>        <span class="op">$</span> test_ (<span class="op">T_SQ.*=~</span>) (<span class="op">T_SQ.?=~</span>) (<span class="op">T_SQ.=~</span>) (<span class="op">T_SQ.=~~</span>) matchOnce matchMany makeSearchReplace S.fromList  re_tdfa</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA String&quot;</span>          <span class="op">$</span> test_ (<span class="op">T_ST.*=~</span>) (<span class="op">T_ST.?=~</span>) (<span class="op">T_ST.=~</span>) (<span class="op">T_ST.=~~</span>) matchOnce matchMany makeSearchReplace <span class="fu">id</span>          re_tdfa</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA Text&quot;</span>            <span class="op">$</span> test_ (<span class="op">T_TX.*=~</span>) (<span class="op">T_TX.?=~</span>) (<span class="op">T_TX.=~</span>) (<span class="op">T_TX.=~~</span>) matchOnce matchMany makeSearchReplace T.pack      re_tdfa</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a>    , testCase <span class="st">&quot;TDFA Text.Lazy&quot;</span>       <span class="op">$</span> test_ (<span class="op">TLTX.*=~</span>) (<span class="op">TLTX.?=~</span>) (<span class="op">TLTX.=~</span>) (<span class="op">TLTX.=~~</span>) matchOnce matchMany makeSearchReplace <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span>     re_tdfa</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a>    ]</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a><span class="ot">    test_ ::</span> (<span class="dt">IsRegex</span> r s,<span class="dt">Show</span> s,<span class="dt">Eq</span> s)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a>          <span class="ot">=&gt;</span> (s<span class="ot">-&gt;</span>r<span class="ot">-&gt;</span><span class="dt">Matches</span> s)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a>          <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span>r<span class="ot">-&gt;</span><span class="dt">Match</span>   s)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true"></a>          <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span>r<span class="ot">-&gt;</span><span class="dt">Matches</span> s)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true"></a>          <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span>r<span class="ot">-&gt;</span><span class="dt">Maybe</span>(<span class="dt">Match</span> s))</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true"></a>          <span class="ot">-&gt;</span> (r<span class="ot">-&gt;</span>s<span class="ot">-&gt;</span><span class="dt">Match</span>   s)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true"></a>          <span class="ot">-&gt;</span> (r<span class="ot">-&gt;</span>s<span class="ot">-&gt;</span><span class="dt">Matches</span> s)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true"></a>          <span class="ot">-&gt;</span> (s<span class="ot">-&gt;</span>s<span class="ot">-&gt;</span><span class="dt">Maybe</span> (<span class="dt">SearchReplace</span> r s))</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true"></a>          <span class="ot">-&gt;</span> (<span class="dt">String</span><span class="ot">-&gt;</span>s)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true"></a>          <span class="ot">-&gt;</span> r</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true"></a>          <span class="ot">-&gt;</span> <span class="dt">Assertion</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true"></a>    test_ (<span class="op">%*=~</span>) (<span class="op">%?=~</span>) (<span class="op">%=~</span>) (<span class="op">%=~~</span>) mo mm mk_sr0 inj r <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true"></a>        <span class="dv">2</span>         <span class="op">@=?</span> countMatches mtchs</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true"></a>        <span class="dt">Just</span> txt&#39; <span class="op">@=?</span> matchedText  mtch</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true"></a>        mtchs     <span class="op">@=?</span> mtchs&#39;</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true"></a>        mb_mtch   <span class="op">@=?</span> <span class="dt">Just</span> mtch</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true"></a>        mtch      <span class="op">@=?</span> mtch&#39;&#39;</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true"></a>        mtchs     <span class="op">@=?</span> mtchs&#39;&#39;</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true"></a>        txt&#39;&#39;     <span class="op">@=?</span> searchReplaceAll (mk_sr re_t tpl) txt</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true"></a>      <span class="kw">where</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true"></a>        mtchs   <span class="ot">=</span> txt <span class="op">%*=~</span> r</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true"></a>        mtch    <span class="ot">=</span> txt <span class="op">%?=~</span> r</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true"></a>        mtchs&#39;  <span class="ot">=</span> txt <span class="op">%=~</span>  r</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true"></a>        mb_mtch <span class="ot">=</span> txt <span class="op">%=~~</span> r</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true"></a>        mtch&#39;&#39;  <span class="ot">=</span> mo r txt</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true"></a>        mtchs&#39;&#39; <span class="ot">=</span> mm r txt</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true"></a>        re_t    <span class="ot">=</span> inj re_s</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true"></a>        tpl     <span class="ot">=</span> inj <span class="st">&quot;${d}/${m}/${y}&quot;</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true"></a></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true"></a>        txt     <span class="ot">=</span> inj <span class="st">&quot;2016-01-09 2015-12-5 2015-10-05&quot;</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true"></a>        txt&#39;    <span class="ot">=</span> inj <span class="st">&quot;2016-01-09&quot;</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true"></a>        txt&#39;&#39;   <span class="ot">=</span> inj <span class="st">&quot;09/01/2016 2015-12-5 05/10/2015&quot;</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true"></a>        mk_sr   <span class="ot">=</span> \r_ t_ <span class="ot">-&gt;</span> <span class="fu">maybe</span> (<span class="fu">error</span> <span class="st">&quot;agh&quot;</span>) <span class="fu">id</span> <span class="op">$</span> mk_sr0 r_ t_</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true"></a></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true"></a>    re_pcre <span class="ot">=</span> fromMaybe oops <span class="op">$</span> PCRE.compileRegex <span class="st">&quot;[0-9]{4}-[0-9]{2}-[0-9]{2}&quot;</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true"></a>    re_tdfa <span class="ot">=</span> fromMaybe oops <span class="op">$</span> TDFA.compileRegex <span class="st">&quot;[0-9]{4}-[0-9]{2}-[0-9]{2}&quot;</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true"></a>    re_s    <span class="ot">=</span> <span class="st">&quot;${y}([0-9]{4})-${m}([0-9]{2})-${d}([0-9]{2})&quot;</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true"></a></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true"></a>    oops    <span class="ot">=</span> <span class="fu">error</span> <span class="st">&quot;many_tests&quot;</span></span></code></pre></div>
<h2 id="testing-the-re-escape-functions">Testing the RE Escape Functions</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="ot">escape_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>escape_tests <span class="ot">=</span> testGroup <span class="st">&quot;Escape Tests&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>    [ testGroup <span class="st">&quot;PCRE&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>        [ testCase  <span class="st">&quot;Escaping empty string&quot;</span> <span class="op">$</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>            assertBool <span class="st">&quot;empty string&quot;</span> <span class="op">$</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>              tst P_ST.escape (<span class="op">P_ST.?=~</span>) <span class="st">&quot;&quot;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>        , testCase  <span class="st">&quot;Escaping RE metacharacters&quot;</span> <span class="op">$</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>            assertBool <span class="st">&quot;metacharacters&quot;</span> <span class="op">$</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>              tst P_ST.escape (<span class="op">P_ST.?=~</span>) metacharacters</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>        , localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">6</span>) <span class="op">$</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>            SC.testProperty <span class="st">&quot;matched $ &lt;s&gt; ?=~ [re|^escape(&lt;s&gt;)$|]&quot;</span> <span class="op">$</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a>              tst P_ST.escape (<span class="op">P_ST.?=~</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a>        ]</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>    , testGroup <span class="st">&quot;TDFA&quot;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>        [ testCase  <span class="st">&quot;Escaping empty string&quot;</span> <span class="op">$</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>            assertBool <span class="st">&quot;empty string&quot;</span> <span class="op">$</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a>              tst T_ST.escape (<span class="op">T_ST.?=~</span>) <span class="st">&quot;&quot;</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a>        , testCase  <span class="st">&quot;Escaping RE metacharacters&quot;</span> <span class="op">$</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>            assertBool <span class="st">&quot;metacharacters&quot;</span> <span class="op">$</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a>              tst T_ST.escape (<span class="op">T_ST.?=~</span>) metacharacters</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a>        , localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">6</span>) <span class="op">$</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a>            SC.testProperty <span class="st">&quot;matched $ &lt;s&gt; ?=~ [re|^escape(&lt;s&gt;)$|]&quot;</span> <span class="op">$</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a>              tst T_ST.escape (<span class="op">T_ST.?=~</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a>        ]</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a>    ]</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a><span class="ot">    tst ::</span> ((<span class="dt">String</span><span class="ot">-&gt;</span><span class="dt">String</span>)<span class="ot">-&gt;</span><span class="dt">String</span><span class="ot">-&gt;</span><span class="dt">Maybe</span> a)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a>        <span class="ot">-&gt;</span> (<span class="dt">String</span><span class="ot">-&gt;</span>a<span class="ot">-&gt;</span><span class="dt">Match</span> <span class="dt">String</span>)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true"></a>        <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true"></a>        <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true"></a>    tst esc0 (<span class="op">%=~</span>) s <span class="ot">=</span> matched <span class="op">$</span> s <span class="op">%=~</span> esc s</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true"></a>      <span class="kw">where</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true"></a>        esc <span class="ot">=</span> un_maybe <span class="op">.</span> esc0 ((<span class="st">&quot;^&quot;</span> <span class="op">++</span>) <span class="op">.</span> (<span class="op">++</span> <span class="st">&quot;$&quot;</span>))</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true"></a><span class="ot">    metacharacters ::</span> <span class="dt">String</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true"></a>    metacharacters <span class="ot">=</span> <span class="st">&quot;^\\.|*+?()[]{}$&quot;</span></span></code></pre></div>
<h2 id="named-capture-tests">Named Capture Tests</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="ot">named_capture_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>named_capture_tests <span class="ot">=</span> localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">4</span>) <span class="op">$</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>  testGroup <span class="st">&quot;NamedCaptures&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>    [ format_scan_tests</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>    , analyse_tokens_tests</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>    ]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a><span class="kw">instance</span> <span class="dt">Monad</span> m <span class="ot">=&gt;</span> <span class="dt">Serial</span> m <span class="dt">Token</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a><span class="ot">format_scan_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>format_scan_tests <span class="ot">=</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>  testGroup <span class="st">&quot;FormatToken/Scan Properties&quot;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a>    [ localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">4</span>) <span class="op">$</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a>        SC.testProperty <span class="st">&quot;formatTokens == formatTokens0&quot;</span> <span class="op">$</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a>          \tks <span class="ot">-&gt;</span> formatTokens tks <span class="op">==</span> formatTokens0 tks</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a>    , localOption (<span class="dt">SmallCheckDepth</span> <span class="dv">4</span>) <span class="op">$</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a>        SC.testProperty <span class="st">&quot;scan . formatTokens&#39; idFormatTokenREOptions == id&quot;</span> <span class="op">$</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a>          \tks <span class="ot">-&gt;</span> <span class="fu">all</span> validToken tks <span class="op">==&gt;</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a>                    scan (formatTokens&#39; idFormatTokenREOptions tks) <span class="op">==</span> tks</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a>    ]</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true"></a><span class="ot">analyse_tokens_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true"></a>analyse_tokens_tests <span class="ot">=</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true"></a>  testGroup <span class="st">&quot;Analysing [Token] Unit Tests&quot;</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true"></a>    [ tc [here|foobar|]                                       []</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true"></a>    , tc [here||]                                             []</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true"></a>    , tc [here|$([0-9]{4})|]                                  []</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true"></a>    , tc [here|${x}()|]                                       [(<span class="dv">1</span>,<span class="st">&quot;x&quot;</span>)]</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true"></a>    , tc [here|${}()|]                                        []</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true"></a>    , tc [here|${}()${foo}()|]                                [(<span class="dv">2</span>,<span class="st">&quot;foo&quot;</span>)]</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true"></a>    , tc [here|${x}(${y()})|]                                 [(<span class="dv">1</span>,<span class="st">&quot;x&quot;</span>)]</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true"></a>    , tc [here|${x}(${y}())|]                                 [(<span class="dv">1</span>,<span class="st">&quot;x&quot;</span>),(<span class="dv">2</span>,<span class="st">&quot;y&quot;</span>)]</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true"></a>    , tc [here|${a}(${b{}())|]                                [(<span class="dv">1</span>,<span class="st">&quot;a&quot;</span>)]</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true"></a>    , tc [here|${y}([0-9]{4})-${m}([0-9]{2})-${d}([0-9]{2})|] [(<span class="dv">1</span>,<span class="st">&quot;y&quot;</span>),(<span class="dv">2</span>,<span class="st">&quot;m&quot;</span>),(<span class="dv">3</span>,<span class="st">&quot;d&quot;</span>)]</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true"></a>    , tc [here|@$(@|\{${name}([^{}]+)\})|]                    [(<span class="dv">2</span>,<span class="st">&quot;name&quot;</span>)]</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true"></a>    , tc [here|${y}[0-9]{4}|]                                 []</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true"></a>    , tc [here|${}([0-9]{4})|]                                []</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true"></a>    ]</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true"></a>    tc s al <span class="ot">=</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true"></a>      testCase s <span class="op">$</span> assertEqual <span class="st">&quot;CaptureNames&quot;</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true"></a>        (xnc s)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true"></a>        (HM.fromList</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true"></a>          [ (<span class="dt">CaptureName</span> <span class="op">$</span> T.pack n,<span class="dt">CaptureOrdinal</span> i)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true"></a>              <span class="op">|</span> (i,n)<span class="ot">&lt;-</span>al</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true"></a>              ]</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true"></a>        )</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true"></a>    xnc <span class="ot">=</span> <span class="fu">either</span> oops (<span class="fu">snd</span> <span class="op">.</span> <span class="fu">fst</span>) <span class="op">.</span> extractNamedCaptures</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true"></a>      <span class="kw">where</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true"></a>        oops <span class="ot">=</span> <span class="fu">error</span> <span class="st">&quot;analyse_tokens_tests: unexpected parse failure&quot;</span></span></code></pre></div>
<h2 id="addcapturenames-tests">AddCaptureNames Tests</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="ot">add_capture_names_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>add_capture_names_tests <span class="ot">=</span> testGroup <span class="st">&quot;AddCaptureNames Tests&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>    [ test_add_capture_name <span class="st">&quot;Match   String&quot;</span>          test_match                    regex_str_match</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Matches String&quot;</span>          test_matches                  regex_str_matches</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Match   B.ByteString&quot;</span>    test_match   <span class="op">$</span> B.pack     <span class="op">&lt;$&gt;</span> regex_str_match</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Matches B.ByteString&quot;</span>    test_matches <span class="op">$</span> B.pack     <span class="op">&lt;$&gt;</span> regex_str_matches</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Match   LBS.ByteString&quot;</span>  test_match   <span class="op">$</span> LBS.pack   <span class="op">&lt;$&gt;</span> regex_str_match</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Matches LBS.ByteString&quot;</span>  test_matches <span class="op">$</span> LBS.pack   <span class="op">&lt;$&gt;</span> regex_str_matches</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Match   T.Text&quot;</span>          test_match   <span class="op">$</span> T.pack     <span class="op">&lt;$&gt;</span> regex_str_match</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Matches T.Text&quot;</span>          test_matches <span class="op">$</span> T.pack     <span class="op">&lt;$&gt;</span> regex_str_matches</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Match   LT.Text&quot;</span>         test_match   <span class="op">$</span> <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span>    <span class="op">&lt;$&gt;</span> regex_str_match</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Matches LT.Text&quot;</span>         test_matches <span class="op">$</span> <span class="dt">LT</span><span class="op">.</span><span class="fu">pack</span>    <span class="op">&lt;$&gt;</span> regex_str_matches</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Match   (Seq Char)&quot;</span>      test_match   <span class="op">$</span> S.fromList <span class="op">&lt;$&gt;</span> regex_str_match</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a>    , test_add_capture_name <span class="st">&quot;Matches (Seq Char)&quot;</span>      test_matches <span class="op">$</span> S.fromList <span class="op">&lt;$&gt;</span> regex_str_matches</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a>    ]</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a><span class="ot">test_matches ::</span> <span class="dt">CaptureNames</span> <span class="ot">-&gt;</span> <span class="dt">Matches</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a>test_matches cnms <span class="ot">=</span> <span class="fu">all</span> (test_match cnms) <span class="op">.</span> allMatches</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a><span class="ot">test_match ::</span> <span class="dt">CaptureNames</span> <span class="ot">-&gt;</span> <span class="dt">Match</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a>test_match cnms mtch <span class="ot">=</span> captureNames mtch <span class="op">==</span> cnms</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a><span class="ot">test_add_capture_name ::</span> <span class="dt">Typeable</span> a</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a>                      <span class="ot">=&gt;</span> <span class="dt">String</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a>                      <span class="ot">-&gt;</span> (<span class="dt">CaptureNames</span><span class="ot">-&gt;</span>a<span class="ot">-&gt;</span><span class="dt">Bool</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a>                      <span class="ot">-&gt;</span> a</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true"></a>                      <span class="ot">-&gt;</span> <span class="dt">TestTree</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true"></a>test_add_capture_name lab tst x <span class="ot">=</span> testCase lab <span class="op">$</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true"></a>    assertBool lab <span class="op">$</span> tst cnms <span class="op">$</span> addCaptureNames cnms x</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true"></a>    cnms <span class="ot">=</span> HM.fromList</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true"></a>      [ (<span class="dt">CaptureName</span> <span class="st">&quot;x&quot;</span>,<span class="dv">1</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true"></a>      , (<span class="dt">CaptureName</span> <span class="st">&quot;y&quot;</span>,<span class="dv">2</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true"></a>      ]</span></code></pre></div>
<h2 id="the-find-tests">The Find Tests</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="ot">find_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>find_tests <span class="ot">=</span> testGroup <span class="st">&quot;Find Tests&quot;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>    [ testCase <span class="st">&quot;examples/&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>        fps <span class="ot">&lt;-</span> findMatches_ findMethods [re|^re-.*\.lhs|] <span class="st">&quot;examples/&quot;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>        example_paths <span class="op">@=?</span> <span class="fu">filter</span> (<span class="fu">not</span> <span class="op">.</span> matched <span class="op">.</span> (<span class="op">?=~</span> [re|master\.lhs|])) fps</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>    ]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a><span class="ot">example_paths ::</span> [<span class="dt">String</span>]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a>example_paths <span class="ot">=</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a>  [ <span class="st">&quot;examples/re-gen-cabals.lhs&quot;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-gen-modules.lhs&quot;</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-include.lhs&quot;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-nginx-log-processor.lhs&quot;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-prep.lhs&quot;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-sort-imports.lhs&quot;</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-tests.lhs&quot;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-top.lhs&quot;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-tutorial-options.lhs&quot;</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-tutorial-replacing.lhs&quot;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-tutorial-testbench.lhs&quot;</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-tutorial-tools.lhs&quot;</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true"></a>  , <span class="st">&quot;examples/re-tutorial.lhs&quot;</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true"></a>  ]</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true"></a><span class="ot">findMethods ::</span> <span class="dt">FindMethods</span> <span class="dt">String</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true"></a>findMethods <span class="ot">=</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true"></a>  <span class="dt">FindMethods</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true"></a>    { doesDirectoryExistDM <span class="ot">=</span> doesDirectoryExist</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true"></a>    , listDirectoryDM      <span class="ot">=</span> getDirectoryContents</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true"></a>    , combineDM            <span class="ot">=</span> (<span class="op">&lt;/&gt;</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true"></a>    }</span></code></pre></div>
<h2 id="the-backslash-tests">The Backslash Tests</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="ot">backslash_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>backslash_tests <span class="ot">=</span> testGroup <span class="st">&quot;Backslash Tests&quot;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a>  [ testGroup <span class="st">&quot;PCRE&quot;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>      [ testCase <span class="st">&quot;backslash-a&quot;</span>         <span class="op">$</span> <span class="st">&quot;\ay&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\ay&quot;</span> <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\a]<span class="op">*///|</span>]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-b&quot;</span>         <span class="op">$</span> <span class="st">&quot;\by&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\by&quot;</span> <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\b]<span class="op">*///|</span>]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-f&quot;</span>         <span class="op">$</span> <span class="st">&quot;\fy&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\fy&quot;</span> <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\f]<span class="op">*///|</span>]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-n&quot;</span>         <span class="op">$</span> <span class="st">&quot;\ny&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\ny&quot;</span> <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\n]<span class="op">*///|</span>]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-r&quot;</span>         <span class="op">$</span> <span class="st">&quot;\ry&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\ry&quot;</span> <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\r]<span class="op">*///|</span>]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-t&quot;</span>         <span class="op">$</span> <span class="st">&quot;\ty&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\ty&quot;</span> <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\t]<span class="op">*///|</span>]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-v&quot;</span>         <span class="op">$</span> <span class="st">&quot;\vy&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\vy&quot;</span> <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\v]<span class="op">*///|</span>]</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-$&quot;</span>         <span class="op">$</span> <span class="st">&quot;$y&quot;</span>  <span class="op">@=?</span> <span class="st">&quot;--foo$y&quot;</span>  <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\<span class="op">$</span>]<span class="op">*///|</span>]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-backslash&quot;</span> <span class="op">$</span> <span class="st">&quot;\\y&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\\y&quot;</span> <span class="op">P_TX.*=~/</span> [P_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\\]<span class="op">*///|</span>]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a>      ]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a>  , testGroup <span class="st">&quot;TDFA&quot;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a>      [ testCase <span class="st">&quot;backslash-a&quot;</span>         <span class="op">$</span> <span class="st">&quot;\ay&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\ay&quot;</span> <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\a]<span class="op">*///|</span>]</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-b&quot;</span>         <span class="op">$</span> <span class="st">&quot;\by&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\by&quot;</span> <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\b]<span class="op">*///|</span>]</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-f&quot;</span>         <span class="op">$</span> <span class="st">&quot;\fy&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\fy&quot;</span> <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\f]<span class="op">*///|</span>]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-n&quot;</span>         <span class="op">$</span> <span class="st">&quot;\ny&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\ny&quot;</span> <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\n]<span class="op">*///|</span>]</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-r&quot;</span>         <span class="op">$</span> <span class="st">&quot;\ry&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\ry&quot;</span> <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\r]<span class="op">*///|</span>]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-t&quot;</span>         <span class="op">$</span> <span class="st">&quot;\ty&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\ty&quot;</span> <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\t]<span class="op">*///|</span>]</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-v&quot;</span>         <span class="op">$</span> <span class="st">&quot;\vy&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\vy&quot;</span> <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\v]<span class="op">*///|</span>]</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-$&quot;</span>         <span class="op">$</span> <span class="st">&quot;$y&quot;</span>  <span class="op">@=?</span> <span class="st">&quot;--foo$y&quot;</span>  <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\<span class="op">$</span>]<span class="op">*///|</span>]</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true"></a>      , testCase <span class="st">&quot;backslash-backslash&quot;</span> <span class="op">$</span> <span class="st">&quot;\\y&quot;</span> <span class="op">@=?</span> <span class="st">&quot;--foo\\y&quot;</span> <span class="op">T_TX.*=~/</span> [T_TX.edBlockSensitive<span class="op">|--</span>[<span class="op">^</span>\\]<span class="op">*///|</span>]</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true"></a>      ]</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true"></a>  ]</span></code></pre></div>
<h2 id="the-miscelaneous-tests">The Miscelaneous Tests</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="ot">misc_tests ::</span> <span class="dt">TestTree</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>misc_tests <span class="ot">=</span> testGroup <span class="st">&quot;Miscelaneous Tests&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>    [ testGroup <span class="st">&quot;CaptureID&quot;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a>        [ testCase <span class="st">&quot;CaptureID lookup failure&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>            ok <span class="ot">&lt;-</span> isValidError <span class="op">$</span> unsafe_find_capture_id [cp|foo|] <span class="op">$</span> reCaptureNames [re|foo|]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a>            assertBool <span class="st">&quot;failed&quot;</span> ok</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>        ]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>    , testGroup <span class="st">&quot;QQ&quot;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a>        [ qq_tc <span class="st">&quot;re&quot;</span>                      re</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;reMS&quot;</span>                    reMS</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;reMI&quot;</span>                    reMI</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;reBS&quot;</span>                    reBS</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;reBI&quot;</span>                    reBI</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;reMultilineSensitive&quot;</span>    reMultilineSensitive</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;reMultilineInsensitive&quot;</span>  reMultilineInsensitive</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;reBlockSensitive&quot;</span>        reBlockSensitive</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;reBlockInsensitive&quot;</span>      reBlockInsensitive</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;re_&quot;</span>                     re_</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;ed&quot;</span>                      ed</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;edMS&quot;</span>                    edMS</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;edMI&quot;</span>                    edMI</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;edBS&quot;</span>                    edBS</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;edBI&quot;</span>                    edBI</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;edMultilineSensitive&quot;</span>    edMultilineSensitive</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;edMultilineInsensitive&quot;</span>  edMultilineInsensitive</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;edBlockSensitive&quot;</span>        edBlockSensitive</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;edBlockInsensitive&quot;</span>      edBlockInsensitive</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true"></a>        , qq_tc <span class="st">&quot;ed_&quot;</span>                     ed_</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true"></a>        ]</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true"></a>    , testGroup <span class="st">&quot;PreludeMacros&quot;</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true"></a>        [ valid_string <span class="st">&quot;preludeMacroTable&quot;</span>    preludeMacroTable</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true"></a>        , valid_macro  <span class="st">&quot;preludeMacroSummary&quot;</span>  preludeMacroSummary</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true"></a>        , valid_string <span class="st">&quot;preludeMacroSources&quot;</span>  preludeMacroSources</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true"></a>        , valid_macro  <span class="st">&quot;preludeMacroSource&quot;</span>   preludeMacroSource</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true"></a>        ]</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true"></a>    <span class="co">-- because HPC can&#39;t measure our testing of [re|..|] forms,</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true"></a>    <span class="co">-- we are eliminating them from our enquiries</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true"></a>    , testGroup <span class="st">&quot;RE&quot;</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true"></a>        [ valid_res TDFA.regexType</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true"></a>            [ TDFA.re</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true"></a>            , TDFA.reMS</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true"></a>            , TDFA.reMI</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true"></a>            , TDFA.reBS</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true"></a>            , TDFA.reBI</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true"></a>            , TDFA.reMultilineSensitive</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true"></a>            , TDFA.reMultilineInsensitive</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true"></a>            , TDFA.reBlockSensitive</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true"></a>            , TDFA.reBlockInsensitive</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true"></a>            , TDFA.re_</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true"></a>            , TDFA.ed</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true"></a>            , TDFA.edMS</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true"></a>            , TDFA.edMI</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true"></a>            , TDFA.edBS</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true"></a>            , TDFA.edBI</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true"></a>            , TDFA.edMultilineSensitive</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true"></a>            , TDFA.edMultilineInsensitive</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true"></a>            , TDFA.edBlockSensitive</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true"></a>            , TDFA.edBlockInsensitive</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true"></a>            , TDFA.ed_</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true"></a>            ]</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true"></a>        , testCase  <span class="st">&quot;TDFA.regexType&quot;</span>           <span class="op">$</span> assertBool <span class="st">&quot;TDFA&quot;</span> <span class="op">$</span> isTDFA TDFA.regexType</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true"></a>        , testCase  <span class="st">&quot;TDFA.reOptions&quot;</span>           <span class="op">$</span> assert_empty_macs <span class="op">$</span> optionsMacs (TDFA.reOptions tdfa_re)</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true"></a>        , testCase  <span class="st">&quot;TDFA.makeREOptions md&quot;</span>      <span class="op">$</span> assert_empty_macs <span class="op">$</span> optionsMacs tdfa_opts</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true"></a>        , testCase  <span class="st">&quot;TDFA.preludeTestsFailing&quot;</span> <span class="op">$</span> []      <span class="op">@=?</span> TDFA.preludeTestsFailing</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true"></a>        , ne_string <span class="st">&quot;TDFA.preludeTable&quot;</span>          TDFA.preludeTable</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true"></a>        , ne_string <span class="st">&quot;TDFA.preludeSources&quot;</span>        TDFA.preludeSources</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true"></a>        , testGroup <span class="st">&quot;TDFA.preludeSummary&quot;</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true"></a>            [ ne_string (presentPreludeMacro pm) <span class="op">$</span> TDFA.preludeSummary pm</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true"></a>                <span class="op">|</span> pm <span class="ot">&lt;-</span> tdfa_prelude_macros</span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true"></a>                ]</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true"></a>        , testGroup  <span class="st">&quot;TDFA.preludeSource&quot;</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true"></a>            [ ne_string (presentPreludeMacro pm) <span class="op">$</span> TDFA.preludeSource  pm</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true"></a>                <span class="op">|</span> pm <span class="ot">&lt;-</span> tdfa_prelude_macros</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true"></a>                ]</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true"></a>    <span class="co">-- because HPC can&#39;t measure our testing of [re|..|] forms,</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true"></a>    <span class="co">-- we are eliminating them from our enquiries</span></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true"></a>        , valid_res PCRE.regexType</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true"></a>            [ PCRE.re</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true"></a>            , PCRE.reMS</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true"></a>            , PCRE.reMI</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true"></a>            , PCRE.reBS</span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true"></a>            , PCRE.reBI</span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true"></a>            , PCRE.reMultilineSensitive</span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true"></a>            , PCRE.reMultilineInsensitive</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true"></a>            , PCRE.reBlockSensitive</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true"></a>            , PCRE.reBlockInsensitive</span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true"></a>            , PCRE.re_</span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true"></a>            , PCRE.ed</span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true"></a>            , PCRE.edMS</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true"></a>            , PCRE.edMI</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true"></a>            , PCRE.edBS</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true"></a>            , PCRE.edBI</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true"></a>            , PCRE.edMultilineSensitive</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true"></a>            , PCRE.edMultilineInsensitive</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true"></a>            , PCRE.edBlockSensitive</span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true"></a>            , PCRE.edBlockInsensitive</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true"></a>            , PCRE.ed_</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true"></a>            ]</span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true"></a>        , testCase  <span class="st">&quot;PCRE.regexType&quot;</span>           <span class="op">$</span> assertBool <span class="st">&quot;PCRE&quot;</span> <span class="op">$</span> isPCRE PCRE.regexType</span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true"></a>        , testCase  <span class="st">&quot;PCRE.reOptions&quot;</span>           <span class="op">$</span> assert_empty_macs <span class="op">$</span> optionsMacs (PCRE.reOptions pcre_re)</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true"></a>        , testCase  <span class="st">&quot;PCRE.makeREOptions md&quot;</span>      <span class="op">$</span> assert_empty_macs <span class="op">$</span> optionsMacs pcre_opts</span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true"></a>        , testCase  <span class="st">&quot;PCRE.preludeTestsFailing&quot;</span> <span class="op">$</span> []      <span class="op">@=?</span> PCRE.preludeTestsFailing</span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true"></a>        , ne_string <span class="st">&quot;PCRE.preludeTable&quot;</span>          PCRE.preludeTable</span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true"></a>        , ne_string <span class="st">&quot;PCRE.preludeTable&quot;</span>          PCRE.preludeSources</span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true"></a>        , testGroup <span class="st">&quot;PCRE.preludeSummary&quot;</span></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true"></a>            [ ne_string (presentPreludeMacro pm) <span class="op">$</span> PCRE.preludeSummary pm</span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true"></a>                <span class="op">|</span> pm <span class="ot">&lt;-</span> pcre_prelude_macros</span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true"></a>                ]</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true"></a>        , testGroup <span class="st">&quot;PCRE.preludeSource&quot;</span></span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true"></a>            [ ne_string (presentPreludeMacro pm) <span class="op">$</span> PCRE.preludeSource  pm</span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true"></a>                <span class="op">|</span> pm <span class="ot">&lt;-</span> pcre_prelude_macros</span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true"></a>                ]</span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true"></a>        ]</span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true"></a>    ]</span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true"></a>    tdfa_re   <span class="ot">=</span> fromMaybe oops <span class="op">$</span> TDFA.compileRegexWithOptions tdfa_opts <span class="st">&quot;.*&quot;</span></span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true"></a>    pcre_re   <span class="ot">=</span> fromMaybe oops <span class="op">$</span> PCRE.compileRegexWithOptions pcre_opts <span class="st">&quot;.*&quot;</span></span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true"></a></span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true"></a>    tdfa_opts <span class="ot">=</span> TDFA.makeREOptions<span class="ot"> no_macs_t ::</span> <span class="dt">REOptions_</span> <span class="dt">TDFA.RE</span> <span class="dt">TDFA_.CompOption</span> <span class="dt">TDFA_.ExecOption</span></span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true"></a>    pcre_opts <span class="ot">=</span> PCRE.makeREOptions<span class="ot"> no_macs_p ::</span> <span class="dt">REOptions_</span> <span class="dt">PCRE.RE</span> <span class="dt">PCRE_.CompOption</span> <span class="dt">PCRE_.ExecOption</span></span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true"></a></span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true"></a>    no_macs_t <span class="ot">=</span> HM.fromList []<span class="ot"> ::</span> <span class="dt">Macros</span> <span class="dt">TDFA.RE</span></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true"></a>    no_macs_p <span class="ot">=</span> HM.fromList []<span class="ot"> ::</span> <span class="dt">Macros</span> <span class="dt">PCRE.RE</span></span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true"></a></span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true"></a>    oops      <span class="ot">=</span> <span class="fu">error</span> <span class="st">&quot;misc_tests&quot;</span></span>
<span id="cb16-126"><a href="#cb16-126" aria-hidden="true"></a></span>
<span id="cb16-127"><a href="#cb16-127" aria-hidden="true"></a>    assert_empty_macs <span class="ot">=</span> assertBool <span class="st">&quot;macros not empty&quot;</span> <span class="op">.</span> HM.null</span>
<span id="cb16-128"><a href="#cb16-128" aria-hidden="true"></a></span>
<span id="cb16-129"><a href="#cb16-129" aria-hidden="true"></a><span class="ot">qq_tc ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">QuasiQuoter</span> <span class="ot">-&gt;</span> <span class="dt">TestTree</span></span>
<span id="cb16-130"><a href="#cb16-130" aria-hidden="true"></a>qq_tc lab qq <span class="ot">=</span> testCase lab <span class="op">$</span> quoteExp qq <span class="ot">`seq`</span> assertBool <span class="st">&quot;qq_tc&quot;</span> <span class="dt">True</span></span>
<span id="cb16-131"><a href="#cb16-131" aria-hidden="true"></a></span>
<span id="cb16-132"><a href="#cb16-132" aria-hidden="true"></a><span class="ot">valid_macro ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> (<span class="dt">RegexType</span><span class="ot">-&gt;</span><span class="dt">PreludeMacro</span><span class="ot">-&gt;</span><span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">TestTree</span></span>
<span id="cb16-133"><a href="#cb16-133" aria-hidden="true"></a>valid_macro label f <span class="ot">=</span> testGroup label</span>
<span id="cb16-134"><a href="#cb16-134" aria-hidden="true"></a>    [ valid_string (presentPreludeMacro pm) (<span class="fu">flip</span> f pm)</span>
<span id="cb16-135"><a href="#cb16-135" aria-hidden="true"></a>        <span class="op">|</span> pm<span class="ot">&lt;-</span>[<span class="fu">minBound</span><span class="op">..</span><span class="fu">maxBound</span>]</span>
<span id="cb16-136"><a href="#cb16-136" aria-hidden="true"></a>        ]</span>
<span id="cb16-137"><a href="#cb16-137" aria-hidden="true"></a></span>
<span id="cb16-138"><a href="#cb16-138" aria-hidden="true"></a><span class="ot">valid_string ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> (<span class="dt">RegexType</span><span class="ot">-&gt;</span><span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">TestTree</span></span>
<span id="cb16-139"><a href="#cb16-139" aria-hidden="true"></a>valid_string label f <span class="ot">=</span> testGroup label</span>
<span id="cb16-140"><a href="#cb16-140" aria-hidden="true"></a>    [ ne_string (presentRegexType rty) <span class="op">$</span> f rty</span>
<span id="cb16-141"><a href="#cb16-141" aria-hidden="true"></a>        <span class="op">|</span> rty<span class="ot">&lt;-</span>[TDFA.regexType] <span class="co">-- until PCRE has a binding for all macros</span></span>
<span id="cb16-142"><a href="#cb16-142" aria-hidden="true"></a>        ]</span>
<span id="cb16-143"><a href="#cb16-143" aria-hidden="true"></a></span>
<span id="cb16-144"><a href="#cb16-144" aria-hidden="true"></a><span class="ot">ne_string ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">TestTree</span></span>
<span id="cb16-145"><a href="#cb16-145" aria-hidden="true"></a>ne_string label s <span class="ot">=</span></span>
<span id="cb16-146"><a href="#cb16-146" aria-hidden="true"></a>  testCase label <span class="op">$</span> assertBool <span class="st">&quot;non-empty string&quot;</span> <span class="op">$</span> <span class="fu">length</span> s <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb16-147"><a href="#cb16-147" aria-hidden="true"></a></span>
<span id="cb16-148"><a href="#cb16-148" aria-hidden="true"></a><span class="co">-- just evaluating quasi quoters to HNF for now -- they</span></span>
<span id="cb16-149"><a href="#cb16-149" aria-hidden="true"></a><span class="co">-- being tested everywhere [re|...|] (etc.) calculations</span></span>
<span id="cb16-150"><a href="#cb16-150" aria-hidden="true"></a><span class="co">-- are bings used but HPC isn&#39;t measuring this</span></span>
<span id="cb16-151"><a href="#cb16-151" aria-hidden="true"></a><span class="ot">valid_res ::</span> <span class="dt">RegexType</span> <span class="ot">-&gt;</span> [<span class="dt">QuasiQuoter</span>] <span class="ot">-&gt;</span> <span class="dt">TestTree</span></span>
<span id="cb16-152"><a href="#cb16-152" aria-hidden="true"></a>valid_res rty <span class="ot">=</span> testCase (<span class="fu">show</span> rty) <span class="op">.</span> <span class="fu">foldr</span> <span class="fu">seq</span> (<span class="fu">return</span> ())</span>
<span id="cb16-153"><a href="#cb16-153" aria-hidden="true"></a></span>
<span id="cb16-154"><a href="#cb16-154" aria-hidden="true"></a><span class="ot">pcre_prelude_macros ::</span> [<span class="dt">PreludeMacro</span>]</span>
<span id="cb16-155"><a href="#cb16-155" aria-hidden="true"></a>pcre_prelude_macros <span class="ot">=</span> <span class="fu">filter</span> (<span class="op">/=</span> <span class="dt">PM_string</span>) [<span class="fu">minBound</span><span class="op">..</span><span class="fu">maxBound</span>]</span>
<span id="cb16-156"><a href="#cb16-156" aria-hidden="true"></a></span>
<span id="cb16-157"><a href="#cb16-157" aria-hidden="true"></a><span class="ot">tdfa_prelude_macros ::</span> [<span class="dt">PreludeMacro</span>]</span>
<span id="cb16-158"><a href="#cb16-158" aria-hidden="true"></a>tdfa_prelude_macros <span class="ot">=</span> [<span class="fu">minBound</span><span class="op">..</span><span class="fu">maxBound</span>]</span>
<span id="cb16-159"><a href="#cb16-159" aria-hidden="true"></a></span>
<span id="cb16-160"><a href="#cb16-160" aria-hidden="true"></a><span class="ot">s_toList ::</span> <span class="dt">S.Seq</span> <span class="dt">Char</span> <span class="ot">-&gt;</span> [<span class="dt">Char</span>]</span>
<span id="cb16-161"><a href="#cb16-161" aria-hidden="true"></a>s_toList <span class="ot">=</span> F.toList</span>
<span id="cb16-162"><a href="#cb16-162" aria-hidden="true"></a></span>
<span id="cb16-163"><a href="#cb16-163" aria-hidden="true"></a><span class="kw">newtype</span> <span class="dt">Identity</span> a <span class="ot">=</span> <span class="dt">Identity</span> {<span class="ot"> runIdentity ::</span> a }</span>
<span id="cb16-164"><a href="#cb16-164" aria-hidden="true"></a>  <span class="kw">deriving</span> (<span class="dt">Functor</span>)</span>
<span id="cb16-165"><a href="#cb16-165" aria-hidden="true"></a></span>
<span id="cb16-166"><a href="#cb16-166" aria-hidden="true"></a><span class="kw">instance</span> <span class="dt">Applicative</span> <span class="dt">Identity</span> <span class="kw">where</span></span>
<span id="cb16-167"><a href="#cb16-167" aria-hidden="true"></a>  <span class="fu">pure</span> <span class="ot">=</span> <span class="dt">Identity</span></span>
<span id="cb16-168"><a href="#cb16-168" aria-hidden="true"></a>  (<span class="op">&lt;*&gt;</span>) (<span class="dt">Identity</span> f) (<span class="dt">Identity</span> x) <span class="ot">=</span> <span class="dt">Identity</span> <span class="op">$</span> f x</span>
<span id="cb16-169"><a href="#cb16-169" aria-hidden="true"></a></span>
<span id="cb16-170"><a href="#cb16-170" aria-hidden="true"></a><span class="kw">instance</span> <span class="dt">Monad</span> <span class="dt">Identity</span> <span class="kw">where</span></span>
<span id="cb16-171"><a href="#cb16-171" aria-hidden="true"></a>  <span class="fu">return</span> <span class="ot">=</span> <span class="dt">Identity</span></span>
<span id="cb16-172"><a href="#cb16-172" aria-hidden="true"></a>  (<span class="op">&gt;&gt;=</span>) (<span class="dt">Identity</span> x) f <span class="ot">=</span> f x</span>
<span id="cb16-173"><a href="#cb16-173" aria-hidden="true"></a></span>
<span id="cb16-174"><a href="#cb16-174" aria-hidden="true"></a><span class="ot">isValidError ::</span> a <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></span>
<span id="cb16-175"><a href="#cb16-175" aria-hidden="true"></a>isValidError x <span class="ot">=</span> <span class="fu">catch</span> (x <span class="ot">`seq`</span> <span class="fu">return</span> <span class="dt">False</span>) hdl</span>
<span id="cb16-176"><a href="#cb16-176" aria-hidden="true"></a>  <span class="kw">where</span></span>
<span id="cb16-177"><a href="#cb16-177" aria-hidden="true"></a><span class="ot">    hdl ::</span> <span class="dt">SomeException</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></span>
<span id="cb16-178"><a href="#cb16-178" aria-hidden="true"></a>    hdl se <span class="ot">=</span> <span class="fu">return</span> <span class="op">$</span> (<span class="fu">length</span> <span class="op">$</span> <span class="fu">show</span> se) <span class="ot">`seq`</span> <span class="dt">True</span></span>
<span id="cb16-179"><a href="#cb16-179" aria-hidden="true"></a></span>
<span id="cb16-180"><a href="#cb16-180" aria-hidden="true"></a><span class="ot">unsafe_find_capture_id ::</span> <span class="dt">CaptureID</span> <span class="ot">-&gt;</span> <span class="dt">CaptureNames</span> <span class="ot">-&gt;</span> <span class="dt">CaptureOrdinal</span></span>
<span id="cb16-181"><a href="#cb16-181" aria-hidden="true"></a>unsafe_find_capture_id cid <span class="ot">=</span> <span class="fu">either</span> <span class="fu">error</span> <span class="fu">id</span> <span class="op">.</span> findCaptureID cid</span>
<span id="cb16-182"><a href="#cb16-182" aria-hidden="true"></a></span>
<span id="cb16-183"><a href="#cb16-183" aria-hidden="true"></a><span class="ot">un_maybe ::</span> <span class="dt">Maybe</span> a <span class="ot">-&gt;</span> a</span>
<span id="cb16-184"><a href="#cb16-184" aria-hidden="true"></a>un_maybe <span class="ot">=</span> <span class="fu">maybe</span> (<span class="fu">error</span> <span class="st">&quot;urk&quot;</span>) <span class="fu">id</span></span></code></pre></div>
</div>    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-92650418-1', 'auto');
      ga('send', 'pageview');

    </script>
</body>
</html>
